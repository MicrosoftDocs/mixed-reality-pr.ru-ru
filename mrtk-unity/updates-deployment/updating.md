---
title: Обновление
description: Документация по миграции с более ранней версии МРТК.
author: polar-kev
ms.author: kesemple
ms.date: 04/19/2021
keywords: Unity, HoloLens, HoloLens 2, смешанная реальность, разработка, MRTK
ms.openlocfilehash: 97f45328bc8f9b811e815da0240138790db699c6
ms.sourcegitcommit: 0b09536c16f6802acc120a973d720aec7e30f617
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/20/2021
ms.locfileid: "107742240"
---
# <a name="updating-the-microsoft-mixed-reality-toolkit"></a>Обновление набора средств Microsoft Mixed Reality

- [Обновление до новой версии МРТК](#upgrading-to-a-new-version-of-mrtk)
- [2.3.0 2.4.0](#updating-230-to-240)
- [2.2.0 2.3.0](#updating-220-to-230)
- [2.1.0 2.2.0](#updating-210-to-220)
- [2.0.0 2.1.0](#updating-200-to-210)
- [От RC2 до 2.0.0](#updating-rc2-to-200)

## <a name="finding-the-current-version"></a>Поиск текущей версии 

Чтобы узнать, какая версия МРТК сейчас используется, выполните следующие инструкции:

1. Открытие проекта МРТК в Unity
2. Перейдите в папку "Микседреалититулкит" в окне проекта.
3. Откройте файл с именем «Version».

Если указанный файл и папка не существуют, вы используете более новую версию МРТК. В этом случае попробуйте выполнить следующие действия.

1. Перейдите к папке "Mixed Reality Toolkit Foundation"
2. Щелкните "package.js", чтобы просмотреть предварительный просмотр в Unity или открыть его в текстовом редакторе.
3. Найдите строку со словом Version: 

## <a name="upgrading-to-a-new-version-of-mrtk"></a>Обновление до новой версии МРТК

*Настоятельно рекомендуется запустить [средство миграции](../features/tools/migration-window.md) после обновления мртк* для автоматического исправления и обновления с устаревших компонентов и настроить на критические изменения. Средство миграции является частью пакета **средств** .

В приведенных ниже инструкциях описан путь обновления 2.4.0 to 2.5.0. Если проект находится в 2.3.0 или более ранней версии, прочтите изменения [между версиями](#updating-230-to-240) , чтобы понять путь обновления, или ознакомьтесь с [инструкциями предыдущего выпуска](https://microsoft.github.io/MixedRealityToolkit-Unity/version/releases/2.4.0/Documentation/Updating.html) , чтобы выполнить обновление версий по версии.

### <a name="mixed-reality-feature-tool"></a>Mixed Reality Feature Tool
Самый простой способ обновить МРТК до более новой версии МРТК — использовать [средство "функция смешанной реальности](/windows/mixed-reality/develop/unity/welcome-to-mr-feature-tool) " для загрузки последних пакетов и их загрузки непосредственно в проект Unity.

Если в проекте ранее использовались файлы ресурсов Unity (. пакет unitypackage), см. [эти инструкции](#switching-from-unity-asset-files-to-mixed-reality-feature-tool). 

### <a name="unity-asset-unitypackage-files"></a>Файлы ресурсов Unity (. пакет unitypackage)

Другой способ обновления — вручную загрузить пакеты Unity МРТК и применить их к проекту. См. действия ниже.

1. Сохраните копию текущего проекта, если вы достигли любого трудностямиа в любой момент на шагах обновления.
1. Закрыть Unity
1. В папке *Assets* удалите следующие папки **мртк** вместе с файлами. meta (проект может иметь не все перечисленные папки).
    - МРТК/Core
    - МРТК/примеры
    - МРТК и расширения
    - МРТК и поставщики
    - МРТК И ПАКЕТ SDK
    - МРТК и службы
    - МРТК/Стандардассетс
    > [!IMPORTANT]
    > Если в шейдеры МРТК были внесены изменения, создайте локальную резервную копию перед удалением папки МРТК/Стандардассетс
    - МРТК и средства
    > [!IMPORTANT]
    > НЕ удаляйте папку **микседреалититулкит. Generated** или ее мета файл.
1. Удаление папки **библиотеки**
    > [!IMPORTANT]
    > Некоторые средства Unity, такие как Unity Коллаб, сохраняют сведения о конфигурации в папке Library. При использовании средства, которое делает это, сначала скопируйте папку с данными этого средства из библиотеки перед удалением, а затем восстановите ее после повторного создания библиотеки.
1. Повторное открытие проекта в Unity
1. Импорт новых пакетов Unity
    - Foundation — _сначала импортируйте этот пакет_
    - Инструменты
    - Используемых Расширений
    > [!NOTE]
    > Если были установлены дополнительные расширения, их, возможно, потребуется повторно импортировать.
    - Используемых Примеров
1. Закройте Unity и удалите папку **библиотеки** (сначала прочитайте примечание ниже). Этот шаг необходим для принудительного обновления базы данных активов Unity и согласования существующих настраиваемых профилей.
1. Запуск Unity и для каждой сцены в проекте
    - Удалите **микседреалититулкит** и **микседреалитиплайспаце**, если они есть, из иерархии. При этом будет удалена основная камера, но она будет создана повторно на следующем шаге. Если какие-либо свойства основной камеры были изменены вручную, их необходимо будет повторно применить вручную после создания новой камеры.
    - Выберите **микседреалититулкит-> добавить в сцену и настроить** .
    - Выберите **микседреалититулкит-> служебные программы-> профили сопоставления контроллеров >** (только один раз). при этом будут обновлены все пользовательские профили сопоставления контроллеров с обновленными осями и данными, оставляя настраиваемые действия ввода без изменений.
1. Запустите [средство миграции](../features/tools/migration-window.md) и запустите средство на *полном проекте* , чтобы убедиться, что весь код обновлен до последней версии.
   Окно миграции содержит ряд различных обработчиков миграции, каждый из которых должен выполняться самостоятельно. Этот шаг включает в себя следующее:
   - Выберите первый обработчик миграции из раскрывающегося списка **Выбор обработчика миграции** .
   - Нажмите кнопку Full Project (полная проект).
   - Нажмите кнопку "Добавить полную версию проекта для миграции" (это будет проверять весь проект для переносимых объектов).
   - Нажмите кнопку "миграция", которая должна быть включена при обнаружении любых переносимых объектов.
   - Повторите предыдущие три шага для каждого из обработчиков миграции в раскрывающемся списке.
     (Ознакомьтесь с [этой проблемой](https://github.com/microsoft/MixedRealityToolkit-Unity/issues/8552) , которая охватывает работу, которую можно сделать для упрощения процесса миграции в будущем выпуске).

### <a name="switching-from-unity-asset-files-to-mixed-reality-feature-tool"></a>Переключение из файлов ресурсов Unity в инструмент для функций смешанной реальности

Переключение из файлов ресурсов Unity в пакеты средств смешанной реальности предоставляет ряд преимуществ.

- Упрощенное обновление
- Более быстрое время компиляции
- Меньше проектов в решении Visual Studio

Переход на использование средства "функция смешанной реальности" требует однократного выполнения ручных действий.

1. Сохраните копию текущего проекта.
1. Закрыть Unity
1. В папке *Assets* удалите следующие папки **мртк** вместе с файлами. meta (проект может иметь не все перечисленные папки).
    - МРТК/Core
    - МРТК/примеры
    - МРТК и расширения
    - МРТК и поставщики
    - МРТК И ПАКЕТ SDK
    - МРТК и службы
    - МРТК/Стандардассетс
    > [!IMPORTANT]
    > Если в шейдеры МРТК были внесены изменения, создайте локальную резервную копию перед удалением папки МРТК/Стандардассетс
    - МРТК и средства
    > [!IMPORTANT]
    > НЕ удаляйте папку **микседреалититулкит. Generated** или ее мета файл.
1. Удаление папки **библиотеки**
    > [!IMPORTANT]
    > Некоторые средства Unity, такие как Unity Коллаб, сохраняют сведения о конфигурации в папке Library. При использовании средства, которое делает это, сначала скопируйте папку с данными этого средства из библиотеки перед удалением, а затем восстановите ее после повторного создания библиотеки.
1. Повторное открытие проекта в Unity

После выполнения предыдущих действий запустите [средство "функция смешанной реальности](#mixed-reality-feature-tool) " и импортируйте нужную версию набора средств Mixed Reality.

## <a name="updating-230-to-240"></a>Обновление 2.3.0 до 2.4.0

[Переименование папок](#folder-renames-in-240) 
 [Изменения API](#api-changes-in-240)

### <a name="folder-renames-in-240"></a>Переименование папок в 2.4.0

Папки Микседреалититулкит были переименованы и перемещены в общую иерархию в версии 2,4. Если приложение использует жестко закодированные пути для МРТК ресурсов, их необходимо обновить в соответствии со следующей таблицей.

| Предыдущая папка | Создать папку |
| --- | --- |
| MixedRealityToolkit; | МРТК/Core |
| Микседреалититулкит. примеры | МРТК/примеры |
| Микседреалититулкит. Extensions | МРТК и расширения |
| Микседреалититулкит. Providers | МРТК и поставщики |
| Микседреалититулкит. SDK | МРТК И ПАКЕТ SDK |
| Микседреалититулкит. Services | МРТК и службы |
| Микседреалититулкит. Tests | МРТК и тесты |
| Микседреалититулкит. Tools | МРТК и средства |

> [!IMPORTANT]
> `MixedRealityToolkit.Generated`Содержит файлы, созданные клиентом, и остается без изменений.

### <a name="eye-gaze-setup-in-240"></a>Установка взгляда на глаза в 2.4.0

Эта версия МРТК изменяет шаги, необходимые для установки взгляда на глаза. Флажок _"исэйетраккинженаблед"_ можно найти в параметрах взгляда профиля входного указателя. Установка этого флажка включает взгляд на глаза, а не на заголовку по умолчанию.

Дополнительные сведения об этих изменениях и полные инструкции по настройке отслеживания взгляда см. в статье [Отслеживание отслеживания взглядов](../features/input/eye-tracking/eye-tracking-basic-setup.md) .

### <a name="eye-gaze-pointer-behavior-in-240"></a>Поведение указателя взгляда на глаз в 2.4.0

Вид указателя по умолчанию был изменен в соответствии с поведением указателя по умолчанию для основного взгляда. Указатель взгляда на глаз будет автоматически подавлен после обнаружения руки. После произнесения слова "Select" указатель глаза становится видимым снова.

Сведения о настройках взгляда и руки можно найти в статье [глаза и руки](../features/input/eye-tracking/eye-tracking-eyes-and-hands.md#how-to-keep-gaze-pointer-always-on) .

### <a name="api-changes-in-240"></a>Изменения API в 2.4.0

**Классы пользовательских контроллеров**

Классы пользовательских контроллеров ранее были определены `SetupDefaultInteractions(Handedness)` . Этот метод был устаревшим в 2,4, так как параметр правой или левой был избыточен с помощью класса контроллера правой или левой. Новый метод не имеет параметров. Кроме того, многие классы контроллеров определены таким же образом ( `AssignControllerMappings(DefaultInteractions);` ), поэтому полный вызов был `BaseController` выполнен рефакторинг и сделан необязательным переопределением, а не обязательно.

**Свойства взгляда на глаз**

`UseEyeTracking`Свойство из `GazeProvider` реализации `IMixedRealityEyeGazeProvider` было переименовано в `IsEyeTrackingEnabled` .

Если вы сделали это ранее...

```csharp
if (CoreServices.InputSystem.GazeProvider is GazeProvider gazeProvider)
{
    gazeProvider.UseEyeTracking = true;
}
```

Сделать это сейчас...

```csharp
if (CoreServices.InputSystem.GazeProvider is GazeProvider gazeProvider)
{
    gazeProvider.IsEyeTrackingEnabled = true;
}
```

**Свойства Виндовсапичеккер**

Следующие свойства Виндовсапичеккер помечены как устаревшие. Используйте `IsMethodAvailable` `IsPropertyAvailable` или `IsTypeAvailable` .

- UniversalApiContractV8_IsAvailable
- UniversalApiContractV7_IsAvailable
- UniversalApiContractV6_IsAvailable
- UniversalApiContractV5_IsAvailable
- UniversalApiContractV4_IsAvailable
- UniversalApiContractV3_IsAvailable

Нет планов по добавлению свойств в Виндовсапичеккер для будущих версий контракта API.

**Глтфмешпримитивеаттрибутес только для чтения**

Атрибуты-примитивы сетки глтф, используемые для устанавливаемых параметров, теперь доступны только для чтения. Их значения будут заданы один раз при десериализации.

### <a name="custom-button-icon-migration"></a>Миграция значка настраиваемой кнопки

Ранее настроенные значки кнопок требуют назначения нового материала для средства визуализации с четырьмя кнопками. Это больше не требуется, поэтому мы рекомендуем переместить текстуры настраиваемых значков в виде значков. Существующие пользовательские материалы и значки сохраняются. Однако они будут менее оптимальными до обновления.
Чтобы обновить ресурсы на всех кнопках в проекте до нового рекомендуемого формата, используйте Буттонконфигхелпермигратионхандлер.
(Набор средств для смешанной реальности — > служебные программы — > окно миграции — выбор обработчика миграции > — > Microsoft. Микседреалити. Toolkit. Utilities. Буттонконфигхелпермигратионхандлер)

![Диалоговое окно обновления](https://user-images.githubusercontent.com/39840334/82096923-bd28bf80-96b6-11ea-93a9-ceafcb822242.png)

Если значок не найден в наборе значков по умолчанию во время миграции, в Микседреалититулкит. Generated/Кустомиконсетс будет создан пользовательский набор значков. В диалоговом окне будет указано, что выполнено.

![Уведомление о настраиваемом значке](https://user-images.githubusercontent.com/9789716/82093856-c57dfc00-96b0-11ea-83ab-4df57446d661.PNG)

## <a name="updating-220-to-230"></a>Обновление 2.2.0 до 2.3.0

- [изменения API](#api-changes-in-230);

### <a name="api-changes-in-230"></a>Изменения API в 2.3.0

**контроллерпосесинчронизер**

Закрытое поле Контроллерпосесинчронизер. правой или левой помечено как устаревшее. Это должно оказать минимальное воздействие на приложения, так как поле не видимо за пределами его класса.

Метод задания свойства public Контроллерпосесинчронизер. правой или левой был удален ([#7012](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/7012)).

**MSBuild для Unity**

Эта версия МРТК использует более новую версию MSBuild для Unity, чем предыдущие выпуски. Если при загрузке проекта в манифесте диспетчера пакетов Unity указана более старая версия, появится диалоговое окно конфигурации с установленным флажком Включить MSBuild для Unity. При применении будет выполнено обновление.

**скриптингутилитиес**

Класс Скриптингутилитиес был помечен как устаревший и был заменен Скриптутилитиес в сборке Microsoft. Микседреалити. Toolkit. Editor. Utilities. Новый класс расширяет предыдущее поведение и добавляет поддержку для удаления определений скриптов.

Несмотря на то, что существующий код будет продолжать работать в версии 2.3.0, рекомендуется обновить его до нового класса.

**шеллхандрайпоинтер**

Члены Линерендерерселектед и Линерендерернотаржет класса Шеллхандрайпоинтер были заменены Линематериалселектед и lineMaterialNoTarget соответственно ([#6863](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/6863)).

Замените Линерендерерселектед на Линематериалселектед и/или Линерендерернотаржет на Линематериалнотаржет для разрешения ошибок компиляции.

**StartupBehavior пространственного наблюдателя**

Пространственные наблюдатели, созданные на основе `BaseSpatialObserver` класса, теперь соблюдают значение StartupBehavior при повторном включении ([#6919](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/6919)).

Чтобы воспользоваться этим исправлением, никаких изменений не требуется.

**Элемент управления UX Prefabs обновлен для использования Прессаблебуттон**

Следующие Prefabs теперь используют компонент Прессаблебуттон вместо Таучхандлер для NEAR взаимодействия ([7070](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/7070))

- аниматионбуттон
- Кнопка
- ButtonHoloLens1
- ButtonHoloLens1Toggle
- CheckBox
- Радиальный
- ToggleButton
- ToggleSwitch
- унитюибуттон
- унитюичеккбоксбуттон
- унитюирадиалбуттон
- унитюитогглебуттон

Код приложения может потребовать обновления из-за этого изменения.

**Пространство имен Виндовсмикседреалитютилитиес**

Пространство имен Виндовсмикседреалитютилитиес изменилось с Microsoft. Микседреалити. Toolkit. Виндовсмикседреалити. input на Microsoft. Микседреалити. Toolkit. Виндовсмикседреалити ([#6863](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/6989)).

Обновите инструкции #using, чтобы устранить ошибки компиляции.

## <a name="updating-210-to-220"></a>Обновление 2.1.0 до 2.2.0

- [изменения API](#api-changes-in-220);

### <a name="api-changes-in-220"></a>Изменения API в 2.2.0

**Имикседреалитибаундарисистем. Contains**

Этот метод ранее использовался в определенном экспериментальном перечислении, определенном Unity. Теперь он принимает определяемое МРТК перечисление, идентичное перечислению Unity. Это изменение помогает подготовить МРТК для будущих API границ Unity.

**микседреалитисервицепрофилеаттрибуте**

Чтобы лучше описать требования для поддержки профиля, Микседреалитисервицепрофилеаттрибуте был обновлен для добавления необязательной коллекции исключенных типов. В рамках этого изменения свойство ServiceType было изменено с Type на Type [] и было переименовано в Рекуиредтипес.

Также было добавлено второе свойство Ексклудедтипес.

## <a name="updating-200-to-210"></a>Обновление 2.0.0 до 2.1.0

- [изменения API](#api-changes-in-210);
- [Изменения профиля](#profile-changes-in-210)

### <a name="api-changes-in-210"></a>Изменения API в 2.1.0

**басенеаринтерактионтаучабле**

Был `BaseNearInteractionTouchable` изменен, чтобы пометить `OnValidate` метод как виртуальный. Классы, расширяющие `BaseNearInteractionTouchable` (например `NearInteractionTouchableUnityUI` ,), были обновлены, чтобы отразить это изменение.

**коллидернеаринтерактионтаучабле**

Класс `ColliderNearInteractionTouchable` не рекомендуется к использованию. Обновите ссылки на код для использования `BaseNearInteractionTouchable` .

**имикседреалитимауседевицеманажер**

**_Добавлено_**

`IMixedRealityMouseDeviceManager` были добавлены `CursorSpeed` Свойства и `WheelSpeed` . Эти свойства позволяют приложениям указать значение множителя, на которое будут масштабироваться скорость курсора и колесика соответственно.

Это критическое изменение, требующее изменения существующих реализаций диспетчера устройств мыши.

>[!NOTE]
>Это изменение не обратно совместимо с версией 2.0.0.

**_Не рекомендуется_**

`MouseInputProfile`Свойство помечено как устаревшее и будет удалено из будущей версии набора средств Microsoft Mixed Reality. Рекомендуется, чтобы код приложения больше не использовал это свойство.

**Интерактивный объект**

Следующие методы и свойства являются устаревшими и будут удалены из будущей версии набора средств Microsoft Mixed Reality. Рекомендуется обновлять код приложения в соответствии с рекомендациями, содержащимися в атрибуте obsolete и отображаемых в консоли.

- `public bool Enabled`
- `public bool FocusEnabled`
- `public void ForceUpdateThemes()`
- `public bool IsDisabled`
- `public bool IsToggleButton`
- `public int GetDimensionIndex()`
- `public State[] GetStates()`
- `public bool RequiresFocus`
- `public void ResetBaseStates()`
- `public virtual void SetCollision(bool collision)`
- `public virtual void SetCustom(bool custom)`
- `public void SetDimensionIndex(int index)`
- `public virtual void SetDisabled(bool disabled)`
- `public virtual void SetFocus(bool focus)`
- `public virtual void SetGesture(bool gesture)`
- `public virtual void SetGestureMax(bool gesture)`
- `public virtual void SetGrab(bool grab)`
- `public virtual void SetInteractive(bool interactive)`
- `public virtual void SetObservation(bool observation)`
- `public virtual void SetObservationTargeted(bool targeted)`
- `public virtual void SetPhysicalTouch(bool touch)`
- `public virtual void SetPress(bool press)`
- `public virtual void SetTargeted(bool targeted)`
- `public virtual void SetToggled(bool toggled)`
- `public virtual void SetVisited(bool visited)`
- `public virtual void SetVoiceCommand(bool voice)`

**неаринтерактионтаучаблесурфаце**

`NearInteractionTouchableSurface`Класс был добавлен и теперь служит базовым классом для `NearInteractionTouchable` и `NearInteractionTouchableUnityUI` .

### <a name="profile-changes-in-210"></a>Изменения профиля в 2.1.0

**Профиль отслеживания вручную**

В сетке "рука" и в совместных визуализациях теперь есть отдельный редактор и параметры проигрывателя. Профиль отслеживания вручную был обновлен, чтобы разрешить установку этих визуализаций; Ничего, все, редактор или проигрыватель.

![Режимы визуализации вручную](../release-notes/images/HandTrackingVisualizationModes.png)

Для правильной работы с версией 2.1.0 может потребоваться обновить профили отслеживания пользовательских операций.

>[!NOTE]
>Это изменение не обратно совместимо с версией 2.0.0.

**Профиль имитации ввода**

Система имитации ввода обновлена, что изменяет несколько параметров в профиле моделирования ввода. Некоторые изменения не могут быть перенесены автоматически, и пользователи могут обнаружить, что профили используют значения по умолчанию.

1. Все привязки KeyCode и кнопок мыши в профиле заменены универсальной `KeyBinding` структурой, в которой хранится тип привязки (ключ или мышь), а также фактический код привязки (keyCode или номер кнопки мыши соответственно). Структура имеет собственный инспектор, который позволяет использовать единое отображение и предлагает средство "Автопривязка" для быстрого задания сочетаний клавиш, что позволяет быстро установить привязки к ключам, не выбирая из огромного раскрывающегося списка.

    - фастконтролкэй
    - тогглелефсандкэй
    - тогглеригхсандкэй
    - лефсандманипулатионкэй
    - ригхсандманипулатионкэй

1. `MouseLookToggle` ранее был включен в `MouseLookButton` перечисление как `InputSimulationMouseButton.Focused` , теперь он является отдельным параметром. Если этот параметр включен, Камера будет удерживать нажатой кнопку мыши после освобождения кнопки, пока не будет нажата клавиша Escape.
1. `HandDepthMultiplier` значение по умолчанию было сокращено с 0,1 до 0,03, чтобы учесть некоторые изменения в моделировании ввода. Если при прокрутке камера перемещается слишком быстро, попробуйте уменьшить это значение.
1. Клавиши для поворота руки были удалены; поворот руки теперь также управляется мышью. Удержание `HandRotateButton` (Ctrl) с помощью левого или правого ключа манипуляции (лшифт/Space) позволит включить поворот вручную.
1. В список входных осей появилась новая ось "вверх". Это управляет движением камеры в вертикальном и по умолчанию клавишами Q/E, а также кнопками триггера контроллера.

Дополнительные сведения об этих изменениях см. в статье о [службе моделирования ввода](../features/input-simulation/input-simulation-service.md) .

**Профиль поставщика данных мыши**

Профиль поставщика данных мыши был обновлен для предоставления новых `CursorSpeed` `WheelSpeed` свойств и. Существующие настраиваемые профили будут автоматически иметь значения по умолчанию. При сохранении профиля эти новые значения будут сохранены.

**Профиль сопоставления контроллеров**

Некоторые оси и типы входных данных были обновлены в 2.1.0, особенно вокруг платформы Опенвр. При обновлении необходимо выбрать **микседреалититулкит-> Utilities-> профили сопоставления контроллеров >** . При этом будут обновлены все пользовательские профили сопоставления контроллеров с обновленными осями и данными, при этом пользовательские действия, назначенные пользователем, останутся без изменений.

## <a name="updating-rc2-to-200"></a>Обновление RC2 до 2.0.0

Между выпусками RC2 и 2.0.0 набора средств Microsoft Mixed Reality были внесены изменения, которые могут повлиять на существующие проекты. В этом документе описаны эти изменения и способы обновления проектов до выпуска 2.0.0.

- [изменения API](#api-changes-in-200);
- [Изменения имени сборки](#assembly-name-changes-in-200)

### <a name="api-changes-in-200"></a>Изменения API в 2.0.0

С момента выпуска RC2 было внесено несколько изменений API, включая некоторые, которые могут нарушить работу существующих проектов. В следующих разделах описаны изменения, произошедшие между выпусками RC2 и 2.0.0.

**MixedRealityToolkit;**

Следующие общие свойства объекта Микседреалититулкит являются устаревшими.

- `RegisteredMixedRealityServices` больше не содержит коллекцию зарегистрированных расширений служб и поставщиков данных.

Для доступа к службам расширений используйте `MixedRealityServiceRegistry.TryGetService<T>` . Для доступа к поставщикам данных приведите экземпляр службы к [`IMixedRealityDataProviderAccess`](xref:Microsoft.MixedReality.Toolkit.IMixedRealityDataProviderAccess) и используйте `GetDataProvider<T>` .

Используйте [`MixedRealityServiceRegistry`](xref:Microsoft.MixedReality.Toolkit.MixedRealityServiceRegistry) или [`CoreServices`](xref:Microsoft.MixedReality.Toolkit.CoreServices) вместо этого для следующих устаревших свойств

- `ActiveSystems`
- `InputSystem`
- `BoundarySystem`
- `CameraSystem`
- `SpatialAwarenessSystem`
- `TeleportSystem`
- `DiagnosticsSystem`
- `SceneSystem`

**коресервицес**

[`CoreServices`](xref:Microsoft.MixedReality.Toolkit.CoreServices)Класс является заменой для методов доступа статических систем (например: баундарисистем), найденных в `MixedRealityToolkit` объекте.

>[!IMPORTANT]
>`MixedRealityToolkit`Методы доступа к системе устарели в версии 2.0.0 и будут удалены в следующем выпуске мртк.

В следующем примере кода показан старый и новый шаблон.

``` c#
// Old
GameObject playAreaVisualization = MixedRealityToolkit.BoundarySystem?.GetPlayAreaVisualization();

// New
GameObject playAreaVisualization = CoreServices.BoundarySystem?.GetPlayAreaVisualization();
```

Использование нового класса Коресистем гарантирует, что код приложения не будет обновляться, если вы измените приложение так, чтобы оно использовало другой регистратор служб (например, один из экспериментальных диспетчеров служб).

**имикседреалитирайкастпровидер**

После добавления Имикседреалитирайкастпровидер был изменен профиль конфигурации входной системы. Если у вас есть пользовательский профиль, при запуске приложения могут возникнуть ошибки на следующем рисунке.

![Выбор поставщика Райкаст 1](../release-notes/images/UnableToRegisterRaycastProvider.png)

Чтобы исправить эти ошибки, добавьте экземпляр Имикседреалитирайкастпровидер в входной системный профиль.

![Выбор поставщика Райкаст 2](../release-notes/images/SelectRaycastProvider.png)

**Система событий**

- `IMixedRealityEventSystem`Старые методы API `Register` и `Unregister` были помечены как устаревшие. Они сохраняются для обеспечения обратной совместимости.
- `InputSystemGlobalListener` помечен как устаревший. Его функциональность не изменилась.
- `BaseInputHandler` базовый класс был изменен с `InputSystemGlobalListener` на `InputSystemGlobalHandlerListener` . Это критическое изменение для всех потомков `BaseInputHandler` .

**_Мотивация за изменение_**

Старый API системы событий `Register` и `Unregister` потенциально может вызвать несколько проблем в среде выполнения:

- Если компонент регистрируется для глобальных событий, он получит глобальные входные события *всех* типов.
- Если один из компонентов объекта регистрируется для получения глобальных входных событий, все компоненты этого объекта будут иметь глобальные входные события *всех* типов.
- Если два компонента одного и того же объекта регистрируются в глобальных событиях, а затем один из них отключен во время выполнения, второй останавливает получение глобальных событий.

Новый API `RegisterHandler` и `UnregisterHandler` :

- Предоставляет явный и детализированный контроль над тем, какие входные события следует прослушивать глобально, а какие — на основе фокуса.
- Позволяет нескольким компонентам одного и того же объекта прослушивать глобальные события независимо друг от друга.

**_Как выполнить миграцию_**

- Если ранее вы вызывали `Register` / `Unregister` API непосредственно, замените эти вызовы вызовами метода `RegisterHandler` / `UnregisterHandler` . Используйте интерфейсы обработчика, которые реализуются как универсальные параметры. Если вы реализуете несколько интерфейсов и несколько из них прослушивают глобальные события ввода, вызывайте их `RegisterHandler` несколько раз.
- Если вы наследуете от `InputSystemGlobalListener` , измените наследование на `InputSystemGlobalHandlerListener` . Реализуйте `RegisterHandlers` и `UnregisterHandlers` абстрактные методы. В вызове реализации `inputSystem.RegisterHandler` ( `inputSystem.UnregisterHandler` ) для регистрации всех интерфейсов обработчика, для которых требуется прослушивать глобальные события.
- Если вы наследуете от `BaseInputHandler` , реализуйте `RegisterHandlers` и `UnregisterHandlers` абстрактные методы (то же, что и `InputSystemGlobalListener` ).

**_Примеры миграции_**

```c#
// Old
class SampleHandler : MonoBehaviour, IMixedRealitySourceStateHandler, IMixedRealityHandJointHandler
{
    private void OnEnable()
    {
        InputSystem?.Register(gameObject);
    }

    private void OnDisable()
    {
        InputSystem?.Unregister(gameObject);
    }
}

// Migrated
class SampleHandler : MonoBehaviour, IMixedRealitySourceStateHandler, IMixedRealityHandJointHandler
{
    private void OnEnable()
    {
        InputSystem?.RegisterHandler<IMixedRealitySourceStateHandler>(this);
        InputSystem?.RegisterHandler<IMixedRealityHandJointHandler>(this);
    }

    private void OnDisable()
    {
        InputSystem?.UnregisterHandler<IMixedRealitySourceStateHandler>(this);
        InputSystem?.UnregisterHandler<IMixedRealityHandJointHandler>(this);
    }
}
```

```c#
// Old
class SampleHandler2 : InputSystemGlobalListener, IMixedRealitySpeechHandler
{
}

// Migrated
class SampleHandler2 : InputSystemGlobalHandlerListener, IMixedRealitySpeechHandler
{
    private void RegisterHandlers()
    {
        InputSystem?.RegisterHandler<IMixedRealitySpeechHandler>(this);
    }

    private void UnregisterHandlers()
    {
        InputSystem?.UnregisterHandler<IMixedRealitySpeechHandler>(this);
    }
}

// Alternative migration
class SampleHandler2 : MonoBehaviour, IMixedRealitySpeechHandler
{
    private void OnEnable()
    {
        IMixedRealityInputSystem inputSystem;
        if (MixedRealityServiceRegistry.TryGetService<IMixedRealityInputSystem>(out inputSystem))
        {
            inputSystem?.RegisterHandler<IMixedRealitySpeechHandler>(this);
        }
    }

    private void OnDisable()
    {
        IMixedRealityInputSystem inputSystem;
        if (MixedRealityServiceRegistry.TryGetService<IMixedRealityInputSystem>(out inputSystem))
        {
            inputSystem?.UnregisterHandler<IMixedRealitySpeechHandler>(this);
        }
    }
}
```

**Поддержка пространственных сведений**

Интерфейсы Имикседреалитиспатиалаваренесссистем и Имикседреалитиспатиалаваренессобсервер использовали несколько критических изменений, как описано ниже.

**_Изменениями_**

Следующие методы были переименованы для лучшего описания их использования.

- `IMixedRealitySpatialAwarenessSystem.CreateSpatialObjectParent` был переименован в для `IMixedRealitySpatialAwarenessSystem.CreateSpatialAwarenessObservationParent` уточнения его использования.

**_Добавления_**

На основе отзывов клиентов была добавлена поддержка простого удаления ранее просмотренных данных о пространственной осведомленности.

- `IMixedRealitySpatialAwarenessSystem.ClearObservations()`
- `IMixedRealitySpatialAwarenessSystem.ClearObservations<T>(string name)`
- `IMixedRealitySpatialAwarenessObserver.ClearObservations()`

**Решатели**

Некоторые компоненты поиска решения и класс Солверхандлер Manager были изменены для устранения различных ошибок и для более интуитивного использования.

**_солверхандлер_**

- Класс больше не расширяется с `ControllerFinder`
- `TrackedObjectToReference` общедоступное свойство устарело и было переименовано в `TrackedTargetType`
- `TrackedObjectType` устаревшие левые & правильные значения контроллера. Вместо этого `MotionController` Используйте `HandJoint` значения или и обновите новое `TrackedHandedness` свойство, чтобы ограничить отслеживание до левого или правого контроллера.

**_Промежуточное_**

- `TrackedObjectForSecondTransform` общедоступное свойство устарело и было переименовано в `SecondTrackedObjectType`
- `AttachSecondTransformToNewTrackedObject()` был удален. Чтобы обновить Поиск решения, измените открытые свойства (т. е. `SecondTrackedObjectType`)

**_сурфацемагнетисм_**

- `MaxDistance` общедоступное свойство устарело и было переименовано в `MaxRaycastDistance`
- `CloseDistance` общедоступное свойство устарело и было переименовано в `ClosestDistance`
- Значение по умолчанию для параметра `RaycastDirectionMode` , `TrackedTargetForward` которое теперь райкастс в направлении перенаправленного целевого преобразования
- `OrientationMode` значения Enum `Vertical` и `Full` переименованы в `TrackedTarget` и `SurfaceNormal` соответственно
- `KeepOrientationVertical` Добавлено открытое свойство, определяющее, остается ли ориентация связанных GameObject по вертикали

**Кнопки**

- [`PressableButton`](xref:Microsoft.MixedReality.Toolkit.UI.PressableButton) Теперь `DistanceSpaceMode` свойство имеет значение `Local` по умолчанию. Это позволяет масштабировать кнопки, пока они продолжают нажимать

**Обрезка сферы**

Интерфейс Клиппингсфере изменился на зеркальное отображение интерфейсов API, находящихся в Клиппингбокс и Клиппингплане.

Свойство RADIUS Клиппингсфере теперь неявно вычисляется на основе шкалы преобразования. Прежде чем разработчики должны будут указать радиус Клиппингсфере в инспекторе. Если вы хотите изменить радиус, просто обновите масштаб преобразования преобразования, как обычно.

**Неаринтерактионтаучабле и Покепоинтер**

- Неаринтерактионтаучабле не обрабатывает доступ к холсту пользовательского интерфейса Unity больше. Теперь класс Неаринтерактионтаучаблеунитюи должен использоваться для таучаблес пользовательского интерфейса Unity.
- Коллидернеаринтерактионтаучабле — это новый базовый класс для таучаблес, основанный на конфликтах, т. е. Каждый сенсорный ввод, кроме Неаринтерактионтаучаблеунитюи.
- Басенеаринтерактионтаучабле. Дистфронт был перемещен и переименован в Покепоинтер. Таучабледистанце это расстояние, которое Покепоинтер может взаимодействовать с touchables. Раньше каждый сенсорный ввод имеет свое максимальное расстояние взаимодействия, но теперь он определен в Покепоинтер, что позволяет оптимизировать оптимизацию.
- Басенеаринтерактионтаучабле. Дистбакк был переименован в Покесрешолд. Это позволяет ясно, что Покесрешолд является аналогом Дебаунцесрешолд. Сенсорный элемент активируется, когда Покесрешолд пересекается и освобождается при пересечении Дебаунцесрешолд.

**ReadOnlyAttribute**

`Microsoft.MixedReality.Toolkit`Пространство имен было добавлено в `ReadOnlyAttribute` , `BeginReadOnlyGroupAttribute` и `EndReadOnlyGroupAttribute` .

**поинтеркликкхандлер**

Класс `PointerClickHandler` не рекомендуется к использованию. `PointerHandler`Вместо этого следует использовать функцию, которая предоставляет те же функциональные возможности.

**Поддержка щелчка HoloLens**

Сопоставления контроллера щелчка HoloLens изменились с невозможности [`WindowsMixedRealityController`](xref:Microsoft.MixedReality.Toolkit.WindowsMixedReality.Input.WindowsMixedRealityController) на необработанные [`WindowsMixedRealityGGVHand`](xref:Microsoft.MixedReality.Toolkit.WindowsMixedReality.Input.WindowsMixedRealityGGVHand) . Для этой учетной записи автоматическое обновление будет выполняться при первом открытии профиля Контроллермаппинг. Чтобы активировать этот одноразовый шаг миграции, откройте какие-либо пользовательские профили по крайней мере один раз после обновления до 2.0.0.

**интерактаблехигхлигхт**

Класс `InteractableHighlight` не рекомендуется к использованию. `InteractableOnFocus` `FocusInteractableStates` Вместо этого следует использовать класс и ресурс. Чтобы создать новый `Theme` ресурс для, щелкните `InteractableOnFocus` правой кнопкой мыши в окне проекта и выберите команду *создать*  >  взаимодействующую тему с *набором средств Mixed Reality*  >    >  .

**хандинтерактионпанзум**

`HandInteractionPanZoom` был перемещен в пространство имен пользовательского интерфейса, так как он не был входным компонентом. `HandPanEventData` также было перемещено в это пространство имен и упрощено для соответствия с другими данными событий пользовательского интерфейса.

### <a name="assembly-name-changes-in-200"></a>Изменение имени сборки в 2.0.0

В выпуске 2.0.0 все официальные имена сборок набора средств для смешанной реальности и связанные с ними файлы определения сборок (. асмдеф) были обновлены в соответствии со следующим шаблоном.

```c#
Microsoft.MixedReality.Toolkit[.<name>]
```

В некоторых случаях объединено несколько сборок для создания лучшего Unity их содержимого. Если в проекте используются пользовательские файлы. асмдеф, они могут потребовать обновления.

В следующих таблицах описывается, как имена файлов RC2. асмдеф сопоставлены с выпуском 2.0.0. Все имена сборок соответствуют имени файла асмдеф.

**MixedRealityToolkit;**

| RC2 | 2.0.0 |
| --- | --- |
| Микседреалититулкит. асмдеф | Microsoft. Микседреалити. Toolkit. асмдеф |
| Микседреалититулкит. Core. Буилданддеплой. асмдеф | Microsoft. Микседреалити. Toolkit. Editor. Буилданддеплой. асмдеф |
| Микседреалититулкит. Core. definitions. Utilities. Editor. асмдеф | Удалено, используйте Microsoft. Микседреалити. Toolkit. Editor. Utilities. асмдеф |
| Микседреалититулкит. Core. Extensions. Едиторклассекстенсионс. асмдеф | Microsoft. Микседреалити. Toolkit. Editor. Классекстенсионс. асмдеф
| Микседреалититулкит. Core. Инспекторы. асмдеф | Microsoft. Микседреалити. Toolkit. Editor. Инспекторы. асмдеф |
| Микседреалититулкит. Core. Инспекторы. Сервицеинспекторс. асмдеф | Microsoft. Микседреалити. Toolkit. Editor. Сервицеинспекторс. асмдеф |
| Микседреалититулкит. Core. Утилитиесасинк. асмдеф | Microsoft. Микседреалити. Toolkit. Async. асмдеф |
| Микседреалититулкит. Core. Utilities. Editor. асмдеф | Microsoft. Микседреалити. Toolkit. Editor. Utilities. асмдеф |
| Микседреалититулкит. Utilities. Глтф. асмдеф | Microsoft. Микседреалити. Toolkit. Глтф. асмдеф |
| Микседреалититулкит. Utilities. Глтф. импортеров. асмдеф | Microsoft. Микседреалити. Toolkit. Глтф. импортеров. асмдеф |

**Микседреалититулкит. Providers**

| RC2 | 2.0.0 |
| --- | --- |
| Микседреалититулкит. Providers. Опенвр. асмдеф | Microsoft. Микседреалити. Toolkit. Providers. Опенвр. асмдеф |
| Микседреалититулкит. Providers. Виндовсмикседреалити. асмдеф | Microsoft. Микседреалити. Toolkit. Providers. Виндовсмикседреалити. асмдеф |
| Микседреалититулкит. Providers. Виндовсвоицеинпут. асмдеф | Microsoft. Микседреалити. Toolkit. Providers. Виндовсвоицеинпут. асмдеф |

**Микседреалититулкит. Services**

| RC2 | 2.0.0 |
| --- | --- |
| Микседреалититулкит. Services. Баундарисистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Баундарисистем. асмдеф |
| Микседреалититулкит. Services. Камерасистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Камерасистем. асмдеф |
| Микседреалититулкит. Services. Диагностикссистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Диагностикссистем. асмдеф |
| Микседреалититулкит. Services. Инпутсимулатион. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Инпутсимулатион. асмдеф |
| Микседреалититулкит. Services. Инпутсимулатион. Editor. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Инпутсимулатион. Editor. асмдеф |
| Микседреалититулкит. Services. Инпутсистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Инпутсистем. асмдеф |
| Микседреалититулкит. Services. Инспекторы. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Инпутсистем. Editor. асмдеф |
| Микседреалититулкит. Services. Сценесистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Сценесистем. асмдеф |
| Микседреалититулкит. Services. Спатиалаваренесссистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Спатиалаваренесссистем. асмдеф |
| Микседреалититулкит. Services. Телепортсистем. асмдеф | Microsoft. Микседреалити. Toolkit. Services. Телепортсистем. асмдеф |

**Микседреалититулкит. SDK**

| RC2 | 2.0.0 |
| --- | --- |
| Микседреалититулкит. SDK. асмдеф | Microsoft. Микседреалити. Toolkit. SDK. асмдеф |
| Микседреалититулкит. SDK. Инспекторы. асмдеф | Microsoft. Микседреалити. Toolkit. SDK. Инспекторы. асмдеф |

**Микседреалититулкит. примеры**

| RC2 | 2.0.0 |
| --- | --- |
| Микседреалититулкит. examples. асмдеф | Microsoft. Микседреалити. Toolkit. examples. асмдеф |
| Микседреалититулкит. examples. Демонстрация. Глтф. асмдеф | Microsoft. Микседреалити. Toolkit. Демонстрация. Глтф. асмдеф |
| Микседреалититулкит. examples. демонстрации. Стандардшадер. Инспекторы. асмдеф | Microsoft. Микседреалити. Toolkit. демонстрации. Стандардшадер. Инспекторы. асмдеф |
| Микседреалититулкит. examples. Демонстрация. Utilities. Инспекторфиелдс. асмдеф | Microsoft. Микседреалити. Toolkit. Демонстрация. Инспекторфиелдс. асмдеф |
| Микседреалититулкит. examples. демонстрации. Utilities. Инспекторфиелдс. Инспекторы. асмдеф | Microsoft. Микседреалити. Toolkit. демонстрации. Инспекторфиелдс. Инспекторы. асмдеф |
| Микседреалититулкит. examples. Демонстрация. UX. Интерактаблес. асмдеф | Microsoft. Микседреалити. Toolkit. Демонстрация. UX. Интерактаблес. асмдеф |