---
title: Запись анимации ввода
description: Документация по системе записи анимации ввода в МРТК
author: CDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, смешанная реальность, разработка, MRTK
ms.openlocfilehash: 6bdb764c5905352b9aec7c1512a73e727b60573a
ms.sourcegitcommit: f338b1f121a10577bcce08a174e462cdc86d5874
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2021
ms.locfileid: "113176938"
---
# <a name="input-animation-recording"></a><span data-ttu-id="c1581-104">Запись анимации ввода</span><span class="sxs-lookup"><span data-stu-id="c1581-104">Input animation recording</span></span>

<span data-ttu-id="c1581-105">МРТК включает в себя систему записи, с помощью которой можно хранить данные отслеживания головного и ручного хранения в файлах анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-105">MRTK features an recording system by which head movement and hand tracking data can be stored in animation files.</span></span> <span data-ttu-id="c1581-106">Затем записанные данные можно воспроизводить с помощью [системы имитации ввода](input-simulation-service.md).</span><span class="sxs-lookup"><span data-stu-id="c1581-106">The recorded data can then be played back using the [input simulation system](input-simulation-service.md).</span></span>

<span data-ttu-id="c1581-107">Запись входных данных является полезным инструментом в различных ситуациях.</span><span class="sxs-lookup"><span data-stu-id="c1581-107">Recording input is a useful tool in a variety of situations:</span></span>

* <span data-ttu-id="c1581-108">Создание автоматических тестов для взаимодействия, манипуляций, поиска решений и т. д. Создание перемещения контроллеров и движений для этих тестов может занять много времени.</span><span class="sxs-lookup"><span data-stu-id="c1581-108">Creating automated tests for interaction, manipulations, solvers, etc. Creating the movement of controllers and hands for these tests can be time consuming.</span></span> <span data-ttu-id="c1581-109">Непосредственная запись данных может ускорить процесс и предоставить реальные данные.</span><span class="sxs-lookup"><span data-stu-id="c1581-109">Recording input directly can speed up the process and provide real-world data.</span></span>
* <span data-ttu-id="c1581-110">Обучение использованию элементов UX с помощью анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-110">Teaching the use of UX elements through animations.</span></span>
  <span data-ttu-id="c1581-111">Показывая пользователям, как взаимодействовать с кнопками и другими объектами, можно сгладить кривую обучения.</span><span class="sxs-lookup"><span data-stu-id="c1581-111">Showing users how to interact with buttons and other objects can smooth the learning curve.</span></span>
* <span data-ttu-id="c1581-112">Отладка непредвиденного поведения, которое может быть обнаружено во время обычного использования.</span><span class="sxs-lookup"><span data-stu-id="c1581-112">Debugging unexpected behavior that may be encountered during regular use.</span></span>
  <span data-ttu-id="c1581-113">Система записи поддерживает концепцию последовательного буфера, которая позволяет записывать последние входные данные в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="c1581-113">The recording system supports a "rolling buffer" concept that allows recording recent input in the background.</span></span>
  <span data-ttu-id="c1581-114">См. раздел [служба регистрации входных данных](#input-recording-service).</span><span class="sxs-lookup"><span data-stu-id="c1581-114">See [Input Recording Service](#input-recording-service).</span></span>

## <a name="recording-and-playback-services"></a><span data-ttu-id="c1581-115">Службы записи и воспроизведения</span><span class="sxs-lookup"><span data-stu-id="c1581-115">Recording and playback services</span></span>

<span data-ttu-id="c1581-116">Предоставляются две системные службы ввода для записи и воспроизведения данных, соответственно.</span><span class="sxs-lookup"><span data-stu-id="c1581-116">Two input system services are provided to record and play back input respectively.</span></span>

### <a name="input-recording-service"></a><span data-ttu-id="c1581-117">Служба записи ввода</span><span class="sxs-lookup"><span data-stu-id="c1581-117">Input recording service</span></span>

<span data-ttu-id="c1581-118">[`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) принимает данные из основного преобразования камеры и активных контроллеров и сохраняет их во внутреннем буфере.</span><span class="sxs-lookup"><span data-stu-id="c1581-118">[`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) takes data from the main camera transform and active hand controllers and stores it in an internal buffer.</span></span> <span data-ttu-id="c1581-119">После запроса эти данные сериализуются в двоичные файлы для хранения и последующего воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="c1581-119">When requested this data is then serialized into binary files for storage and later replay.</span></span>

<a target="_blank" href="../images/input-simulation/MRTK_InputAnimation_RecordingDiagram.png">
  <img src="../images/input-simulation/MRTK_InputAnimation_RecordingDiagram.png" title="Запись анимации ввода" width="80%" alt="Recording diagram" class="center" />
</a>

<span data-ttu-id="c1581-121">Чтобы начать запись входных данных, вызовите [`StartRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StartRecording) функцию.</span><span class="sxs-lookup"><span data-stu-id="c1581-121">To start recording input call the [`StartRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StartRecording) function.</span></span> <span data-ttu-id="c1581-122">[`StopRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StopRecording) приостанавливает запись (но не удаляет данные, записанные на данный момент [`DiscardRecordedInput`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.DiscardRecordedInput) ). при необходимости используйте для этого.</span><span class="sxs-lookup"><span data-stu-id="c1581-122">[`StopRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StopRecording) will pause recording (but not discard the data recorded so far, use [`DiscardRecordedInput`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.DiscardRecordedInput) to do this if needed).</span></span>

<span data-ttu-id="c1581-123">По умолчанию размер буфера записи ограничен 30 секундами.</span><span class="sxs-lookup"><span data-stu-id="c1581-123">By default the size of the recording buffer is limited to 30 seconds.</span></span> <span data-ttu-id="c1581-124">Это позволяет службе записи сохранять данные в фоновом режиме без накопления слишком большого объема данных, а затем при необходимости сохранить последние 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="c1581-124">This allows the recording service to keep recording in the background without accumulating too much data, and then save the last 30 seconds when required.</span></span> <span data-ttu-id="c1581-125">Интервал времени можно изменить с помощью [`RecordingBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.RecordingBufferTimeLimit) свойства, или запись может быть неограниченной с помощью [`UseBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.UseBufferTimeLimit) параметра.</span><span class="sxs-lookup"><span data-stu-id="c1581-125">The time interval can be changed using the [`RecordingBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.RecordingBufferTimeLimit) property, or recording can be unlimited using the [`UseBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.UseBufferTimeLimit) option.</span></span>

<span data-ttu-id="c1581-126">Данные в буфере записи можно сохранить в двоичном файле с помощью функции [савеинпутаниматион](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.SaveInputAnimation*) .</span><span class="sxs-lookup"><span data-stu-id="c1581-126">The data in the recording buffer can be saved in a binary file using the [SaveInputAnimation](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.SaveInputAnimation*) function.</span></span>

<span data-ttu-id="c1581-127">Дополнительные сведения о формате двоичного файла см. в статье [Спецификация формата файла анимации ввода](input-animation-file-format.md).</span><span class="sxs-lookup"><span data-stu-id="c1581-127">For details on the binary file format see [Input Animation File Format Specification](input-animation-file-format.md).</span></span>

### <a name="input-playback-service"></a><span data-ttu-id="c1581-128">Входная служба воспроизведения</span><span class="sxs-lookup"><span data-stu-id="c1581-128">Input playback service</span></span>

<span data-ttu-id="c1581-129">[`InputPlaybackService`](xref:Microsoft.MixedReality.Toolkit.Input.InputPlaybackService) считывает двоичный файл со входными данными анимации, а затем применяет эти данные через [инпутсимулатионсервице](xref:Microsoft.MixedReality.Toolkit.Input.InputSimulationService) для повторного создания записанных перемещений.</span><span class="sxs-lookup"><span data-stu-id="c1581-129">[`InputPlaybackService`](xref:Microsoft.MixedReality.Toolkit.Input.InputPlaybackService) reads a binary file with input animation data and then applies this data through the [InputSimulationService](xref:Microsoft.MixedReality.Toolkit.Input.InputSimulationService) to recreate the recorded movements.</span></span>

<a target="_blank" href="../images/input-simulation/MRTK_InputAnimation_PlaybackDiagram.png">
  <img src="../images/input-simulation/MRTK_InputAnimation_PlaybackDiagram.png" title="Воспроизведение обратной анимации ввода" width="80%" alt="Play Back diagram" class="center" />
</a>

<span data-ttu-id="c1581-131">Чтобы начать воспроизводить анимацию ввода, она должна быть загружена из файла с помощью функции [лоадинпутаниматион](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LoadInputAnimation*) .</span><span class="sxs-lookup"><span data-stu-id="c1581-131">To start playing back input animation it should be loaded from a file using the [LoadInputAnimation](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LoadInputAnimation*) function.</span></span>

<span data-ttu-id="c1581-132">Вызов метода [Play](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play), [паузы](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play)или [остановки](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Stop) для управления воспроизведением анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-132">Call [Play](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play), [Pause](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play), or [Stop](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Stop) to control the animation playback.</span></span>

<span data-ttu-id="c1581-133">Текущее время анимации также можно контролировать непосредственно с помощью свойства [localtime](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) .</span><span class="sxs-lookup"><span data-stu-id="c1581-133">The current animation time can also be controlled directly with the [LocalTime](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) property.</span></span>

> [!WARNING]
> <span data-ttu-id="c1581-134">Циклический перебор или сброс анимации ввода или настройки [`LocalTime`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) непосредственно путем очистки временной шкалы могут привести к непредвиденным результатам при обработке сцены!</span><span class="sxs-lookup"><span data-stu-id="c1581-134">Looping or resetting input animation or setting [`LocalTime`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) directly by scrubbing the timeline may yield unexpected results when manipulating the scene!</span></span> <span data-ttu-id="c1581-135">Записываются только перемещения ввода, любые дополнительные изменения, такие как перемещение объектов или перевернутые коммутаторы, не будут сброшены.</span><span class="sxs-lookup"><span data-stu-id="c1581-135">Only the input movements are recorded, any additional changes such as moving objects or flipping switches will not be reset.</span></span> <span data-ttu-id="c1581-136">Обязательно перезагрузите сцену, если внесены необратимые изменения.</span><span class="sxs-lookup"><span data-stu-id="c1581-136">Make sure to reload the scene if irreversible changes have been made.</span></span>

### <a name="editor-tools-for-recording-and-playing-input-animation"></a><span data-ttu-id="c1581-137">Средства редактора для записи и воспроизведения анимации ввода</span><span class="sxs-lookup"><span data-stu-id="c1581-137">Editor tools for recording and playing input animation</span></span>

<span data-ttu-id="c1581-138">В редакторе Unity существует ряд средств для записи и изучения анимации ввода.</span><span class="sxs-lookup"><span data-stu-id="c1581-138">A number of tools exist in the Unity editor for recording and examining input animation.</span></span> <span data-ttu-id="c1581-139">доступ к этим средствам можно получить в [окне средства моделирования ввода](input-simulation-service.md#input-simulation-tools-window), которое можно открыть из меню " _смешанная реальность набор средств > служебные программы" > "имитация входа_ ".</span><span class="sxs-lookup"><span data-stu-id="c1581-139">These tools can be accessed in the [input simulation tools window](input-simulation-service.md#input-simulation-tools-window), which can be opened from the _Mixed Reality Toolkit > Utilities > Input Simulation_ menu.</span></span>

> [!NOTE]
> <span data-ttu-id="c1581-140">Запись и воспроизведение входных данных работают только в режиме воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="c1581-140">Input recording and playback only works during play mode.</span></span>

<span data-ttu-id="c1581-141">Окно записи ввода имеет два режима:</span><span class="sxs-lookup"><span data-stu-id="c1581-141">The input recording window has two modes:</span></span>

* <span data-ttu-id="c1581-142">_Запись_ для записи входных данных в режиме воспроизведения и их сохранение в файлах анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-142">_Recording_ for recording input during play mode and saving it to animation files.</span></span>

  <span data-ttu-id="c1581-143">При переключении на кнопку запись [`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) включается для записи входных данных.</span><span class="sxs-lookup"><span data-stu-id="c1581-143">When toggling on the recording button the [`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) is enabled to record input.</span></span>
  <span data-ttu-id="c1581-144">При отключении кнопки записи отображается выбранный файл сохранение, а Записанная анимация ввода сохраняется в выбранном месте назначения.</span><span class="sxs-lookup"><span data-stu-id="c1581-144">When toggling off the recording button a file save selection is shown and the recorded input animation is saved to the selected destination.</span></span>

  <span data-ttu-id="c1581-145">В этом режиме можно также изменить ограничение времени буфера.</span><span class="sxs-lookup"><span data-stu-id="c1581-145">The buffer time limit can also be changed in this mode.</span></span>

* <span data-ttu-id="c1581-146">_Воспроизведение_ для загрузки файлов анимации и последующее повторное создание входных данных с помощью системы имитации ввода.</span><span class="sxs-lookup"><span data-stu-id="c1581-146">_Playback_ for loading animation files and then recreating input through the input simulation system.</span></span>

  <span data-ttu-id="c1581-147">Сначала необходимо загрузить анимацию в этом режиме.</span><span class="sxs-lookup"><span data-stu-id="c1581-147">An animation must be loaded in this mode first.</span></span> <span data-ttu-id="c1581-148">После записи входных данных в режиме записи Результирующая анимация загружается автоматически.</span><span class="sxs-lookup"><span data-stu-id="c1581-148">After recording input in recording mode the resulting animation is automatically loaded.</span></span> <span data-ttu-id="c1581-149">Можно также нажать кнопку "Загрузить", чтобы выбрать существующий файл анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-149">Alternatively click the "Load" button to select an existing animation file.</span></span>

  <span data-ttu-id="c1581-150">Кнопки управления временем слева направо:</span><span class="sxs-lookup"><span data-stu-id="c1581-150">The time control buttons from left to right are:</span></span>

  * <span data-ttu-id="c1581-151">_Сброс_ времени воспроизведения до начала анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-151">_Reset_ the playback time to the start of the animation.</span></span>
  * <span data-ttu-id="c1581-152">Постоянно _воспроизводить_ анимацию со временем.</span><span class="sxs-lookup"><span data-stu-id="c1581-152">_Play_ animation continuously over time.</span></span>
  * <span data-ttu-id="c1581-153">_Шаг_ вперед на один шаг.</span><span class="sxs-lookup"><span data-stu-id="c1581-153">_Step_ forward one time step.</span></span>

  <span data-ttu-id="c1581-154">Ползунок также можно использовать для очистки временной шкалы анимации.</span><span class="sxs-lookup"><span data-stu-id="c1581-154">The slider can also be used to scrub through the animation timeline.</span></span>

> [!WARNING]
> <span data-ttu-id="c1581-155">Циклическая или сброс анимации ввода или Очистка временной шкалы может привести к непредвиденным результатам при управлении сценой.</span><span class="sxs-lookup"><span data-stu-id="c1581-155">Looping or resetting input animation or scrubbing the timeline may yield unexpected results when manipulating the scene!</span></span> <span data-ttu-id="c1581-156">Записываются только перемещения ввода, любые дополнительные изменения, такие как перемещение объектов или перевернутые коммутаторы, не будут сброшены.</span><span class="sxs-lookup"><span data-stu-id="c1581-156">Only the input movements are recorded, any additional changes such as moving objects or flipping switches will not be reset.</span></span> <span data-ttu-id="c1581-157">Обязательно перезагрузите сцену, если внесены необратимые изменения.</span><span class="sxs-lookup"><span data-stu-id="c1581-157">Make sure to reload the scene if irreversible changes have been made.</span></span>
