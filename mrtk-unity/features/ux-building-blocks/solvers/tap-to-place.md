---
title: Размещение касанием
description: Документация по MRTK TapToPlace
author: CDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
ms.localizationpriority: high
keywords: Unity, HoloLens, HoloLens 2, смешанная реальность, разработка, MRTK, размещение касанием, Tap to Place,
ms.openlocfilehash: 1664509a08c2d589d22b71df580328f3f3655c61
ms.sourcegitcommit: f338b1f121a10577bcce08a174e462cdc86d5874
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2021
ms.locfileid: "113176405"
---
# <a name="tap-to-place"></a><span data-ttu-id="2b9a5-104">Размещение касанием</span><span class="sxs-lookup"><span data-stu-id="2b9a5-104">Tap to place</span></span>

![TapToPlace](../../images/solver/tap-to-place/TapToPlaceIntroGif.gif)

<span data-ttu-id="2b9a5-106">Размещение касанием — это компонент дальнего взаимодействия, который используется для размещения игрового объекта на поверхности.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-106">Tap to Place is a far interaction component that is used to place a game object on surface.</span></span> <span data-ttu-id="2b9a5-107">Он полезен для размещения объектов на виртуальной сетке.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-107">This component is useful for placing objects on a spatial mesh.</span></span> <span data-ttu-id="2b9a5-108">Для размещения объекта с помощью этого компонента требуется сочетание двух щелчков мыши и движение головой.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-108">Tap to Place uses a combination of two clicks and head movement to place an object.</span></span> <span data-ttu-id="2b9a5-109">Щелкните, чтобы начать размещение, сделайте движение головой, чтобы управлять положением объекта, и щелкните, чтобы поместить объект на сцене.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-109">A click to start the placement, head movement to control the position of the object and a click to place the object in the scene.</span></span>

## <a name="using-tap-to-place"></a><span data-ttu-id="2b9a5-110">Использование размещения касанием</span><span class="sxs-lookup"><span data-stu-id="2b9a5-110">Using Tap to Place</span></span>

1. <span data-ttu-id="2b9a5-111">Настройка сцены</span><span class="sxs-lookup"><span data-stu-id="2b9a5-111">Set up the scene</span></span>
    - <span data-ttu-id="2b9a5-112">Создание сцены Unity</span><span class="sxs-lookup"><span data-stu-id="2b9a5-112">Create a new unity scene</span></span>
    - <span data-ttu-id="2b9a5-113">Добавьте MRTK в сцену, перейдя к **Mixed Reality Toolkit** (Набор средств смешанной реальности)  >  **Add to Scene and Configure** (Добавить в сцену и настроить).</span><span class="sxs-lookup"><span data-stu-id="2b9a5-113">Add MRTK to the scene by navigating to the **Mixed Reality Toolkit** > **Add to Scene and Configure**</span></span>
    > [!NOTE]
    > <span data-ttu-id="2b9a5-114">Размещение касанием использует щелчки, которые управляются системой ввода MRTK, но им также можно управлять без щелчков. Чтобы узнать, как, см. раздел "Настройка кода для размещения касанием" ниже.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-114">Tap to Place uses clicks driven by the MRTK Input System but it can also be controlled without clicks, see the Tap To Place Code Configurability section below.</span></span>
    - <span data-ttu-id="2b9a5-115">Добавьте куб в сцену и измените масштаб на 0,2, а расположение — на (0; 0; 0,7).</span><span class="sxs-lookup"><span data-stu-id="2b9a5-115">Add a cube to the scene and change the scale to 0.2 and change the position to (0, 0, 0.7).</span></span>
1. <span data-ttu-id="2b9a5-116">Присоедините [размещение касанием](xref:Microsoft.MixedReality.Toolkit.Utilities.Solvers.TapToPlace) к игровому объекту с помощью коллайдера.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-116">Attach [Tap to Place](xref:Microsoft.MixedReality.Toolkit.Utilities.Solvers.TapToPlace) to a game object with a collider</span></span>

    ![TapToPlaceInspector](../../images/solver/tap-to-place/TapToPlaceInspector2.png)

    - <span data-ttu-id="2b9a5-118">При добавлении компонента размещения касанием будет также присоединен обработчик решателя.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-118">When the Tap to Place component is added, a Solver Handler will also be attached.</span></span> <span data-ttu-id="2b9a5-119">Размещение касанием происходит от класса [Solver](solver.md), для которого требуется обработчик решателя.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-119">Tap to Place derives from the [Solver](solver.md) class which requires a Solver Handler.</span></span> <span data-ttu-id="2b9a5-120">Расположение объекта размещения касанием вычисляется относительно элемента `TrackedTargetType` в обработчике решателя.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-120">The position of a Tap to Place object is calculated relative to the `TrackedTargetType` within the Solver Handler.</span></span> <span data-ttu-id="2b9a5-121">По умолчанию заголовком является `TrackedTargetType`, т. е. при движении головой объект следует за ней, если он выбран.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-121">By default the Head is the `TrackedTargetType`, i.e. when the head moves, the object follows if it is selected.</span></span>  <span data-ttu-id="2b9a5-122">`TrackedTargetType` также можно задать значение луча контроллера, в котором объект следует за контроллером.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-122">The `TrackedTargetType` can also be set to Controller Ray which has the object follow the controller.</span></span> <span data-ttu-id="2b9a5-123">Первой группой свойств в инспекторе размещения касанием являются [общие свойства решателя](solver.md#common-solver-properties).</span><span class="sxs-lookup"><span data-stu-id="2b9a5-123">The first group of properties in the Tap to Place inspector are the [Common Solver Properties](solver.md#common-solver-properties).</span></span>  
    > [!IMPORTANT]
    > <span data-ttu-id="2b9a5-124">Размещение касанием — это автономный решатель, который невозможно поставить в цепочку с другими решателями.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-124">Tap to Place is a stand alone Solver and cannot be chained with other Solvers.</span></span> <span data-ttu-id="2b9a5-125">Он не может быть помещен в цепочку, так как SolverHandler.UpdateSolvers используется для обновления расположения объекта во время его размещения.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-125">It cannot be chained because SolverHandler.UpdateSolvers is used to update the object's position while it is being placed.</span></span>
    - <span data-ttu-id="2b9a5-126">Свойства размещения касанием:</span><span class="sxs-lookup"><span data-stu-id="2b9a5-126">Tap to Place Properties:</span></span>
        - <span data-ttu-id="2b9a5-127">`Auto Start`: если задано значение True, решатель размещения касанием начнет управлять положением игрового объекта для размещения.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-127">`Auto Start`: If true, the Tap to Place solver will start out controlling the position of the game object to be placed.</span></span> <span data-ttu-id="2b9a5-128">Объект немедленно начнется следовать за TrackedTargetType (головой или лучом контроллера).</span><span class="sxs-lookup"><span data-stu-id="2b9a5-128">The object will immediately start following the TrackedTargetType (Head or Controller Ray).</span></span> <span data-ttu-id="2b9a5-129">Это значение должно быть изменено перед вызовом Start() для выполнения любого действия.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-129">This value must be modified before Start() is invoked in order to have any effect.</span></span>
        - <span data-ttu-id="2b9a5-130">`Default Placement Distance`: расстояние по умолчанию (в метрах), на которое будет помещен объект по отношению к TrackedTargetType вперед в SolverHandler.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-130">`Default Placement Distance`: The default distance (in meters) an object will be placed relative to the TrackedTargetType forward in the SolverHandler.</span></span> <span data-ttu-id="2b9a5-131">Игровой объект будет размещен на расстоянии по умолчанию, если поверхность не достигнута лучом.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-131">The game object will be placed at the default placement distance if a surface is not hit by the raycast.</span></span>
        - <span data-ttu-id="2b9a5-132">`Max Raycast Distance`: максимальное расстояние (в метрах) для луча, основанное на источнике TrackedTargetType.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-132">`Max Raycast Distance`: The max distance (meters) for the raycast based on the 'TrackedTargetType' origin.</span></span> <span data-ttu-id="2b9a5-133">Этот луч ищет поверхность для размещения выбранного объекта.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-133">This raycast looks for a surface to place a selected object.</span></span>
        - <span data-ttu-id="2b9a5-134">`UseDefaultSurfaceNormalOffset`: это свойство имеет значение True по умолчанию, что гарантирует, что размещаемый объект будет располагаться на поверхности.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-134">`UseDefaultSurfaceNormalOffset`: This property is true by default, it ensures the object being placed is aligned on a surface.</span></span> <span data-ttu-id="2b9a5-135">Если это свойство имеет значение True, то вместо любого значения, указанного для свойства `SurfaceNormalOffset`, будет применено стандартное смещение нормали поверхности по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-135">If this property is true, the default surface normal offset will be applied instead of any value specified for the `SurfaceNormalOffset` property.</span></span> <span data-ttu-id="2b9a5-136">Если задано значение False, будет применено значение для `SurfaceNormalOffset`.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-136">If false, the value for `SurfaceNormalOffset` will be applied.</span></span> <span data-ttu-id="2b9a5-137">Смещение нормали поверхности по умолчанию — это экстент коллайдера вдоль оси Z.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-137">The default surface normal offset is the collider's extents along the z axis.</span></span>
        - <span data-ttu-id="2b9a5-138">`Surface Normal Offset`: расстояние между центром игрового объекта, который нужно разместить, и нормали поверхности, если луч достигает поверхности.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-138">`Surface Normal Offset`: The distance between the center of the game object to place and a surface along the surface normal, if the raycast hits a surface.</span></span> <span data-ttu-id="2b9a5-139">Это свойство применяется к объекту только в том случае, если `UseDefaultSurfaceNormalOffset` имеет значение False.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-139">This property is only applied to an object if `UseDefaultSurfaceNormalOffset` is false.</span></span>
        - <span data-ttu-id="2b9a5-140">`Keep Orientation Vertical`: если значение равно True, игровой объект будет находиться вертикально и на одной линии с Vector3.up.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-140">`Keep Orientation Vertical`: If true, the game object to place will remain upright and in line with Vector3.up.</span></span>
        - <span data-ttu-id="2b9a5-141">`Rotate According to Surface`: если значение равно False, то размещаемый игровой объект не будет изменять свой поворот в зависимости от удара по поверхности.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-141">`Rotate According to Surface`: If false, the game object to place will not change its rotation according to the surface hit.</span></span>  <span data-ttu-id="2b9a5-142">Объект будет оставаться повернутым к камере, пока IsBeingPlaced имеет значение True.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-142">The object will remain facing the camera while IsBeingPlaced is true.</span></span>
        - <span data-ttu-id="2b9a5-143">`Magnetic Surfaces`: массив объектов LayerMasks для выполнения от высшего до самого низкого приоритета.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-143">`Magnetic Surfaces`: An array of LayerMasks to execute from highest to lowest priority.</span></span> <span data-ttu-id="2b9a5-144">Маска первого слоя, обеспечивающая попадание луча, будет использоваться для расчетов положения.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-144">First layer mask to provide a raycast hit will be used for position calculations.</span></span>
        - <span data-ttu-id="2b9a5-145">`Debug Enabled`: если значение равно True и в редакторе Unity, нормаль попадания луча будет нарисована желтым цветом.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-145">`Debug Enabled`: If true and in the Unity Editor, the normal of the raycast hit will be drawn in yellow.</span></span> <span data-ttu-id="2b9a5-146">Включенная отладка полезна, если `RotateAccordingToSurface` имеет значение True, так как она рисует нормаль к поверхности, что визуально объясняет, почему объект установлен в текущей ориентации.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-146">Debug enabled is useful when `RotateAccordingToSurface` is true because it draws the normal of the surface hit which visually explains why the object is set at its current orientation.</span></span>
        - <span data-ttu-id="2b9a5-147">`On Placing Started`: это событие активируется один раз при выборе игрового объекта, который нужно разместить.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-147">`On Placing Started`: This event is triggered once when the game object to place is selected.</span></span>
        - <span data-ttu-id="2b9a5-148">`On Placing Stopped`: это событие активируется один раз при отмене выбора размещенного игрового объекта.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-148">`On Placing Stopped`: This event is triggered once when the game object to place is unselected, placed.</span></span>

1. <span data-ttu-id="2b9a5-149">Тестирование поведения размещения касанием в редакторе</span><span class="sxs-lookup"><span data-stu-id="2b9a5-149">Testing Tap to Place behavior in editor</span></span>
    - <span data-ttu-id="2b9a5-150">Нажмите кнопку воспроизведения и удерживайте пробел, чтобы отобразить руку имитации ввода.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-150">Press play and hold the space bar to show an input simulation hand.</span></span>
    - <span data-ttu-id="2b9a5-151">Двигайте рукой до тех пор, пока куб не станет активным, и имитируйте щелчок с помощью руки, щелкнув левой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-151">Move the hand until the cube is in focus and simulate a click with the input simulation hand by clicking with the left mouse.</span></span>
        - <span data-ttu-id="2b9a5-152">Если в сцене отсутствуют коллайдеры, объект будет следовать за объектом `TrackedTargetType` на определенном расстоянии `Default Placement Distance`.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-152">If colliders are not present in the scene, the object will follow the `TrackedTargetType` at the defined `Default Placement Distance`.</span></span>
    - <span data-ttu-id="2b9a5-153">Объект будет следовать за перемещением `TrackedTargetType` после выбора.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-153">The object will follow the movement of the `TrackedTargetType` after selection.</span></span> <span data-ttu-id="2b9a5-154">Чтобы имитировать движение головой в редакторе, нажимайте клавиши WASD.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-154">To simulate head movement in editor, press the WASD keys.</span></span> <span data-ttu-id="2b9a5-155">Измените поворот головы, щелкнув и удерживая правую кнопку мыши.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-155">Change head rotation by clicking and holding the right mouse.</span></span>
    - <span data-ttu-id="2b9a5-156">Чтобы остановить размещение объекта, щелкните еще раз.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-156">To stop placing the object, click again.</span></span>  <span data-ttu-id="2b9a5-157">Объект не обязательно должен находиться в фокусе при нажатии для завершения размещения.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-157">The object does not need to be in focus for the stop placement click.</span></span> <span data-ttu-id="2b9a5-158">Фокус необходим только для начального щелчка, запускающего процесс размещения.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-158">Focus is only required for the initial click that starts the placement process.</span></span>

    <span data-ttu-id="2b9a5-159">`TrackedTargetType`: голова (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="2b9a5-159">`TrackedTargetType`: Head (Default)</span></span> |  <span data-ttu-id="2b9a5-160">`TrackedTargetType`: луч контроллера</span><span class="sxs-lookup"><span data-stu-id="2b9a5-160">`TrackedTargetType`: Controller Ray</span></span>
    :-------------------------:|:-------------------------:
    ![Луч контроля головой для имитации ввода при размещении касанием](../../images/solver/tap-to-place/TapToPlaceInputSimulationHead.gif)  |  ![Луч контролера для имитации ввода при размещении касанием 2](../../images/solver/tap-to-place/TapToPlaceInputSimulationControllerRay.gif)

## <a name="tap-to-place-code-configurability"></a><span data-ttu-id="2b9a5-163">Настройка кода для размещения касанием</span><span class="sxs-lookup"><span data-stu-id="2b9a5-163">Tap to Place Code Configurability</span></span>

<span data-ttu-id="2b9a5-164">Временем выбора объекта для размещения касанием также можно управлять с помощью `StartPlacement()` и `StopPlacement()` вместо того, чтобы требовать событие щелчка.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-164">Tap to Place object selection timing can also be controlled via `StartPlacement()` and `StopPlacement()` instead of requiring a click event.</span></span> <span data-ttu-id="2b9a5-165">Эта возможность полезна для написания тестов и предоставляет альтернативный способ размещения объекта в редакторе без использования системы ввода MRTK.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-165">This capability is useful for writing tests and provides an alternative method to place an object in editor without using the MRTK Input System.</span></span>

1. <span data-ttu-id="2b9a5-166">Создайте пустой игровой объект.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-166">Create an empty game object</span></span>
1. <span data-ttu-id="2b9a5-167">Создайте и присоедините следующий пример скрипта к пустому игровому объекту.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-167">Create and attach the following example script to the empty game object</span></span>

    ```c#
    using UnityEngine;
    using Microsoft.MixedReality.Toolkit.Utilities.Solvers;

    public class TapToPlaceInputExample : MonoBehaviour
    {
        private GameObject cube;
        private TapToPlace tapToPlace;

        void Start()
        {
            cube = GameObject.CreatePrimitive(PrimitiveType.Cube);
            cube.transform.localScale = Vector3.one * 0.2f;
            cube.transform.position = Vector3.forward * 0.7f;

            tapToPlace = cube.AddComponent<TapToPlace>();
        }

        void Update()
        {
            if (Input.GetKeyDown(KeyCode.U))
            {
                tapToPlace.StartPlacement();
            }
            if (Input.GetKeyDown(KeyCode.I))
            {
                tapToPlace.StopPlacement();
            }
        }
    }
    ```

1. <span data-ttu-id="2b9a5-168">В режиме воспроизведения нажмите клавишу *U*, чтобы начать размещение куба.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-168">In play mode, press the *U key* to start placing the cube</span></span>
1. <span data-ttu-id="2b9a5-169">Нажмите клавишу *I*, чтобы прервать размещение.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-169">Press the *I key* to stop the placement</span></span>

## <a name="tap-to-place-example-scene"></a><span data-ttu-id="2b9a5-170">Пример сцены с размещением касанием</span><span class="sxs-lookup"><span data-stu-id="2b9a5-170">Tap to Place Example Scene</span></span>

<span data-ttu-id="2b9a5-171">Пример сцены с размещением касанием состоит из четырех размещенных объектов, каждый из которых имеет разную конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-171">The Tap to Place example scene consists of 4 placeable objects, each with a different configuration.</span></span> <span data-ttu-id="2b9a5-172">Пример сцены содержит стены, которые показывают поведение размещения поверхности, отключенное по умолчанию в иерархии.</span><span class="sxs-lookup"><span data-stu-id="2b9a5-172">The example scene contains walls to show the surface placement behavior that are disabled by default in the hierarchy.</span></span> <span data-ttu-id="2b9a5-173">Пример сцены можно найти в пакете Unity Microsoft.MixedReality.Toolkit.Unity.Examples на [странице выпуска](https://github.com/Microsoft/MixedRealityToolkit-Unity/releases).</span><span class="sxs-lookup"><span data-stu-id="2b9a5-173">The example scene can be found in the Microsoft.MixedReality.Toolkit.Unity.Examples unity package found on the [Release Page](https://github.com/Microsoft/MixedRealityToolkit-Unity/releases).</span></span> <span data-ttu-id="2b9a5-174">Расположение сцены: *MRTK.Examples/Demos/Solvers/Scenes/TapToPlaceExample.unity*</span><span class="sxs-lookup"><span data-stu-id="2b9a5-174">The scene location is: *MRTK.Examples/Demos/Solvers/Scenes/TapToPlaceExample.unity*</span></span>

![Пример размещения касанием](../../images/solver/tap-to-place/TapToPlaceExampleScene.gif)

## <a name="see-also"></a><span data-ttu-id="2b9a5-176">См. также</span><span class="sxs-lookup"><span data-stu-id="2b9a5-176">See also</span></span>

- [<span data-ttu-id="2b9a5-177">Решатели</span><span class="sxs-lookup"><span data-stu-id="2b9a5-177">Solvers</span></span>](solver.md)
- [<span data-ttu-id="2b9a5-178">Отслеживание пространственного положения</span><span class="sxs-lookup"><span data-stu-id="2b9a5-178">Spatial Awareness</span></span>](../../spatial-awareness/spatial-awareness-getting-started.md)
- [<span data-ttu-id="2b9a5-179">Имитация ввода</span><span class="sxs-lookup"><span data-stu-id="2b9a5-179">Input Simulation</span></span>](../../input-simulation/input-simulation-service.md)
- [<span data-ttu-id="2b9a5-180">Отслеживание рук</span><span class="sxs-lookup"><span data-stu-id="2b9a5-180">Hand Tracking</span></span>](../../input/hand-tracking.md)
- [<span data-ttu-id="2b9a5-181">Взгляд</span><span class="sxs-lookup"><span data-stu-id="2b9a5-181">Gaze</span></span>](../../input/gaze.md)
