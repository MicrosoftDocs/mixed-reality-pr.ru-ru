---
title: Калибровка взгляда
description: Как настроить калибровку глаз пользователя в МРТК
author: CDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, смешанная реальность, разработка, мртк, эйетраккинг, калибровка,
ms.openlocfilehash: 02b173bbc7a6bf410d3521b37660f292b8e3340de6b1a98007fdbc200f26bc49
ms.sourcegitcommit: a1c086aa83d381129e62f9d8942f0fc889ffcab0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "115199776"
---
# <a name="eye-calibration"></a>Калибровка взгляда

![Снимок экрана с уведомлением об калибровке глаз](../../images/eye-tracking/mrtk_et_calibration_notification_example.jpg)

## <a name="overview"></a>Общие сведения

Если отслеживание взгляда является фундаментальной частью работы приложения, то может потребоваться обеспечить правильную калибровку пользователя.
Основная причина, по которой она будет недействительной, заключается в том, что пользователь решил пропустить калибровку отслеживания взгляда при размещении на устройстве.

На этой странице рассматриваются следующие вопросы:

- Описывает, как определить, что пользователь имеет откалиброванный глаз
- В этом примере показано, как активировать уведомление пользователя, чтобы сообщить пользователю о необходимости пройти калибровку глаз.
  - Автоматически отклонять уведомление, если калибровка глаз станет действительной
  - Вручную закрыть уведомление, если пользователь решил продолжить без калибровки

### <a name="how-to-detect-the-eye-calibration-state"></a>Как определить состояние калибровки глаз

Конфигурация отслеживания взгляда в МРТК настраивается через [`IMixedRealityEyeGazeProvider`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityEyeGazeProvider) интерфейс.

Использование [коресервицес. инпутсистем. эйегазепровидер](eye-tracking-eye-gaze-provider.md) предоставляет реализацию поставщика взгляда по умолчанию, зарегистрированную в наборе средств во время выполнения. `IMixedRealityEyeGazeProvider.IsEyeGazeValid` Возвращает значение типа, `bool?` равное NULL, если данные из средства регистрации взглядов еще не доступны.
После получения данных будет возвращено значение true или false, чтобы указать, что калибровка отслеживания взгляда пользователя является допустимой или недопустимой.

### <a name="sample-eye-calibration-notification---step-by-step"></a>Уведомление об калибровке образца глаз — пошаговые инструкции

1. Откройте пример пакета отслеживания взгляда МРТК (Assets/МРТК/examples/демонстрации/Эйетраккинг)

2. Загрузка сцены _эйетраккингдемо-00-рутсцене. Unity_

3. Ознакомьтесь с _эйекалибратиончеккер_:
   - В этой сцене уже есть пример, с помощью которого можно определить, откалиброван ли текущий пользователь в *игровом объекте _эйекалибратиончеккер_*.
Он просто объединяет несколько текстовых сеток и имеет несколько дополнительных триггеров для смешения уведомлений. Это включает в себя медленно увеличивающийся размер и непрозрачность при активации.
Как только уведомление будет закрыто, оно постепенно снизит его размер и плавно уменьшится.

   - К *игровому объекту _эйекалибратиончеккер_* прикрепляется скрипт [Эйекалибратиончеккер](xref:Microsoft.MixedReality.Toolkit.Examples.Demos.EyeTracking.EyeCalibrationChecker) , который предоставляет два события Unity:
      - `OnEyeCalibrationDetected()`
      - `OnNoEyeCalibrationDetected()`

   - Эти события будут запускаться только при изменении состояния калибровки. Таким образом, если пользователь откроет уведомление, уведомление не отобразится снова до тех пор, пока
      - Приложение перезапускается
      - Обнаружен допустимый пользователь, а затем новый некалиброванный пользователь поместит устройство в

   - Чтобы проверить, правильно ли запущены анимации и события, сценарий Эйекалибратиончеккер имеет `bool editorTestUserIsCalibrated` флаг. Например, при запуске в редакторе Unity можно протестировать:
      1. Будет ли уведомление автоматически выводится после того, как состояние калибровки изменится с true на false
      1. Будет ли он автоматически закрывать уведомление после изменения состояния с false на true.

```c#
    private bool? prevCalibrationStatus = null;
    ...

   void Update()
   {
      // Get the latest calibration state from the EyeGazeProvider
      bool? calibrationStatus = CoreServices.InputSystem?.EyeGazeProvider?.IsEyeCalibrationValid;

      ...

      if (calibrationStatus != null)
      {
         if (prevCalibrationStatus != calibrationStatus)
         {
            if (calibrationStatus == false)
            {
               OnNoEyeCalibrationDetected.Invoke();
            }
         else
         {
            OnEyeCalibrationDetected.Invoke();
         }

         prevCalibrationStatus = calibrationStatus;
      }
   }
```

## <a name="see-also"></a>См. также раздел

- [Общие сведения об отслеживании МРТКных глаз](eye-tracking-main.md)
- [Настройка отслеживания МРТКных глаз](eye-tracking-basic-setup.md)
- [Отслеживание взгляда МРТК с помощью кода](eye-tracking-eye-gaze-provider.md)
- [HoloLens 2 Документация по отслеживанию глаз](/windows/mixed-reality/eye-tracking)
