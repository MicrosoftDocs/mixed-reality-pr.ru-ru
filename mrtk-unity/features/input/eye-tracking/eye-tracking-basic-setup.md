---
title: Отслеживание взгляда — базовая настройка
description: Как настроить отслеживание взглядов в МРТК
author: CDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, Смешанная реальность, разработка, МРТК, отслеживание глаз,
ms.openlocfilehash: 0513161bf8151069296c39612cbcacd15cc5c6c1
ms.sourcegitcommit: c0ba7d7bb57bb5dda65ee9019229b68c2ee7c267
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "110144091"
---
# <a name="getting-started-with-eye-tracking-in-mrtk"></a>Приступая к работе с отслеживанием взгляда в МРТК

На этой странице описано, как настроить сцену МРТК для Unity для использования отслеживания взгляда в приложении.
В следующем примере предполагается, что вы начинаете с новой сцены.
Кроме того, вы можете просмотреть уже настроенные [примеры отслеживания мрткных глаз](../../example-scenes/eye-tracking-examples-overview.md) с помощью тонн с превосходными примерами, которые можно создавать напрямую.

## <a name="eye-tracking-requirements-checklist"></a>Контрольный список требований к отслеживанию глаз

Чтобы отслеживание взгляда работало правильно, должны выполняться следующие требования.
Если вы не знакомы с отслеживанием взгляда на HoloLens 2 и в МРТК, не беспокойтесь!
Мы подробно рассмотрим, как устранить эти шаги ниже.

1. В систему ввода должен быть добавлен _"поставщик данных_ с взглядом на глаза". Это предоставляет данные отслеживания взгляда с платформы.
2. Возможность _"газеинпут"_ должна быть включена в манифесте приложения.
   **Эта возможность может быть задана в Unity 2019, но в Unity 2018 и более ранних версиях эта возможность доступна только в Visual Studio и с помощью средства сборки МРТК.**
3. Для текущего пользователя HoloLens **должен** быть калибровкой. Ознакомьтесь с нашим [образцом, чтобы определить, является ли пользователь откалиброванным глазом](eye-tracking-is-user-calibrated.md).

### <a name="a-note-on-the-gazeinput-capability"></a>Примечание о возможности Газеинпут

Предоставляемые МРТК средства сборки (т. е. набор средств для смешанной реальности, > служебные программы — > сборка) могут автоматически включить возможность Газеинпут. Для этого необходимо убедиться, что на вкладке "параметры сборки appx" установлен флажок "возможность ввода с клавиатуры".

![Средства сборки МРТК](../../images/eye-tracking/mrtk_et_buildsetup.png)

Это средство обнаружит манифест AppX после завершения сборки Unity и добавит функцию Газеинпут вручную.
**До Unity 2019 эта программа неактивна при использовании встроенного окна сборки Unity** (т. е. параметров сборки > файлов).

До Unity 2019 при использовании окна сборки Unity эту возможность потребуется вручную добавить после сборки Unity следующим образом:

1. Откройте скомпилированный проект Visual Studio, а затем откройте в решении _"Package. appxmanifest"_ .
2. Установите флажок _"газеинпут"_ в разделе " _возможности_". Если вы не видите возможность _"газеинпут"_ , убедитесь, что ваша система соответствует [предварительным требованиям для использования мртк](/windows/mixed-reality/develop/install-the-tools) (в частности Windows SDK версии).

_Примечание._ Это необходимо сделать только в том случае, если сборка выполняется в новую папку сборки.
Это означает, что если вы уже создали проект Unity и настроили appxmanifest до и теперь нацелить эту же папку, вам не потребуется повторно применять изменения.

## <a name="setting-up-eye-tracking-step-by-step"></a>Пошаговая настройка отслеживания взгляда

### <a name="setting-up-the-scene"></a>Настройка сцены

Настройте _микседреалититулкит_ , просто щелкнув _"набор средств" Mixed Reality "— > configure..."_ в строке меню.

![Настройка МРТК](../../images/eye-tracking/mrtk_setup_configure.jpg)

### <a name="setting-up-the-mrtk-profiles-required-for-eye-tracking"></a>Настройка профилей МРТК, необходимых для отслеживания взгляда

После настройки сцены МРТК вам будет предложено выбрать профиль для МРТК.
Можно просто выбрать _дефаултмикседреалититулкитконфигуратионпрофиле_ , а затем выбрать параметр _"Копировать & настройку"_ .

![Профиль МРТК](../../images/eye-tracking/mrtk_setup_configprofile.jpg)

### <a name="create-an-eye-gaze-data-provider"></a>Создание поставщика данных "взгляд глаз"

- Щелкните вкладку _"вход"_ в профиле мртк.
- Чтобы изменить значение по умолчанию ( _"дефаултмикседреалитинпутсистемпрофиле"_ ), нажмите кнопку _"клонировать"_ рядом с ним. Откроется меню _"профиль клона"_ . Просто щелкните _клон_ в нижней части этого меню.
- Дважды щелкните новый входной профиль, разверните узел _"входные поставщики данных"_ и выберите _"+ добавить поставщик данных"_.
- Создать новый поставщик данных:
  - В разделе **тип** выберите _Microsoft. микседреалити. Toolkit. виндовсмикседреалити. Input '_  ->  _' виндовсмикседреалитеегазедатапровидер '_
  - Для **платформ** выберите _"универсальная платформа Windows"_.

![Поставщик данных МРТК](../../images/eye-tracking/mrtk_setup_eyes_dataprovider.jpg)

### <a name="simulating-eye-tracking-in-the-unity-editor"></a>Имитация отслеживания взгляда в редакторе Unity

Вы можете имитировать входные данные отслеживания взгляда в редакторе Unity, чтобы обеспечить правильную активацию событий до развертывания приложения в HoloLens 2.
Сигнал взгляда глаза имитируется путем простого использования расположения камеры в качестве источника глаза и вектора перенаправления камеры в качестве направления взгляда.
Хотя это отлично подходит для первоначального тестирования, обратите внимание, что он не является хорошим имитацией для быстрого перемещения глаз.
Для этого лучше обеспечить частые тесты взаимодействий на основе класса HoloLens 2.

1. **Включить имитацию отслеживания взгляда**:
    - Щелкните вкладку _"вход"_ в профиле конфигурации мртк.
    - После этого перейдите к пункту "входные _поставщики данных"_  ->  .
    - Клонировать _"дефаултмикседреалитинпутсимпулатионпрофиле"_ , чтобы внести в него изменения.
    - Установите флажок _"имитировать расположение глаз"_ .

    ![Имитация МРТКных глаз](../../images/eye-tracking/mrtk_setup_eyes_simulate.jpg)

2. **Отключить курсор по умолчанию для головного взгляда**: в целом рекомендуется избегать отображения курсора глаза или, если необходимо, сделать его _очень_ незаметным.
Мы советуем скрыть курсор Head по умолчанию, который по умолчанию присоединен к профилю указателя МРТК.
    - Перейдите к профилю конфигурации мртк-> _"входные_"  ->  _"указатели"_ .
    - Клонировать _"дефаултмикседреалитинпутпоинтерпрофиле"_ , чтобы внести в него изменения.
    - В верхней части параметра _"Параметры указателя"_ следует назначить _"газекурсор"_ невидимый курсор prefab. Это можно сделать, выбрав prefab _"эйегазекурсор"_ в мртк Foundation.

### <a name="enabling-eye-based-gaze-in-the-gaze-provider"></a>Включение взгляда на основе глаз в поставщике взгляда

В HoloLens v1 в качестве основного указывающего метода использовался головной взгляд.
Несмотря на то, что головной взгляд по-прежнему доступен через _газепровидер_ в мртк, присоединенном к [камере](https://docs.unity3d.com/ScriptReference/Camera.html), можно проверить использование взгляда глаз, поделенную на флажок _"исэйетраккинженаблед"_ в параметрах взгляда профиля входного указателя.

>[!NOTE]
>Разработчики могут переключаться между взглядом на глаза и взглядом на заголовки в коде, изменяя свойство _"исэйетраккинженаблед"_ объекта _"газепровидер"_.  

>[!IMPORTANT]
>Если какие-либо требования к отслеживанию взгляда не выполняются, приложение автоматически перейдет к взгляду на голове.

### <a name="accessing-eye-gaze-data"></a>Доступ к данным взгляда на глаза

Теперь, когда сцена настроена на использование отслеживания взгляда, давайте посмотрим, как получить к ним доступ в скриптах: доступ к [данным отслеживания взгляда через эйегазепровидер](eye-tracking-eye-gaze-provider.md) и [Поддерживаемые варианты целевого объекта](eye-tracking-target-selection.md).

### <a name="testing-your-unity-app-on-a-hololens-2"></a>Тестирование приложения Unity в HoloLens 2

Создание приложения с отслеживанием взгляда должно быть похоже на то, как будут компилироваться другие приложения МРТК HoloLens 2. Убедитесь, что включена возможность ввода с помощью *взгляда* , как описано выше в разделе [*а Примечание о возможности газеинпут*](#a-note-on-the-gazeinput-capability).

#### <a name="eye-calibration"></a>Калибровка глаз

Наконец, не забудьте выполнить калибровку глаз в HoloLens 2.
Система отслеживания взгляда не будет возвращать никаких входных данных, если пользователь не откалиброван.
Самый простой способ перейти к калибровке заключается в зеркальном отображении гипервизора и резервном копировании.
Системное уведомление должно появиться, дружелюбны вас как новый пользователь, и попросит вас пройти по калибровке глаз.
Кроме того, можно найти калибровку глаз в окне Системные параметры: параметры > калибровка > системы > калибровка глаз.

#### <a name="eye-tracking-permission"></a>Разрешение на отслеживание глаз

При первом запуске приложения в HoloLens 2 будет выведен запрос на разрешение пользователя на использование отслеживания взгляда.
Если он не отображается, то, как правило, это указывает на то, что возможность _"газеинпут"_ не задана.

После того как запрос на разрешение выводится один раз, он не отображается автоматически.
Если вы _"отклонили разрешение на отслеживание глаз"_, то можете сбросить его в окне "Параметры" — > > приложения о конфиденциальности.

---

Вы должны приступить к работе с отслеживанием взгляда в приложении МРТК Unity.
Не забудьте просмотреть [учебники по отслеживанию взглядов мртк и примеры](../../example-scenes/eye-tracking-examples-overview.md) , демонстрирующие использование входных данных отслеживания взгляда и удобное предоставление сценариев, которые можно повторно использовать в проектах.

---
[Вернуться к "Отслеживание взглядов в Микседреалититулкит"](eye-tracking-main.md)