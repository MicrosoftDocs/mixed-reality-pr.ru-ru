---
title: Критические изменения
description: Политика в отношении критических изменений в МРТК.
author: polar-kev
ms.author: kesemple
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, смешанная реальность, разработка, MRTK
ms.openlocfilehash: 4cd5e0b085a182377aacdf35e1298ad1180ee641
ms.sourcegitcommit: f338b1f121a10577bcce08a174e462cdc86d5874
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2021
ms.locfileid: "113177272"
---
# <a name="breaking-changes"></a><span data-ttu-id="def58-104">Критические изменения</span><span class="sxs-lookup"><span data-stu-id="def58-104">Breaking changes</span></span>

<span data-ttu-id="def58-105">Потребители МРТК зависят от наличия стабильной поверхности API выпуска в выпуске, чтобы они могли получать обновления для МРТК, не требуя при этом значительных критических изменений.</span><span class="sxs-lookup"><span data-stu-id="def58-105">Consumers of the MRTK depend on having a stable release-to-release API surface, so that they can take updates to the MRTK without having large breaking changes each time.</span></span>

<span data-ttu-id="def58-106">На этой странице описывается текущая политика, относящаяся к критическим изменениям в МРТК, а также некоторые более продолжительные цели, позволяющие лучше управлять компромиссом между поддержанием критических изменений и возможностью внесения верных технических изменений в код.</span><span class="sxs-lookup"><span data-stu-id="def58-106">This page describes our current policy regarding breaking changes in the MRTK, along with some longer term goals around how we can better manage the tradeoff between keeping breaking changes low and being able to make the right long term technical changes to the code.</span></span>

## <a name="what-is-a-breaking-change"></a><span data-ttu-id="def58-107">Что такое критическое изменение?</span><span class="sxs-lookup"><span data-stu-id="def58-107">What is a breaking change?</span></span>

<span data-ttu-id="def58-108">Изменение является критическим изменением, если оно удовлетворяет любому из условий в [списке a](#list-a) и удовлетворяет всем условиям в [списке б](#list-b) .</span><span class="sxs-lookup"><span data-stu-id="def58-108">A change is a breaking change if it satisfies any of the conditions in the [List A](#list-a) AND satisfies all of the conditions in [list B](#list-b)</span></span>

### <a name="list-a"></a><span data-ttu-id="def58-109">Список A</span><span class="sxs-lookup"><span data-stu-id="def58-109">List A</span></span>

- <span data-ttu-id="def58-110">Добавление, удаление или обновление любого члена или функции любого интерфейса (или удаление или переименование всего интерфейса).</span><span class="sxs-lookup"><span data-stu-id="def58-110">The addition, removal, or update of any member or function of any interface (or removal/rename of the entire interface).</span></span>
- <span data-ttu-id="def58-111">Удаление, обновление (изменение типа/определения, создание закрытого или внутреннего) любого защищенного или открытого члена или функции класса.</span><span class="sxs-lookup"><span data-stu-id="def58-111">The removal, update (changing type/definition, making private or internal) of any protected or public member or function of class.</span></span> <span data-ttu-id="def58-112">(или удаление или переименование всего класса).</span><span class="sxs-lookup"><span data-stu-id="def58-112">(or removal/rename of the entire class).</span></span>
- <span data-ttu-id="def58-113">Изменение в порядке событий, инициированных классом.</span><span class="sxs-lookup"><span data-stu-id="def58-113">The change in the order of events fired by a class.</span></span>
- <span data-ttu-id="def58-114">Переименование любых частных Сериализедфиелд (без соответствующего тега Формерлисериализедас) или общего свойства в Скриптаблеобжект (особенно изменения в профилях).</span><span class="sxs-lookup"><span data-stu-id="def58-114">The rename of any private SerializedField (without a corresponding FormerlySerializedAs tag) or public property on a ScriptableObject (especially changes to profiles).</span></span>
- <span data-ttu-id="def58-115">Изменение типа поля в Скриптаблеобжект (особенно изменения в профилях).</span><span class="sxs-lookup"><span data-stu-id="def58-115">Changing the type of a field on a ScriptableObject (especially changes to profiles).</span></span>
- <span data-ttu-id="def58-116">Обновляет пространство имен или асмдефс любого класса или интерфейса.</span><span class="sxs-lookup"><span data-stu-id="def58-116">Updates to the namespace or asmdefs of any class or interface.</span></span>
- <span data-ttu-id="def58-117">Удаление любого prefab или удаление скрипта в объекте верхнего уровня prefab.</span><span class="sxs-lookup"><span data-stu-id="def58-117">Removal of any prefab or removal of a script on the top level object of a prefab.</span></span>

### <a name="list-b"></a><span data-ttu-id="def58-118">Список B</span><span class="sxs-lookup"><span data-stu-id="def58-118">List B</span></span>

- <span data-ttu-id="def58-119">Рассматриваемый ресурс находится в основном пакете (т. е. Он находится в одной из следующих папок):</span><span class="sxs-lookup"><span data-stu-id="def58-119">The asset in question is in the foundation package (i.e. it's in one of the following folders):</span></span>

  - <span data-ttu-id="def58-120">МРТК/Core</span><span class="sxs-lookup"><span data-stu-id="def58-120">MRTK/Core</span></span>
  - <span data-ttu-id="def58-121">МРТК/providers/</span><span class="sxs-lookup"><span data-stu-id="def58-121">MRTK/Providers/</span></span>
  - <span data-ttu-id="def58-122">МРТК/Services/</span><span class="sxs-lookup"><span data-stu-id="def58-122">MRTK/Services/</span></span>
  - <span data-ttu-id="def58-123">МРТК/SDK/</span><span class="sxs-lookup"><span data-stu-id="def58-123">MRTK/SDK/</span></span>
  - <span data-ttu-id="def58-124">МРТК и расширения</span><span class="sxs-lookup"><span data-stu-id="def58-124">MRTK/Extensions</span></span>

- <span data-ttu-id="def58-125">Рассматриваемый ресурс не принадлежит экспериментальному пространству имен.</span><span class="sxs-lookup"><span data-stu-id="def58-125">The asset in question does not belong to the experimental namespace.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="def58-126">Любой ресурс, находящийся в пакете примеров (т. е. часть МРТК/examples/Folder), может быть изменен в любое время, так как ресурсы, предназначенные для копирования и просмотра потребителями в качестве эталонных реализаций, но не являются частью основного набора API-интерфейсов и ресурсов.</span><span class="sxs-lookup"><span data-stu-id="def58-126">Any asset that sits in the examples package (i.e. part of the MRTK/Examples/ folder) is subject to change at any time, as assets there are designed to be copied and viewed by consumers as 'reference implementations' but are not part of the core set of APIs and assets.</span></span> <span data-ttu-id="def58-127">Ресурсы в экспериментальном пространстве имен (или более общедоступные функции, помеченные как экспериментальные) — это те, которые публикуются перед выполнением комплексной экспертизы (т. е. тесты, итерации UX, документация) и публикуются раньше, чтобы получать отзывы быстрее.</span><span class="sxs-lookup"><span data-stu-id="def58-127">Assets in the experimental namespace (or more generally, features labelled as experimental) are ones that get published before all due diligence has been done (i.e. tests, UX iteration, documentation) and is published early to get feedback sooner.</span></span>  <span data-ttu-id="def58-128">Тем не менее, поскольку у них нет тестов и документации, и, так как мы, скорее всего, не заполагали все взаимодействия и разработки, мы публикуем их в состоянии, где общедоступная версия должна предположить, что они могут и изменяться (т. е. будут изменены, полностью удалены и т. д.).</span><span class="sxs-lookup"><span data-stu-id="def58-128">However, because they don't have tests and documentation, and because we likely haven't nailed down all of the interactions and designs, we publish them in a state where the public should assume that they can and will change (i.e. be modified, completely removed, etc).</span></span>
>
> <span data-ttu-id="def58-129">Дополнительные сведения см. в разделе [экспериментальные функции](../contributing/experimental-features.md) .</span><span class="sxs-lookup"><span data-stu-id="def58-129">See [Experimental features](../contributing/experimental-features.md) for more information.</span></span>

<span data-ttu-id="def58-130">Так как контактная зона для критических изменений очень велика, важно отметить, что наличие абсолютного правила, в котором указано «без критических изменений», может быть невозможным — могут возникнуть проблемы, которые могут быть устранены только в разумномм случае путем внесения критических изменений.</span><span class="sxs-lookup"><span data-stu-id="def58-130">As the surface area for breaking changes is very large, it's important to note that having an absolute rule that says "no breaking changes" would be impossible - there may be issues that can only be fixed in a sane way by having a breaking change.</span></span> <span data-ttu-id="def58-131">Чтобы разместить другой способ, единственным способом, который можно было бы получить без критических изменений, является отсутствие изменений.</span><span class="sxs-lookup"><span data-stu-id="def58-131">To put another way, the only way we could really have "no breaking changes" is to have no changes at all.</span></span>

<span data-ttu-id="def58-132">Наша политика заключается в том, чтобы избежать внесения критических изменений, если это возможно, и сделать это только в том случае, если изменение начисляется значительным значением долгосрочного клиента или инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="def58-132">Our standing policy is to avoid making breaking changes if possible, and only do so if the change would accrue significant customer or framework long term value.</span></span>

## <a name="what-to-do-about-breaking-changes"></a><span data-ttu-id="def58-133">Что делать с критическими изменениями</span><span class="sxs-lookup"><span data-stu-id="def58-133">What to do about breaking changes</span></span>

<span data-ttu-id="def58-134">Если вы можете выполнить что-то без критического изменения и без ущерба для долгосрочной структуры и жизнеспособности этой функции, не следует выполнять критические изменения.</span><span class="sxs-lookup"><span data-stu-id="def58-134">If it is possible to accomplish something without a breaking change and without compromising the long term structure and viability of the feature, don't do the breaking change.</span></span> <span data-ttu-id="def58-135">Если других способов нет, то текущая политика должна оценивать каждое отдельное коренное изменение, чтобы понять, что преимущество от изменения приводит к увеличению затрат на потребителя при внесении изменений.</span><span class="sxs-lookup"><span data-stu-id="def58-135">If there is no other way, the current policy is to evaluate each individual breaking change, to understand if the benefit from taking the change outweighs the cost to the consumer of absorbing the change.</span></span> <span data-ttu-id="def58-136">Спор о том, что стоит делать, а что обычно не происходит с самим рассказом о вопросе или выпуске.</span><span class="sxs-lookup"><span data-stu-id="def58-136">Debate about what is worth doing and what isn't will generally take place on the PR or issue discussion itself.</span></span>

<span data-ttu-id="def58-137">Что может произойти в нескольких контейнерах:</span><span class="sxs-lookup"><span data-stu-id="def58-137">What can happen here falls into several buckets:</span></span>

### <a name="the-breaking-change-adds-value-but-could-be-written-in-a-way-that-isnt-breaking"></a><span data-ttu-id="def58-138">Критическое изменение добавляет значение, но может быть записано способом, который не является критическим</span><span class="sxs-lookup"><span data-stu-id="def58-138">The breaking change adds value but could be written in a way that isn't breaking</span></span>

<span data-ttu-id="def58-139">Например, при [добавлении новой](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/4882) функции, которая изначально была написана с нарушением, он изменил существующий интерфейс, но затем перезаписался, когда функция была разбивается как на свой собственный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="def58-139">For example, [this PR](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/4882) added a new feature that was initially written in a way that was breaking - it modified an existing interface - but was then rewritten where the feature was broken out as its own interface.</span></span> <span data-ttu-id="def58-140">Как правило, это наилучший результат.</span><span class="sxs-lookup"><span data-stu-id="def58-140">This is generally the best possible outcome.</span></span> <span data-ttu-id="def58-141">Не пытайтесь принудительно внести изменения в неразрывную форму, если это нарушит долгосрочную жизнеспособность или структуру функции.</span><span class="sxs-lookup"><span data-stu-id="def58-141">Do not try to force a change into a non-breaking form if doing so would compromise the long term viability or structure of the feature.</span></span>

### <a name="the-breaking-change-adds-sufficient-value-to-the-customer-that-its-worth-doing"></a><span data-ttu-id="def58-142">Критическое изменение добавляет достаточное значение к клиенту, что стоит делать.</span><span class="sxs-lookup"><span data-stu-id="def58-142">The breaking change adds sufficient value to the customer that it's worth doing</span></span>

<span data-ttu-id="def58-143">Задокументируйте, что такое критические изменения, и предоставьте лучшие решения по устранению (т. е. инструкции по переносу или более качественные средства, которые будут автоматически перенесены для клиента).</span><span class="sxs-lookup"><span data-stu-id="def58-143">Document what the breaking changes are and provide the best possible mitigation (i.e. prescriptive steps on how to migrate, or better yet tooling that will automatically migrate for the customer).</span></span> <span data-ttu-id="def58-144">В каждом выпуске может содержаться небольшой объем незавершенных изменений — они всегда должны быть документированы в документах, как это было сделано в [этом](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/4858)запросе.</span><span class="sxs-lookup"><span data-stu-id="def58-144">Each release may contain a small amount of changes that are breaking - these should always be documented in docs as was done in [this PR](https://github.com/microsoft/MixedRealityToolkit-Unity/pull/4858).</span></span> <span data-ttu-id="def58-145">Если у вас уже есть инструкция по миграции 2. x. x → 2. x +1. x + 1, добавьте инструкции или инструментарий в этот документ. Если он не существует, создайте его.</span><span class="sxs-lookup"><span data-stu-id="def58-145">If there already is a 2.x.x→2.x+1.x+1 migration guide, then add instructions or tooling to that doc. If it doesn't exist, create it.</span></span>

### <a name="the-breaking-change-adds-value-but-the-customer-pain-would-be-too-high"></a><span data-ttu-id="def58-146">Критическое изменение увеличивает значение, но клиент может быть слишком высоким.</span><span class="sxs-lookup"><span data-stu-id="def58-146">The breaking change adds value but the customer pain would be too high</span></span>

<span data-ttu-id="def58-147">Не все типы критических изменений создаются одинаково — некоторые из них значительно более сложны, чем другие, в зависимости от нашего опыта и опыта работы с клиентами.</span><span class="sxs-lookup"><span data-stu-id="def58-147">Not all types of breaking changes are created equal - some are significantly more painful that others, based on our experience and based on customer experiences.</span></span> <span data-ttu-id="def58-148">Например, изменения в интерфейсах могут оказаться непростыми, но если критически важное изменение является одним из тех, в котором клиент вряд ли будет расширен или реализован в прошлом (например, в системе диагностического представления), фактические затраты, скорее всего, не будут.</span><span class="sxs-lookup"><span data-stu-id="def58-148">For example, changes to interfaces may be painful, but if the breaking change is one in which a customer is unlikely to have extended/implemented in the past (the diagnostic visualization system, for example), then the actual cost is probably low to nothing.</span></span> <span data-ttu-id="def58-149">Однако если изменение является типом поля в Скриптаблеобжект (например, в одном из основных профилей МРТК), это, скорее всего, приведет к значительному сбою клиента.</span><span class="sxs-lookup"><span data-stu-id="def58-149">However, if the change is the type of a field on a ScriptableObject (for example, on one of the core profiles of the MRTK), this is likely to cause massive customer pain.</span></span> <span data-ttu-id="def58-150">Клиенты уже выполнили клонирование профиля по умолчанию, возможность слияния и обновления профилей может быть очень трудной для ручного выполнения (т. е. через текстовый редактор во время слияния), а повторное копирование профиля по умолчанию и перенастройки всех вручную может привести к сложному отладке регрессий.</span><span class="sxs-lookup"><span data-stu-id="def58-150">Customers have already cloned the default profile, merging/updating profiles can be extremely hard to do manually (i.e. via a text editor during merge time), and re-copying the default profile and reconfiguring everything by hand is extremely likely to lead to hard to debug regressions.</span></span>

<span data-ttu-id="def58-151">Эти изменения необходимо вернуть в полку до тех пор, пока не будет создана ветвь, которая позволит значительно радикально внести изменения (вместе с существенным значением, которое предоставит клиентам причину обновления).</span><span class="sxs-lookup"><span data-stu-id="def58-151">These changes we have to put back onto the shelf until a branch exists that will allow significantly breaking changes (along with significant value that will give customers a reason to upgrade).</span></span> <span data-ttu-id="def58-152">Такая ветвь в настоящее время не существует.</span><span class="sxs-lookup"><span data-stu-id="def58-152">Such a branch doesn't currently exist.</span></span> <span data-ttu-id="def58-153">В будущих собраниях по планированию итераций мы рассмотрим набор изменений и проблем, которые оказались слишком недостаточными, чтобы узнать, не был ли достигнут важный объем, чтобы сделать все более разумными.</span><span class="sxs-lookup"><span data-stu-id="def58-153">In our future iteration planning meetings, we will review the set of changes/issues that were 'too breaking' to see if we reached a critical mass to make it reasonable to pursue a set of changes all at once.</span></span> <span data-ttu-id="def58-154">Обратите внимание, что небезопасно выработать ветвь "все разрешено" без комплексной экспертизы из-за ограниченных ресурсов проектирования, и тот факт, что нам пришлось бы разделить тестирование и проверку на этих двух.</span><span class="sxs-lookup"><span data-stu-id="def58-154">Note that it's dangerous to spin up a "everything is allowed" branch without due diligence being done because of the limited engineering resources we have, and the fact that we'd have to split testing and validation across those two.</span></span> <span data-ttu-id="def58-155">Должна быть четко назначенная и хорошо связанная Дата начала и окончания такой ветви, когда она существует.</span><span class="sxs-lookup"><span data-stu-id="def58-155">There needs to be a clear purpose and well-communicated start and end date of such a branch when it exists.</span></span>

## <a name="long-term-management-of-breaking-changes"></a><span data-ttu-id="def58-156">Долгосрочное управление критическими изменениями</span><span class="sxs-lookup"><span data-stu-id="def58-156">Long term management of breaking changes</span></span>

<span data-ttu-id="def58-157">В долгосрочной перспективе следует попытаться уменьшить область действия, что является критическим изменением, увеличив набор условий в [списке б](#list-b). Пересылка набора объектов в [списке A](#list-a) всегда будет полностью прерываться для набора файлов и ресурсов, которые мы считали общедоступной поверхностью API.</span><span class="sxs-lookup"><span data-stu-id="def58-157">In the long term, we should seek to reduce the scope of what is a breaking change by increasing the set of conditions in [List B](#list-b). Going forward the set of things in [List A](#list-a) will always technically be breaking for the set of files and assets that we deem to be in the "public API surface."</span></span> <span data-ttu-id="def58-158">Способ, который мы можем сделать более удобной для итерации (т. е. изменяя сведения о внутренней реализации, позволяя упростить рефакторинг и совместное использование кода между несколькими классами и т. д.), — более явное обсуждение того, какие части кода являются официальной поверхностью, а не сведения о реализации.</span><span class="sxs-lookup"><span data-stu-id="def58-158">The way that we can get a little more freedom for iteration (i.e. changing up the internal implementation details, allowing for easier refactoring and sharing of code between multiple classes, etc) is to be more explicit about which portions of the code are official surface, rather than implementation detail.</span></span>

<span data-ttu-id="def58-159">Еще одна вещь, которую мы уже сделали, — это понятие «экспериментального» (оно принадлежит экспериментальному пространству имен), оно может не иметь тестов или документации и открыто, но может быть удалено и Обновлено без предупреждения.</span><span class="sxs-lookup"><span data-stu-id="def58-159">One thing we've already done is introduce the concept of an "experimental" feature (it belongs in the experimental namespace, it may not have tests/documentation, and is publicly proclaimed to exist but may be removed and updated without warning).</span></span> <span data-ttu-id="def58-160">Это дает возможность добавить новые функции раньше, чтобы получить более раннюю обратную связь, но не быть немедленно привязана к своей поверхности API (так как мы не можем полностью представить поверхность API).</span><span class="sxs-lookup"><span data-stu-id="def58-160">This has given has freedom to add new features sooner to get earlier feedback, but not be immediately tied to its API surface (because we may not have fully thought out the API surface).</span></span>

### <a name="other-examples-of-things-that-could-help-in-the-future"></a><span data-ttu-id="def58-161">Другие примеры действий, которые могут помочь в будущем</span><span class="sxs-lookup"><span data-stu-id="def58-161">Other examples of things that could help in the future</span></span>

- <span data-ttu-id="def58-162">Использование [ключевого слова Internal](/dotnet/csharp/language-reference/keywords/internal).</span><span class="sxs-lookup"><span data-stu-id="def58-162">Usage of the [internal keyword](/dotnet/csharp/language-reference/keywords/internal).</span></span>
  <span data-ttu-id="def58-163">Это позволит нам использовать общий код в собственных сборках (для сокращения дублирования кода), не делая их общедоступными для внешних потребителей.</span><span class="sxs-lookup"><span data-stu-id="def58-163">This would allow for us to have shared code within our own assemblies (for reducing code duplication) without making things public to external consumers.</span></span>
- <span data-ttu-id="def58-164">создание "внутреннего" пространства имен (т. е. Microsoft. микседреалити. набор средств. Внутренние служебные программы), где мы публично задокументировать, что все, что содержится в этом внутреннем пространстве имен, может измениться в любое время, а затем удалить и т. д. Это похоже на то, как библиотеки заголовков C++ будут использовать пространства имен:: Internal для скрытия сведений о реализации.</span><span class="sxs-lookup"><span data-stu-id="def58-164">Creation of an "internal" namespace (i.e. Microsoft.MixedReality.Toolkit.Internal.Utilities), where we publicly document that anything contained within that internal namespace is subject to change at anytime and could be removed, etc. This is similar to how C++ header libraries will make use of ::internal namespaces to hide their implementation details.</span></span>
