---
title: Базовая система
description: Система ввода, диспетчеры устройств и поставщики данных в МРТК
author: cDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, Смешанная реальность, разработка, МРТК, события
ms.openlocfilehash: 12719a6c749a03648d4f75e9e6461b85cc9ab275
ms.sourcegitcommit: c0ba7d7bb57bb5dda65ee9019229b68c2ee7c267
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "110144290"
---
# <a name="core-system"></a><span data-ttu-id="f8918-104">Основная система</span><span class="sxs-lookup"><span data-stu-id="f8918-104">Core system</span></span>

<span data-ttu-id="f8918-105">Основой входной системы является [инпутсистем](../features/input/overview.md), который отвечает за инициализацию и эксплуатацию всех функций ввода, связанных с мртк.</span><span class="sxs-lookup"><span data-stu-id="f8918-105">At the heart of the input system is the [InputSystem](../features/input/overview.md), which is a service that is responsible for initializing and operating all of the input related functionality associated with the MRTK.</span></span>

> [!NOTE]
> <span data-ttu-id="f8918-106">Предполагается, что читатели уже читают и имеют базовое представление о [терминологии](terminology.md) .</span><span class="sxs-lookup"><span data-stu-id="f8918-106">It is assumed that readers have already read and have a basic understanding of the [terminology](terminology.md) section.</span></span>

<span data-ttu-id="f8918-107">Эта служба отвечает за следующее:</span><span class="sxs-lookup"><span data-stu-id="f8918-107">This service is responsible for:</span></span>

- <span data-ttu-id="f8918-108">Чтение [входного системного профиля](../configuration/mixed-reality-configuration-guide.md#input-system-settings)</span><span class="sxs-lookup"><span data-stu-id="f8918-108">Reading the [input system profile](../configuration/mixed-reality-configuration-guide.md#input-system-settings)</span></span>
- <span data-ttu-id="f8918-109">Запуск настроенных [поставщиков данных](../features/input/input-providers.md) (например, `Windows Mixed Reality Device Manager` и `OpenVR Device Manager` ).</span><span class="sxs-lookup"><span data-stu-id="f8918-109">Starting the configured [data providers](../features/input/input-providers.md) (for example, `Windows Mixed Reality Device Manager` and `OpenVR Device Manager`).</span></span>
- <span data-ttu-id="f8918-110">Создание экземпляра [газепровидер](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityGazeProvider), который является компонентом, отвечающим за предоставление сведений о головном стиле hololens (1 поколение) в дополнение к сведениям о взгляде на hololens в виде 2.</span><span class="sxs-lookup"><span data-stu-id="f8918-110">Instantiation of the [GazeProvider](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityGazeProvider), which is a component that is responsible for providing HoloLens (1st generation) style head gaze information in addition to HoloLens 2 style eye gaze information.</span></span>
- <span data-ttu-id="f8918-111">Создание экземпляра [фокуспровидер](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityFocusProvider), который является компонентом, отвечающим за определение объектов, имеющих фокус.</span><span class="sxs-lookup"><span data-stu-id="f8918-111">Instantiation of the [FocusProvider](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityFocusProvider), which is a component that is responsible for determining objects that have focus.</span></span> <span data-ttu-id="f8918-112">Это подробно описано в разделе [указатели и фокус](controllers-pointers-and-focus.md#pointers-and-focus) в документации.</span><span class="sxs-lookup"><span data-stu-id="f8918-112">This is described in more depth in the [pointers and focus](controllers-pointers-and-focus.md#pointers-and-focus) section of the documentation.</span></span>
- <span data-ttu-id="f8918-113">Предоставление точек регистрации для всех событий ввода (в виде [глобальных прослушивателей](#global-listeners)).</span><span class="sxs-lookup"><span data-stu-id="f8918-113">Providing registration points for all input events (as [global listeners](#global-listeners)).</span></span>
- <span data-ttu-id="f8918-114">Предоставление возможностей диспетчеризации событий для этих событий ввода.</span><span class="sxs-lookup"><span data-stu-id="f8918-114">Providing event dispatch capabilities for those input events.</span></span>

## <a name="input-events"></a><span data-ttu-id="f8918-115">События ввода</span><span class="sxs-lookup"><span data-stu-id="f8918-115">Input events</span></span>

<span data-ttu-id="f8918-116">События ввода обычно срабатывают на двух разных каналах:</span><span class="sxs-lookup"><span data-stu-id="f8918-116">Input events are generally fired on two different channels:</span></span>

### <a name="objects-in-focus"></a><span data-ttu-id="f8918-117">Объекты в фокусе</span><span class="sxs-lookup"><span data-stu-id="f8918-117">Objects in focus</span></span>

<span data-ttu-id="f8918-118">События могут отправляться непосредственно в GameObject, имеющий фокус.</span><span class="sxs-lookup"><span data-stu-id="f8918-118">Events can be sent directly to a GameObject that has focus.</span></span> <span data-ttu-id="f8918-119">Например, объект может иметь скрипт, реализующий интерфейс [`IMixedRealityTouchHandler`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityTouchHandler) .</span><span class="sxs-lookup"><span data-stu-id="f8918-119">For example, an object might have a script that implements [`IMixedRealityTouchHandler`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityTouchHandler).</span></span>
<span data-ttu-id="f8918-120">Этот объект получит события касания, если он находится рядом с ним.</span><span class="sxs-lookup"><span data-stu-id="f8918-120">This object would get touch events when focused by a hand that is near it.</span></span> <span data-ttu-id="f8918-121">Эти типы событий попадают в иерархию GameObject до тех пор, пока не найдет GameObject, способный обработать событие.</span><span class="sxs-lookup"><span data-stu-id="f8918-121">These types of events go "up" the GameObject hierarchy until it finds a GameObject that is capable of handling the event.</span></span>

<span data-ttu-id="f8918-122">Это делается с помощью [ексекутехиерарчи](https://docs.unity3d.com/ScriptReference/EventSystems.ExecuteEvents.ExecuteHierarchy.html) из реализации системы ввода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f8918-122">This is done by using [ExecuteHierarchy](https://docs.unity3d.com/ScriptReference/EventSystems.ExecuteEvents.ExecuteHierarchy.html) from within the default input system implementation.</span></span>

### <a name="global-listeners"></a><span data-ttu-id="f8918-123">Глобальные прослушиватели</span><span class="sxs-lookup"><span data-stu-id="f8918-123">Global listeners</span></span>

<span data-ttu-id="f8918-124">События могут отправляться в глобальные прослушиватели.</span><span class="sxs-lookup"><span data-stu-id="f8918-124">Events can be sent to global listeners.</span></span> <span data-ttu-id="f8918-125">Можно зарегистрировать для всех входных событий с помощью интерфейса системы ввода [`IMixedRealityEventSystem`](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem) .</span><span class="sxs-lookup"><span data-stu-id="f8918-125">It's possible to register for all input events by using the input system's [`IMixedRealityEventSystem`](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem) interface.</span></span> <span data-ttu-id="f8918-126">Для регистрации глобальных событий рекомендуется использовать метод [регистерхандлер](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem.RegisterHandler%2A) . Нерекомендуемая `Register` функция приведет к тому, что прослушиватели получат уведомление обо всех входных событиях, а не только на входных событиях определенного типа (где тип определяется интерфейсом событий).</span><span class="sxs-lookup"><span data-stu-id="f8918-126">It's recommended to use the [RegisterHandler](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem.RegisterHandler%2A) method for registering for global events - the deprecated `Register` function will cause listeners to get notified of ALL input events, rather than just input events of a particular type (where type is defined by the event interface).</span></span>

<span data-ttu-id="f8918-127">Обратите внимание, что [резервные прослушиватели](xref:Microsoft.MixedReality.Toolkit.Input.MixedRealityInputSystem.PushFallbackInputHandler%2A) — это еще один тип глобальных прослушивателей, которые также не рекомендуются, так как они будут принимать каждое одно событие ввода, которое не было обработано в других местах сцены.</span><span class="sxs-lookup"><span data-stu-id="f8918-127">Note that [fallback listeners](xref:Microsoft.MixedReality.Toolkit.Input.MixedRealityInputSystem.PushFallbackInputHandler%2A) are another type of global listeners which are also discouraged because they will receive every single input event that hasn't been handled elsewhere in the scene.</span></span>

### <a name="order-of-event-dispatch"></a><span data-ttu-id="f8918-128">Порядок отправки событий</span><span class="sxs-lookup"><span data-stu-id="f8918-128">Order of event dispatch</span></span>

<span data-ttu-id="f8918-129">Как правило, события отправляются прослушивателям следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f8918-129">Generally, events are sent to listeners in the following way.</span></span> <span data-ttu-id="f8918-130">Обратите внимание, что если любое из приведенных ниже действий помечает событие как [обработанное](https://docs.unity3d.com/ScriptReference/EventSystems.AbstractEventData-used.html), процесс диспетчеризации событий останавливается.</span><span class="sxs-lookup"><span data-stu-id="f8918-130">Note that if any of the steps below mark the event as [handled](https://docs.unity3d.com/ScriptReference/EventSystems.AbstractEventData-used.html), the event dispatch process stops.</span></span>

1. <span data-ttu-id="f8918-131">Событие отправляется в глобальные прослушиватели.</span><span class="sxs-lookup"><span data-stu-id="f8918-131">Event is sent to global listeners.</span></span>
2. <span data-ttu-id="f8918-132">Событие отправляется в модальные диалоговые окна объекта с упором.</span><span class="sxs-lookup"><span data-stu-id="f8918-132">Event is sent to modal dialogs of the focused object.</span></span>
3. <span data-ttu-id="f8918-133">Событие отправляется в объект с сортировкой.</span><span class="sxs-lookup"><span data-stu-id="f8918-133">Event is sent to the focused object.</span></span>
4. <span data-ttu-id="f8918-134">Событие отправляется в резервные прослушиватели.</span><span class="sxs-lookup"><span data-stu-id="f8918-134">Event is sent to fallback listeners.</span></span>

## <a name="device-managers-and-data-providers"></a><span data-ttu-id="f8918-135">Диспетчеры устройств и поставщики данных</span><span class="sxs-lookup"><span data-stu-id="f8918-135">Device managers and data providers</span></span>

<span data-ttu-id="f8918-136">Эти сущности отвечают за взаимодействие с интерфейсами API более низкого уровня (например, с API-интерфейсами Windows Mixed Reality или Опенвр API) и переводом данных из этих систем в объекты, соответствующие МРТКным абстракциям на более высоком уровне.</span><span class="sxs-lookup"><span data-stu-id="f8918-136">These entities are responsible for interfacing with lower-level APIs (such as Windows Mixed Reality APIs, or OpenVR APIs) and translating data from those systems into ones that fit the MRTK's higher level input abstractions.</span></span> <span data-ttu-id="f8918-137">Они отвечают за обнаружение, создание и управление временем существования [контроллеров](controllers-pointers-and-focus.md#controllers).</span><span class="sxs-lookup"><span data-stu-id="f8918-137">They are responsible for detecting, creating, and managing the lifetime of [controllers](controllers-pointers-and-focus.md#controllers).</span></span>

<span data-ttu-id="f8918-138">Основной поток диспетчера устройств включает в себя следующее:</span><span class="sxs-lookup"><span data-stu-id="f8918-138">The basic flow of a device manager involves:</span></span>

1. <span data-ttu-id="f8918-139">Экземпляр диспетчера устройств создается во входной системной службе.</span><span class="sxs-lookup"><span data-stu-id="f8918-139">The device manager is instantiated by the input system service.</span></span>
2. <span data-ttu-id="f8918-140">Диспетчер устройств регистрируется в своей базовой системе (например, диспетчер устройств Windows Mixed Reality будет зарегистрирован для [входа](../features/input/input-events.md) и событий [жестов](../features/input/gestures.md#gesture-events) .</span><span class="sxs-lookup"><span data-stu-id="f8918-140">The device manager registers with its underlying system (for example, the Windows Mixed Reality device manager will register for [input](../features/input/input-events.md) and [gesture](../features/input/gestures.md#gesture-events) events.</span></span>
3. <span data-ttu-id="f8918-141">Он создает контроллеры, которые он обнаруживает из базовой системы (например, поставщик может обнаружить наличие четко сформулированных рук).</span><span class="sxs-lookup"><span data-stu-id="f8918-141">It creates controllers that it discovers from the underlying system (for example the provider could detect the presence of articulated hands)</span></span>
4. <span data-ttu-id="f8918-142">В своем цикле Update () вызовите Упдатеконтроллер (), чтобы опросить новое состояние базовой системы и обновить его представление контроллера.</span><span class="sxs-lookup"><span data-stu-id="f8918-142">In its Update() loop, call UpdateController() to poll for the new state of the underlying system and update its controller representation.</span></span>
