---
title: Пространственные привязки
description: Узнайте о рекомендациях по использованию пространственных привязок для визуализации стабильных голограмм в приложениях смешанной реальности.
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
keywords: система координат, геодоступная система координат, мировое масштабирование, мир, масштабирование, расположение, ориентация, привязка, пространственный якорь, блокировка мира, блокировка мира, сохранение, совместное использование, Универсальная гарнитура, головной компьютер Windows Mixed Reality, гарнитура виртуальной реальности, HoloLens
ms.openlocfilehash: dc9b57d51f4202499d82abb8d210261d2ee36dc60bb90ed039a7554f82af79a0
ms.sourcegitcommit: a1c086aa83d381129e62f9d8942f0fc889ffcab0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "115193518"
---
# <a name="spatial-anchors"></a>Пространственные привязки

Пространственный якорь представляет собой важную точку во всем мире, которую система отслеживает с течением времени. Каждая привязка имеет настраиваемую [систему координат](coordinate-systems.md), основанную на других привязках или кадрах ссылок, для обеспечения точности привязанных голограмм.  Отрисовка голограммы в системе координат привязки обеспечивает наиболее точное позиционирование для этой голограммы в любое заданное время. Это достигается за счет небольших корректировок с течением времени по мере того, как система непрерывно перемещает ее обратно в соответствии с реальным миром.

Вы также можете сохранять и совместно использовать пространственные привязки во всех сеансах приложений и на разных устройствах:
* После сохранения локальных пространственных привязок на диске и их последующей загрузки приложение может вычислить одно и то же расположение в реальном мире для нескольких сеансов приложения на одном HoloLens.
* используя <a href="/azure/spatial-anchors/overview" target="_blank">пространственные привязки Azure</a> для создания привязки к облаку, приложение может совместно использовать пространственное привязку на нескольких устройствах HoloLens, iOS и Android. Когда каждое устройство визуализирует голограмму с помощью той же пространственной привязки, пользователи увидят, что голограмма появится в одном месте в реальном мире. Это позволяет обмениваться опытом в режиме реального времени.
* можно также использовать <a href="/azure/spatial-anchors/overview" target="_blank">пространственные привязки Azure</a> для асинхронного сохранения голограмм на устройствах HoloLens, iOS и Android. При совместном использовании пространственной геодоступной облачной привязки несколько устройств могут отслеживать одну и ту же голограмму с течением времени, даже если эти устройства не присутствуют одновременно.

Для непрерывного масштабирования или размещения в помещении для головных телефонов настольных ПК, которые будут оставаться в пределах 5-метрического диаметра, обычно можно использовать [промежуточный кадр ссылки](coordinate-systems.md#stage-frame-of-reference) вместо пространственных привязок, который предоставляет единую систему координат для отображения всего содержимого. однако если приложение позволяет пользователям рыскающего более 5 метров в HoloLens, возможно, работать на всем этаже здания, для обеспечения стабильной работы содержимого потребуются пространственные привязки.

В то время как пространственные привязки хороши для голограмм, которые должны оставаться неподвижными в мире, после установки привязок их нельзя перемещать. Существуют альтернативы для привязок, более подходящие для динамических голограмм, которые помечаются вместе с пользователем. Лучше размещать динамические голограммы, используя стационарную рамку ссылки (основу для мировых координат Unity) или присоединенную рамку ссылки.

## <a name="best-practices"></a>Рекомендации

Эти рекомендации по пространственным привязкам помогут вам создать стабильные голограммы, которые точно отслеживают реальный мир.

### <a name="create-spatial-anchors-where-users-place-them"></a>Создание пространственных привязок, размещаемых пользователями

Как правило, пользователи явно размещают пространственные привязки.

например, на HoloLens приложение может пересекать [луч пользователя](gaze-and-commit.md) с сеткой [пространственных сопоставлений](spatial-mapping.md) , чтобы пользователь мог решить, куда поместить голограмму. Когда пользователь касается размещения этой голограммы, создайте пространственное привязку на точке пересечения, а затем поместите голограмму в начало системы координат этой привязки.

Локальные пространственные привязки просты и выполняются для создания. Система объединяет внутренние данные, если несколько привязок могут совместно использовать данные своих базовых датчиков. Рекомендуется создать новую локальную пространственное привязку для каждой голограммы, которая явно размещается пользователем, за исключением случаев, описанных ниже, например жесткими группами голограмм.

### <a name="always-render-anchored-holograms-within-3-meters-of-their-anchor"></a>Всегда отображайте закрепленные голограммы в пределах 3 метров от их привязки

Пространственные привязки стабилизируют свою систему координат возле источника привязки. При визуализации голограмм, более трех метров от источника, голограммы могут столкнуться с заметными позиционированными ошибками в пропорциональном расстоянии от этого источника из-за эффектов ARM. Это работает, если пользователь приближается к привязке, так как эта голограмма находится далеко от пользователя. Иными словами, угловая ошибка отдаленной голограммы будет небольшой. Однако если пользователь переходит к такому отдаленному голограмме, он будет большим в своем представлении, что приведет к очевидному эффекту рычага ARM из источника привязки удаленное.

### <a name="group-holograms-that-should-form-a-rigid-cluster"></a>Групповые голограммы, которые должны образовывать жесткий кластер

Несколько голограмм могут использовать одну и ту же пространственное привязку, если приложение планирует, чтобы эти голограммы поддерживали фиксированные связи друг с другом.

Например, если вы выполняете анимацию holographic солнечной системы в комнате, лучше привязать все солнечные системные объекты к одной точке привязки в центре. Таким образом, они будут плавно перемещаться в зависимости друг от друга. В данном случае это солнечная система в целом, которая привязана, даже несмотря на то, что ее компоненты динамически перемещаются вокруг привязки.

Ключевое предостережение для поддержания стабильной стабильности заключается в соблюдении 3-метрного правила, описанного выше.

### <a name="render-highly-dynamic-holograms-using-the-stationary-frame-of-reference-instead-of-a-local-spatial-anchor"></a>Отрисовка высокодинамичных голограмм с использованием стационарной системы отсчета вместо локальной пространственной привязки

Если у вас есть высокая динамическая голограмма, например обход символов вокруг комнаты или плавающий пользовательский интерфейс, следующий за стеной рядом с пользователем, лучше пропускать локальные пространственные привязки и визуализировать эти голограммы непосредственно в системе координат, предоставляемой [стационарным кадром ссылки](coordinate-systems.md#stationary-frame-of-reference). В Unity это достигается путем размещения голограмм непосредственно в мировых координатах без Ворлданчор. Голограммы в стационарной рамке ссылки может иметь отклонения, когда пользователь далеко от голограммы. Но это менее вероятно для динамических голограмм: либо Эта голограмма постоянно перемещается, либо ее движение постоянно сохраняет его близко к пользователю, где смещение будет сведено к минимуму.

Интересным случаем при использовании динамических голограмм является возможность анимации объекта из одной привязанной системы координат в другую. Например, у вас может быть два КАСТЛЕС на 10 метров, каждый на отдельной пространственной привязке с одним Castle, каннонбалл на другом Castle. При срабатывании каннонбалл его можно отобразить в соответствующем месте в стационарной рамке ссылки, чтобы совпадать с Каннон в первой Castle закрепленной системе координат. Затем оно может следовать своей траектории в стационарной системе отсчета, пролетая 10 метров по воздуху. По мере того, как каннонбалл достигает другого Castle, его можно переместить во вторую систему координат, привязанную к Castle, чтобы обеспечить физические вычисления с жесткими текстами Castle.

Если вы используете высокую динамическую голограмму на устройствах, выберите определенную пространственное привязку к облаку, чтобы сделать ее родителем, поскольку стационарные кадры ссылки не могут совместно использоваться на разных устройствах.  Однако следует убедиться, что либо динамическая голограмма, либо устройства, просматривающие его, остаются в трехмерном радиусе привязки, поэтому голограмма на всех устройствах выглядит стабильной.

### <a name="avoid-creating-a-grid-of-spatial-anchors"></a>Не следует создавать сетку пространственных привязок

Может показаться, что приложение будет удалять обычную сетку пространственных привязок по мере того, как пользователь выполняет обход, перемещая динамические объекты из привязки в привязку при перемещении. Однако это требует большего управления для вашего приложения без использования данных глубокого датчика, которые сама система поддерживает внутренне. В таких случаях вы получите лучшие результаты, поместив голограммы в стационарную рамку справочника, как описано в разделе выше.
При предварительном размещении набора географических якорей, охватывающих статическое пространство, рассмотрите возможность размещения пространственных привязок в расположениях ключевых фрагментов, которые поступают у пользователя в соответствии с описанным выше принципом, а не создание произвольной сетки привязок. Это гарантирует максимальную стабильность этих ключевых голограмм.

### <a name="release-local-spatial-anchors-you-no-longer-need"></a>Удаляйте пространственные привязки, которые больше не нужны

В то время как локальная пространственное привязку активна, система устанавливает приоритеты для хранения данных датчика, расположенных рядом с этой привязкой. Если вы больше не используете пространственное привязку, прекратите доступ к своей системе координат. Это позволяет удалять данные базового датчика при необходимости.

Это особенно важно для локальных привязок, сохраненных в хранилище пространственных привязок. Данные датчика, лежащие в основе этих привязок, будут постоянно храниться, чтобы позволить приложению найти эту привязку в будущих сеансах, что сокращает пространство, доступное для наблюдения за другими привязками. Сохранять в будущих сеансах только локальные привязки, которые необходимо найти. Рекомендуется удалить их из магазина, если они больше не важны для пользователя.

Для облачных пространственных привязок хранилище можно масштабировать в соответствии с вашим сценарием. Вы можете хранить любое необходимое количество облачных привязок, освобождая их, когда известно, что пользователям больше не потребуется привязка.

## <a name="see-also"></a>См. также раздел

* [Системы координат](coordinate-systems.md)
* [Общий доступ в смешанной реальности](../develop/platform-capabilities-and-apis/shared-experiences-in-mixed-reality.md)
* <a href="/azure/spatial-anchors" target="_blank">Пространственные привязки Azure</a>
* [Сохраняемость в Unity](../develop/unity/persistence-in-unity.md)
* [Coordinate systems in DirectX](../develop/native/coordinate-systems-in-directx.md#place-holograms-in-the-world-using-spatial-anchors) (Системы координат в DirectX)
* [Case study - Looking through holes in your reality](../out-of-scope/case-study-looking-through-holes-in-your-reality.md) (Пример использования. Взгляд сквозь отверстия в реальности)