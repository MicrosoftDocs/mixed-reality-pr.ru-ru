---
title: Пространственные привязки
description: Рекомендации по использованию пространственных привязок для отрисовки стабильных голограмм.
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
keywords: coordinate system, spatial coordinate system, world-scale, world, scale, position, orientation, anchor, spatial anchor, world-locked, world-locking, persistence, sharing
ms.openlocfilehash: a1108aceb91ec80d20b4cac043477ee92527035b
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2020
ms.locfileid: "91691541"
---
# <a name="spatial-anchors"></a>Пространственные привязки

Пространственный якорь представляет собой важную точку мира, которую система отслеживает с течением времени. Каждая привязка имеет [систему координат](coordinate-systems.md), которая нужным образом корректируется относительно других привязок или систем отсчета, чтобы гарантировать, что закрепленные голограммы остаются точно на месте.  Отрисовка голограммы в системе координат привязки предоставляет самое точное позиционирование этой голограммы в любой момент времени. Это связано с затратами на небольшие корректировки с течением времени по мере того, как система постоянно перемещает его в место, соответствующее реальному миру.

Вы также можете сохранять и совместно использовать пространственные привязки во всех сеансах приложений и на разных устройствах:
* После сохранения локальных пространственных привязок на диске и их последующей загрузки приложение может вычислить одно и то же расположение в реальном мире для нескольких сеансов приложения на одном HoloLens.
* Используя <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Пространственные привязки Azure</a> для создания привязки к облаку, приложение может совместно использовать пространственный якорь на нескольких устройствах HoloLens, iOS и Android. Когда каждое устройство визуализирует голограмму с помощью той же пространственной привязки, пользователи увидят, что голограмма появится в одном месте в реальном мире. Это позволяет обмениваться опытом в режиме реального времени.
* <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Пространственные привязки Azure</a> можно также использовать для сохранения асинхронной голограммы на устройствах HoloLens, iOS и Android. Благодаря совместному использованию надежной облачной пространственной привязки несколько устройств могут наблюдать одну и ту же постоянную голограмму с течением времени, даже если они находятся в разное время в разных местах.

Для непрерывного масштабирования или размещения в помещении для головных телефонов настольных ПК, которые будут оставаться в пределах 5-метрического диаметра, обычно можно использовать [промежуточный кадр ссылки](coordinate-systems.md#stage-frame-of-reference) вместо пространственных привязок, который предоставляет единую систему координат для отображения всего содержимого. Тем не менее, если приложение планирует позволить пользователям рыскающего более 5 метров в HoloLens, возможно, работающих на всем этаже здания, для сохранения содержимого потребуется использовать пространственные привязки.

В то время как пространственные привязки хороши для голограмм, которые должны оставаться неподвижными в мире, после установки привязок их нельзя перемещать. Существуют альтернативы для привязок, более подходящие для динамических голограмм, которые помечаются вместе с пользователем. Динамические голограммы лучше всего размещать, используя стационарную систему отсчета (основа внешних координат Unity) или присоединенную систему отсчета.

## <a name="best-practices"></a>Рекомендации

Эти рекомендации по пространственным привязкам помогут вам создать стабильные голограммы, которые точно отслеживают реальный мир.

### <a name="create-spatial-anchors-where-users-place-them"></a>Создание пространственных привязок, размещаемых пользователями

Как правило, пользователи явно размещают пространственные привязки.

Например, в HoloLens приложение может пересекать [луч пользователя](gaze-and-commit.md) с сеткой [пространственных сопоставлений](spatial-mapping.md) , чтобы пользователь мог решить, куда поместить голограмму. Когда пользователь касается размещения этой голограммы, создайте пространственное привязку на точке пересечения, а затем поместите голограмму в начало системы координат этой привязки.

Локальные пространственные привязки просты и выполняются для создания. Система будет консолидировать свои внутренние данные, если несколько привязок могут совместно использовать данные своих базовых датчиков. Обычно следует создавать новую локальную пространственное привязку для каждой голограммы, которую явно размещает пользователь, за исключением случаев, описанных ниже, например жесткими группами голограмм.

### <a name="always-render-anchored-holograms-within-3-meters-of-their-anchor"></a>Всегда отображайте закрепленные голограммы в пределах 3 метров от их привязки

Пространственные привязки стабилизируют свою систему координат возле источника привязки. При визуализации голограмм, более трех метров от этого источника, эти голограммы могут столкнуться с заметными позиционированными ошибками в пропорциональном расстоянии от этого источника из-за эффектов ARM. Это работает, если пользователь приближается к привязке, так как эта голограмма находится далеко от пользователя. Иными словами, угловая ошибка отдаленной голограммы будет небольшой. Тем не менее, если пользователь переходит к этой отдаленной голограмме, он будет большим в своем представлении, что делает эффект ARM-рычага от источника привязки удаленное очень очевидным.

### <a name="group-holograms-that-should-form-a-rigid-cluster"></a>Групповые голограммы, которые должны образовывать жесткий кластер

Несколько голограмм могут использовать одну и ту же пространственное привязку, если приложение планирует, чтобы эти голограммы поддерживали фиксированные связи друг с другом.

Например, если вы выполняете анимацию holographic-солнечной системы в комнате, лучше привязать все солнечные системные объекты к одной привязке в центре, чтобы они плавно передвигаться относительно друг друга. В этом случае именно вся солнечная система будет закреплена, хотя ее составные части будут динамически перемещаться вокруг привязки.

Ключевое предостережение для поддержания стабильной стабильности заключается в соблюдении 3-метрного правила, описанного выше.

### <a name="render-highly-dynamic-holograms-using-the-stationary-frame-of-reference-instead-of-a-local-spatial-anchor"></a>Отрисовка высокодинамичных голограмм с использованием стационарной системы отсчета вместо локальной пространственной привязки

Если у вас есть высокая динамическая голограмма, например обход символов вокруг комнаты или плавающий пользовательский интерфейс, следующий за стеной рядом с пользователем, лучше пропускать локальные пространственные привязки и визуализировать эти голограммы непосредственно в системе координат, предоставляемой [стационарным кадром ссылки](coordinate-systems.md#stationary-frame-of-reference). В Unity это достигается путем размещения голограмм непосредственно в мировых координатах без Ворлданчор. Голограммы в стационарной рамке ссылки могут иметь отклонения, когда пользователь далеко от голограммы. Но это менее вероятно для динамических голограмм: либо Эта голограмма постоянно перемещается, либо ее движение постоянно сохраняет его близко к пользователю, где смещение будет сведено к минимуму.

Интересным случаем при использовании динамических голограмм является возможность анимации объекта из одной привязанной системы координат в другую. Например, у вас может быть два КАСТЛЕС на 10 метров, каждый на отдельной пространственной привязке с одним Castle, каннонбалл на другом Castle. В момент запуска каннонбалл вы можете визуализировать его в соответствующем месте в стационарной рамке ссылки, чтобы совпадать с Каннон в первой Castle закрепленной системе координат. Затем оно может следовать своей траектории в стационарной системе отсчета, пролетая 10 метров по воздуху. По мере того как каннонбалл достигает другого Castle, вы можете переместить его во вторую систему координат, привязанную к Castle, чтобы обеспечить физические вычисления с жесткими текстами Castle.

При совместном использовании высокой динамической голограммы на устройствах вам потребуется выбрать какую-либо облачную привязку, которая будет действовать в качестве своего родителя, поскольку стационарные кадры ссылки нельзя совместно использовать на разных устройствах.  Однако в этом случае следует убедиться, что либо динамическая голограмма, либо устройства, просматривающие его, остаются в пределах 3-радиуса привязки, чтобы обеспечить стабильность на всех устройствах.

### <a name="avoid-creating-a-grid-of-spatial-anchors"></a>Не следует создавать сетку пространственных привязок

Может показаться, что приложение будет удалять обычную сетку пространственных привязок по мере того, как пользователь выполняет обход, перемещая динамические объекты из привязки в привязку при перемещении. Однако это требует большого количества управления для вашего приложения без использования данных глубокого датчика, которые сама система поддерживает. В таких случаях вы, как правило, получите лучшие результаты с меньшими усилиями, поместив голограммы в стационарную рамку справочника, как описано в разделе выше.
При предварительном размещении набора пространственных привязок в облаке вокруг статического пространства рассмотрите возможность размещения пространственных привязок в расположениях с ключевыми направляющими, которые пользователь встречает в соответствии с описанным выше принципом, а не создавая произвольную сетку привязок. Это гарантирует максимальную стабильность этих ключевых голограмм.

### <a name="release-local-spatial-anchors-you-no-longer-need"></a>Удаляйте пространственные привязки, которые больше не нужны

В то время как локальная пространственное привязку активна, система устанавливает приоритеты, сохраняющие данные датчика, расположенные рядом с этой точкой привязки. Если вы больше не используете пространственную привязку, ограничьте доступ к ее системе координат. Это позволяет удалять данные базового датчика при необходимости.

Это особенно важно для локальных привязок, сохраненных в хранилище пространственных привязок. Данные датчика, лежащие в основе этих привязок, будут постоянно храниться, чтобы позволить приложению найти эту привязку в будущих сеансах, что сокращает пространство, доступное для наблюдения за другими привязками. Сохраняйте только локальные привязки, которые необходимо найти в будущих сеансах, и удалите их из хранилища, если они больше не важны для пользователя.

Для облачных пространственных привязок хранилище можно масштабировать в соответствии с вашим сценарием. При необходимости можно хранить любое количество облачных привязок, освобождая их только в том случае, если вам известно, что пользователям больше не придется размещать голограммы на этой точке привязки.

## <a name="see-also"></a>См. также раздел
* [Системы координат](coordinate-systems.md)
* [Общий доступ в смешанной реальности](../develop/platform-capabilities-and-apis/shared-experiences-in-mixed-reality.md)
* <a href="https://docs.microsoft.com/azure/spatial-anchors" target="_blank">Пространственные привязки Azure</a>
* [Сохраняемость в Unity](../develop/unity/persistence-in-unity.md)
* [Coordinate systems in DirectX](../develop/native/coordinate-systems-in-directx.md#place-holograms-in-the-world-using-spatial-anchors) (Системы координат в DirectX)
* [Case study - Looking through holes in your reality](../out-of-scope/case-study-looking-through-holes-in-your-reality.md) (Пример использования. Взгляд сквозь отверстия в реальности)
