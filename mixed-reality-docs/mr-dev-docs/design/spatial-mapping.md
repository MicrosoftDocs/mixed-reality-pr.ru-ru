---
title: пространственное сопоставление
description: Пространственное сопоставление предоставляет подробное представление реальных поверхностей в среде вокруг HoloLens.
author: mattzmsft
ms.author: mazeller
ms.date: 03/21/2018
ms.topic: article
keywords: пространственное сопоставление, HoloLens, Mixed Reality, реконструкция поверхности, сетка, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности, HoloLens, МРТК, набор средств для смешанной реальности, понимание сцены, универсальная сеть, перекрытия, физика, навигация, наблюдатель поверхности, отрисовка, обработка в сети
ms.openlocfilehash: 1c41706abc0a393e8530b38be83fed49ed3e20a6
ms.sourcegitcommit: d3a3b4f13b3728cfdd4d43035c806c0791d3f2fe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/20/2021
ms.locfileid: "98583272"
---
# <a name="spatial-mapping"></a><span data-ttu-id="5a9e6-104">пространственное сопоставление</span><span class="sxs-lookup"><span data-stu-id="5a9e6-104">Spatial mapping</span></span>

<span data-ttu-id="5a9e6-105">Пространственное сопоставление предоставляет подробное представление реальных поверхностей в среде вокруг HoloLens, что позволяет разработчикам создавать убедительные возможности смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-105">Spatial mapping provides a detailed representation of real-world surfaces in the environment around the HoloLens, allowing developers to create a convincing mixed reality experience.</span></span> <span data-ttu-id="5a9e6-106">Благодаря объединению реального мира с виртуальным миром приложение может показаться голограммным.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-106">By merging the real world with the virtual world, an application can make holograms seem real.</span></span> <span data-ttu-id="5a9e6-107">Приложения также могут более естественно сопоставляться с ожиданиями пользователей, предоставляя привычные реальные поведения и взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-107">Applications can also more naturally align with user expectations by providing familiar real-world behaviors and interactions.</span></span>

<br>

>[!VIDEO https://www.youtube.com/embed/zff2aQ1RaVo]

## <a name="device-supports"></a><span data-ttu-id="5a9e6-108">Устройство поддерживает</span><span class="sxs-lookup"><span data-stu-id="5a9e6-108">Device supports</span></span>

<table>
    <colgroup>
    <col width="25%" />
    <col width="25%" />
    <col width="25%" />
    <col width="25%" />
    </colgroup>
    <tr>
        <td><span data-ttu-id="5a9e6-109"><strong>Возможность</strong></span><span class="sxs-lookup"><span data-stu-id="5a9e6-109"><strong>Feature</strong></span></span></td>
        <td><span data-ttu-id="5a9e6-110"><a href="/hololens/hololens1-hardware"><strong>HoloLens (1-го поколения)</strong></a></span><span class="sxs-lookup"><span data-stu-id="5a9e6-110"><a href="/hololens/hololens1-hardware"><strong>HoloLens (1st gen)</strong></a></span></span></td>
        <td><span data-ttu-id="5a9e6-111"><a href="https://docs.microsoft.com/hololens/hololens2-hardware"><strong>HoloLens 2</strong></span><span class="sxs-lookup"><span data-stu-id="5a9e6-111"><a href="https://docs.microsoft.com/hololens/hololens2-hardware"><strong>HoloLens 2</strong></span></span></td>
        <td><span data-ttu-id="5a9e6-112"><a href="../discover/immersive-headset-hardware-details.md"><strong>Иммерсивные гарнитуры</strong></a></span><span class="sxs-lookup"><span data-stu-id="5a9e6-112"><a href="../discover/immersive-headset-hardware-details.md"><strong>Immersive headsets</strong></a></span></span></td>
    </tr>
     <tr>
        <td><span data-ttu-id="5a9e6-113">пространственное сопоставление</span><span class="sxs-lookup"><span data-stu-id="5a9e6-113">Spatial mapping</span></span></td>
        <td><span data-ttu-id="5a9e6-114">✔️</span><span class="sxs-lookup"><span data-stu-id="5a9e6-114">✔️</span></span></td>
        <td><span data-ttu-id="5a9e6-115">✔️</span><span class="sxs-lookup"><span data-stu-id="5a9e6-115">✔️</span></span></td>
        <td>❌</td>
    </tr>
</table>


## <a name="why-is-spatial-mapping-important"></a><span data-ttu-id="5a9e6-116">Зачем важны пространственное сопоставление?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-116">Why is spatial mapping important?</span></span>

<span data-ttu-id="5a9e6-117">Пространственное сопоставление позволяет размещать объекты на реальных поверхностях.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-117">Spatial mapping makes it possible to place objects on real surfaces.</span></span> <span data-ttu-id="5a9e6-118">Это помогает привязать объекты в мире пользователя и использовать преимущества реальных подсказок по глубине мира. Окклудинг свои голограммы, основанные на других голограммах и реальных объектах, помогут убедить пользователя, что эти голограммы действительно находятся в своем пространстве.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-118">This helps anchor objects in the user's world and takes advantage of real world depth cues. Occluding your holograms based on other holograms and real world objects helps convince the user that these holograms are actually in their space.</span></span> <span data-ttu-id="5a9e6-119">Голограммы с плавающей точкой или перемещение с помощью пользователя не покажется реальным.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-119">Holograms floating in space or moving with the user won't feel as real.</span></span> <span data-ttu-id="5a9e6-120">По возможности размещайте элементы для удобства.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-120">When possible, place items for comfort.</span></span>

<span data-ttu-id="5a9e6-121">Визуализируйте поверхности при помещении или перемещении голограмм (используйте предполагаемую сетку).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-121">Visualize surfaces when placing or moving holograms (use a projected grid).</span></span> <span data-ttu-id="5a9e6-122">Это помогает пользователям понять, где лучше размещать голограммы, и показывает, не сопоставлено ли место, где они пытаются поместить голограмму.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-122">This helps users know where they can best place their holograms, and shows if the spot they're trying to place the hologram isn't mapped.</span></span> <span data-ttu-id="5a9e6-123">Вы можете «элементы объявления» ближе к пользователю, если они имеют слишком большую часть угла.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-123">You can "billboard items" toward the user if they end up at too much of an angle.</span></span>

## <a name="conceptual-overview"></a><span data-ttu-id="5a9e6-124">Общие сведения</span><span class="sxs-lookup"><span data-stu-id="5a9e6-124">Conceptual overview</span></span>

<span data-ttu-id="5a9e6-125">![Поверхности сетки, охватывающие комнату](images/SurfaceReconstruction.jpg)</span><span class="sxs-lookup"><span data-stu-id="5a9e6-125">![Mesh surfaces covering a room](images/SurfaceReconstruction.jpg)</span></span><br>
<span data-ttu-id="5a9e6-126">*Пример сетки пространственного сопоставления, охватывающей комнату*</span><span class="sxs-lookup"><span data-stu-id="5a9e6-126">*An example of a spatial mapping mesh covering a room*</span></span>

<span data-ttu-id="5a9e6-127">Для пространственного сопоставления используются два типа основных объекта: "наблюдатель поверхности" и "пространственный Surface".</span><span class="sxs-lookup"><span data-stu-id="5a9e6-127">The two primary object types used for spatial mapping are the 'Spatial Surface Observer' and the 'Spatial Surface'.</span></span>

<span data-ttu-id="5a9e6-128">Приложение предоставляет наблюдателю пространственной поверхности один или несколько ограничивающих томов для определения областей пространства, в которых приложение должно получить данные пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-128">The application provides the Spatial Surface Observer with one or more bounding volumes, to define the regions of space in which the application wishes to receive spatial mapping data.</span></span> <span data-ttu-id="5a9e6-129">Для каждого из этих томов пространственное сопоставление предоставит приложению набор пространственных поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-129">For each of these volumes, spatial mapping will provide the application with a set of Spatial Surfaces.</span></span>

<span data-ttu-id="5a9e6-130">Эти тома могут быть стационарными (в фиксированном расположении, основанном на реальных условиях), или они могут быть присоединены к HoloLens (они перемещаются, но не поворачиваются с помощью HoloLens по мере перемещения в среде).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-130">These volumes may be stationary (in a fixed location based on the real world) or they may be attached to the HoloLens (they move, but don't rotate, with the HoloLens as it moves through the environment).</span></span> <span data-ttu-id="5a9e6-131">Каждая пространственный поверхность описывает реальные поверхности в небольшом объеме пространства, представленной в виде сетки треугольников, прикрепленной к геозаблокированной [пространственной системе координат](coordinate-systems.md).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-131">Each spatial surface describes real-world surfaces in a small volume of space, represented as a triangle mesh attached to a world-locked [spatial coordinate system](coordinate-systems.md).</span></span>

<span data-ttu-id="5a9e6-132">Так как HoloLens собирает новые данные о среде и при возникновении изменений в среде, пространственные поверхности будут отображаться, исчезнуть и измениться.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-132">As the HoloLens gathers new data about the environment, and as changes to the environment occur, spatial surfaces will appear, disappear, and change.</span></span>

## <a name="spatial-mapping-vs-scene-understanding-worldmesh"></a><span data-ttu-id="5a9e6-133">Пространственное сопоставление и сцены общие сведения о Ворлдмеш</span><span class="sxs-lookup"><span data-stu-id="5a9e6-133">Spatial Mapping vs. Scene Understanding WorldMesh</span></span>

<span data-ttu-id="5a9e6-134">Для HoloLens 2 можно запросить статическую версию данных пространственного сопоставления, используя [пакет SDK для сцены](../develop/platform-capabilities-and-apis/scene-understanding-SDK.md) (параметр енаблеворлдмеш).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-134">For HoloLens 2, it's possible to query a static version of the spatial mapping data using [Scene understanding SDK](../develop/platform-capabilities-and-apis/scene-understanding-SDK.md) (EnableWorldMesh setting).</span></span> <span data-ttu-id="5a9e6-135">Ниже приведены различия между двумя способами доступа к данным пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-135">Here are the differences between two ways of accessing the spatial mapping data:</span></span>
* <span data-ttu-id="5a9e6-136">API-интерфейс пространственного сопоставления:</span><span class="sxs-lookup"><span data-stu-id="5a9e6-136">Spatial Mapping API:</span></span>
   * <span data-ttu-id="5a9e6-137">Ограниченный диапазон: данные пространственного сопоставления доступны приложениям в кэшированном "пузырьке" с ограниченным размером, чем пользователь.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-137">Limited range: the spatial mapping data available to applications in a limited size cached 'bubble' around the user.</span></span>
   * <span data-ttu-id="5a9e6-138">Предоставляет обновления с низкой задержкой для измененных областей сетки с помощью событий Сурфацесчанжед.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-138">Provides low latency updates of changed mesh regions through SurfacesChanged events.</span></span>
   * <span data-ttu-id="5a9e6-139">Уровень детализации сведений, управляемых треугольниками на параметр метра третьего уровня.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-139">Variable level of details controlled by Triangles Per Cubic Meter parameter.</span></span>
* <span data-ttu-id="5a9e6-140">Пакет SDK для понимания сцены:</span><span class="sxs-lookup"><span data-stu-id="5a9e6-140">Scene understanding SDK:</span></span>
   * <span data-ttu-id="5a9e6-141">Неограниченный диапазон — предоставляет все просканированные данные пространственного сопоставления в запросе RADIUS.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-141">Unlimited range - provides all the scanned spatial mapping data within the query radius.</span></span>
   * <span data-ttu-id="5a9e6-142">Предоставляет статический моментальный снимок данных пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-142">Provides a static snapshot of the spatial mapping data.</span></span> <span data-ttu-id="5a9e6-143">Для получения обновленных данных пространственного сопоставления необходимо запустить новый запрос для всей сетки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-143">Getting the updated spatial mapping data requires running a new query for the whole mesh.</span></span>
   * <span data-ttu-id="5a9e6-144">Последовательный уровень детализации, управляемый параметром Рекуестедмешлевелофдетаил.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-144">Consistent level of details controlled by RequestedMeshLevelOfDetail setting.</span></span>

## <a name="what-influences-spatial-mapping-quality"></a><span data-ttu-id="5a9e6-145">Что влияет на качество пространственного сопоставления?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-145">What influences spatial mapping quality?</span></span>

<span data-ttu-id="5a9e6-146">Несколько факторов, подробно описанных [здесь](/hololens/hololens-environment-considerations), могут повлиять на частоту и серьезность этих ошибок.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-146">Several factors, detailed [here](/hololens/hololens-environment-considerations), can affect the frequency and severity of these errors.</span></span>  <span data-ttu-id="5a9e6-147">Однако следует спроектировать приложение таким образом, чтобы пользователь мог достигнуть своих целей даже при наличии ошибок в данных пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-147">However, you should design your application so that the user can achieve their goals even in the presence of errors in the spatial mapping data.</span></span>

## <a name="common-usage-scenarios"></a><span data-ttu-id="5a9e6-148">Основные сценарии использования</span><span class="sxs-lookup"><span data-stu-id="5a9e6-148">Common usage scenarios</span></span>

![Иллюстрации распространенных сценариев использования пространственного сопоставления: размещение, перекрытия, физика и Навигация](images/sm-concepts-1000px.png)

### <a name="placement"></a><span data-ttu-id="5a9e6-150">Размещение</span><span class="sxs-lookup"><span data-stu-id="5a9e6-150">Placement</span></span>

<span data-ttu-id="5a9e6-151">Пространственное сопоставление предоставляет приложениям возможность представлять естественные и привычные формы взаимодействия с пользователем. что может быть более естественным, чем размещение телефона на столе?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-151">Spatial mapping provides applications with the opportunity to present natural and familiar forms of interaction to the user; what could be more natural than placing down your phone on the desk?</span></span>

<span data-ttu-id="5a9e6-152">Ограничение размещения голограмм (или, как правило, выбор пространственных расположений) для находящихся на поверхностях обеспечивает естественное сопоставление из трехмерной (точки в пространстве) к 2D (точка на поверхности).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-152">Constraining the placement of holograms (or more generally, any selection of spatial locations) to lie on surfaces provides a natural mapping from 3D (point in space) to 2D (point on surface).</span></span> <span data-ttu-id="5a9e6-153">Это сокращает объем информации, которую пользователь должен предоставить приложению, и ускоряет, упрощает и точнее взаимодействие пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-153">This reduces the amount of information the user needs to provide to the application and makes the user's interactions faster, easier, and more precise.</span></span> <span data-ttu-id="5a9e6-154">Это справедливо, так как "расстояние на расстоянии" — это не то, что мы используем для физического обмена данными с другими людьми или компьютерами.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-154">This is true because 'distance away' isn't something that we're used to physically communicating to other people or to computers.</span></span> <span data-ttu-id="5a9e6-155">При наведении указателя мыши на наш палец мы указываем направление, но не расстояние.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-155">When we point with our finger, we're specifying a direction but not a distance.</span></span>

<span data-ttu-id="5a9e6-156">Важно отметить, что когда приложение определяет расстояние от направления (например, райкастся вдоль направления взгляда пользователя для поиска ближайшей пространственной поверхности), это должно привести к получению результатов, которые пользователь может надежно предсказать.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-156">An important caveat here's that when an application infers distance from direction (for example by doing a raycast along the user's gaze direction to find the nearest spatial surface), this must yield results that the user can reliably predict.</span></span> <span data-ttu-id="5a9e6-157">В противном случае пользователь теряет свое представление об управлении, и это может быстро стать неприятной.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-157">Otherwise, the user will lose their sense of control and this can quickly become frustrating.</span></span> <span data-ttu-id="5a9e6-158">Один из методов, который помогает в этом, заключается в том, чтобы сделать несколько райкастс, а не только один.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-158">One method that helps with this is to do multiple raycasts instead of just one.</span></span> <span data-ttu-id="5a9e6-159">Статистические результаты должны быть более гладкими и предсказуемыми, менее подверженными воздействию влияния на временные результаты "выбросов" (как это может быть вызвано лучими, передаваемых через небольшие промежутки или на маленькие биты геометрии, о которых пользователь не знает).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-159">The aggregate results should be smoother and more predictable, less susceptible to influence from transient 'outlier' results (as can be caused by rays passing through tiny holes or hitting small bits of geometry that the user isn't aware of).</span></span> <span data-ttu-id="5a9e6-160">Агрегирование или Сглаживание можно также выполнять с течением времени; Например, можно ограничить максимальную скорость, с которой голограмма может различаться на расстоянии от пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-160">Aggregation or smoothing can also be performed over time; for example, you can limit the maximum speed at which a hologram can vary in distance from the user.</span></span> <span data-ttu-id="5a9e6-161">Простое ограничение минимального и максимального расстояния также может помочь, так что перемещенная голограмма не покидается на расстоянии или происходит сбой обратно в лицо пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-161">Simply limiting the minimum and maximum distance value can also help, so the hologram being moved doesn't suddenly fly away into the distance or come crashing back into the user's face.</span></span>

<span data-ttu-id="5a9e6-162">Приложения также могут использовать форму и направление поверхностей для указания размещения голограмм.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-162">Applications can also use the shape and direction of surfaces to guide hologram placement.</span></span> <span data-ttu-id="5a9e6-163">В случае с проникнутьом с помощью стен мы не должны полагаться на прокрутку с этажом, даже если это немного нечетным.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-163">A holographic chair shouldn't penetrate through walls and should sit flush with the floor even if it's slightly uneven.</span></span> <span data-ttu-id="5a9e6-164">Этот тип функций, вероятно, будет зависеть от использования физических конфликтов, а не райкастс, однако будут применяться аналогичные проблемы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-164">This kind of functionality would likely rely upon the use of physics collisions rather than raycasts, however similar concerns will apply.</span></span> <span data-ttu-id="5a9e6-165">Если размещенная голограмма содержит много маленьких многоугольников, таких как находящиеся в кресле, может иметь смысл расширить физическое представление этих многоугольников до более широкого и гладкого, чтобы они могли продвигаться по пространственной поверхности без очистка.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-165">If the hologram being placed has many small polygons that stick out, like the legs on a chair, it may make sense to expand the physics representation of those polygons to something wider and smoother so that they're more able to slide over spatial surfaces without snagging.</span></span>

<span data-ttu-id="5a9e6-166">В свою сторону ввод данных пользователем можно полностью упростить, а пространственные поверхности можно использовать для полного автоматического размещения голограмм.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-166">At its extreme, user input can be simplified away entirely and spatial surfaces can be used to do entirely automatic hologram placement.</span></span> <span data-ttu-id="5a9e6-167">Например, приложение может разместить holographic-выключатель в другом месте на стене, чтобы пользователь мог нажать.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-167">For example, the application could place a holographic light-switch somewhere on the wall for the user to press.</span></span> <span data-ttu-id="5a9e6-168">Те же предостережения о предсказуемости применяются вдвое. Если пользователь ждет управления размещением с голограммами, но приложение не всегда помещает голограммы там, где они предполагают (если светло-выключатель находится в другом месте, к которому пользователь не может достичь), это будет неприятной опыт.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-168">The same caveat about predictability applies doubly here; if the user expects control over hologram placement, but the application doesn't always place holograms where they expect (if the light-switch appears somewhere that the user can't reach), then this will be a frustrating experience.</span></span> <span data-ttu-id="5a9e6-169">Это может быть хуже для автоматического размещения, требующего коррекции пользователя в определенный момент времени, чем просто потребовать от пользователя всегда выполнять самостоятельное размещение. так как *предполагается* успешное автоматическое размещение, ручное исправление вроде накладных расходов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-169">It can actually be worse to do automatic placement that requires user correction some of the time, than to just require the user to always do placement themselves; because successful automatic placement is *expected*, manual correction feels like a burden!</span></span>

<span data-ttu-id="5a9e6-170">Обратите внимание, что способность приложения использовать пространственные поверхности для размещения в значительной степени зависит от [процесса сканирования](spatial-mapping.md#the-environment-scanning-experience)приложения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-170">Note also that the ability of an application to use spatial surfaces for placement depends heavily on the application's [scanning experience](spatial-mapping.md#the-environment-scanning-experience).</span></span> <span data-ttu-id="5a9e6-171">Если поверхность не была проверена, ее нельзя использовать для размещения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-171">If a surface hasn't been scanned, then it cannot be used for placement.</span></span> <span data-ttu-id="5a9e6-172">Приложение может сделать это понятным для пользователя, чтобы оно было полезно для сканирования новых поверхностей или выбора нового расположения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-172">It's up to the application to make this clear to the user, so that they can either help scan new surfaces or select a new location.</span></span>

<span data-ttu-id="5a9e6-173">Визуальная обратная связь с пользователем имеет первостепенное значение во время размещения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-173">Visual feedback to the user is of paramount importance during placement.</span></span> <span data-ttu-id="5a9e6-174">Пользователь должен быть уверен, что голограмма основана на ближайшей поверхности с [эффектами заземления](spatial-mapping.md#visualization).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-174">The user needs to know where the hologram is based on the nearest surface with [grounding effects](spatial-mapping.md#visualization).</span></span> <span data-ttu-id="5a9e6-175">Они должны понимать, почему движение их голограммы ограничено (например, из-за конфликтов с другой соседней поверхностью).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-175">They should understand why the movement of their hologram is being constrained (for example, because of collisions with another nearby surface).</span></span> <span data-ttu-id="5a9e6-176">Если они не могут поместить голограмму в текущее место, визуальная обратная связь должна сделать ее неясной.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-176">If they can't place a hologram in the current location, then visual feedback should make it clear why not.</span></span> <span data-ttu-id="5a9e6-177">Например, если пользователь пытается поместить полугодовой полукруг в стену, то части дивана, расположенные позади стены, должны пулсате в цвет злость.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-177">For example, if the user is trying to place a holographic couch stuck half-way into the wall, then the portions of the couch that are behind the wall should pulsate in an angry color.</span></span> <span data-ttu-id="5a9e6-178">Или наоборот, если приложению не удается найти пространственной контакт в расположении, где пользователь может видеть реальную поверхность, приложение должно сделать это ясно.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-178">Or conversely, if the application can't find a spatial surface in a location where the user can see a real-world surface, then the application should make this clear.</span></span> <span data-ttu-id="5a9e6-179">Очевидное отсутствие влияния на заземление в этой области может достичь этой цели.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-179">The obvious absence of a grounding effect in this area may achieve this purpose.</span></span>

### <a name="occlusion"></a><span data-ttu-id="5a9e6-180">Загораживание</span><span class="sxs-lookup"><span data-stu-id="5a9e6-180">Occlusion</span></span>

<span data-ttu-id="5a9e6-181">Одним из основных способов использования поверхностей пространственного сопоставления является просто окклуде голограмм.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-181">One of the primary uses of spatial mapping surfaces is simply to occlude holograms.</span></span> <span data-ttu-id="5a9e6-182">Это простое поведение оказывает огромное влияние на наблюдаемый реальный эффект голограмм, помогая создать висцералй смысл, который действительно не наследуется на том же физическом пространстве, что и пользователь.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-182">This simple behavior has a huge impact on the perceived realism of holograms, helping to create a visceral sense that really inhabits the same physical space as the user.</span></span>

<span data-ttu-id="5a9e6-183">Перекрытия также предоставляет пользователю сведения; когда кажется, что голограмма перекрытоа реальной поверхностью, это позволяет получить дополнительные визуальные отзывы в отношении пространственного расположения этой голограммы в мире.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-183">Occlusion also provides information to the user; when a hologram appears to be occluded by a real-world surface, this provides extra visual feedback as to the spatial location of that hologram in the world.</span></span> <span data-ttu-id="5a9e6-184">И наоборот, перекрытия может также с легкостью *Скрыть* информацию от пользователя; окклудингные голограммы, лежащие в основе стен, могут уменьшить визуальное неудобство.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-184">Conversely, occlusion can also usefully *hide* information from the user; occluding holograms behind walls can reduce visual clutter in an intuitive way.</span></span> <span data-ttu-id="5a9e6-185">Чтобы скрыть или раскрыть голограмму, пользователю нужно просто переместить его заголовок.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-185">To hide or reveal a hologram, the user merely has to move their head.</span></span>

<span data-ttu-id="5a9e6-186">Перекрытия также можно использовать в качестве простых ожиданий для естественного пользовательского интерфейса на основе привычных физических взаимодействий. Если голограмма перекрыто на поверхности, это связано с тем, что эта поверхность сплошна, поэтому пользователь должен предполагать, что голограмма будет *конфликтовать* с этой поверхностью и не пройдет ее.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-186">Occlusion can also be used to prime expectations for a natural user interface based upon familiar physical interactions; if a hologram is occluded by a surface it is because that surface is solid, so the user should expect that the hologram will *collide* with that surface and not pass through it.</span></span>

<span data-ttu-id="5a9e6-187">Иногда перекрытия голограммы нежелательны.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-187">Sometimes, occlusion of holograms is undesirable.</span></span> <span data-ttu-id="5a9e6-188">Если пользователь должен взаимодействовать с голограммой, он должен увидеть его, даже если он находится за реальной поверхностью.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-188">If a user needs to interact with a hologram, then they need to see it - even if it is behind a real-world surface.</span></span> <span data-ttu-id="5a9e6-189">В таких случаях, как правило, имеет смысл визуализировать такую голограмму по-разному, если это перекрыто (например, путем уменьшения яркости).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-189">In such cases, it usually makes sense to render such a hologram differently when it's occluded (for example, by reducing its brightness).</span></span> <span data-ttu-id="5a9e6-190">Таким образом, пользователь может визуально разыскать голограмму, но он по-прежнему знает, что он находится позади чего-нибудь.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-190">This way, the user can visually locate the hologram, but they'll still know it's behind something.</span></span>

### <a name="physics"></a><span data-ttu-id="5a9e6-191">Физика</span><span class="sxs-lookup"><span data-stu-id="5a9e6-191">Physics</span></span>

<span data-ttu-id="5a9e6-192">Использование физического моделирования является еще одним способом, в котором можно использовать пространственное сопоставление, чтобы усилить *наличие* голограмм в физическом пространстве пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-192">The use of physics simulation is another way in which spatial mapping can be used to reinforce the *presence* of holograms in the user's physical space.</span></span> <span data-ttu-id="5a9e6-193">Когда мой резиновой шар на самом деле выходит за пределы рабочего стола, переводится на этаж и исчезает на диване, может быть трудно поверить, что это не так.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-193">When my holographic rubber ball rolls realistically off my desk, bounces across the floor and disappears under the couch, it might be hard for me to believe that it's not there.</span></span>

<span data-ttu-id="5a9e6-194">Модель физического моделирования также предоставляет приложению возможность использовать естественные и привычные виды взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-194">Physics simulation also provides the opportunity for an application to use natural and familiar physics-based interactions.</span></span> <span data-ttu-id="5a9e6-195">Перемещение фрагмента holographic с помощью этажа в этаж, скорее всего, будет проще, если мебель будет реагировать так, как будто она была перемещена по полу с соответствующей инерцией и трением.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-195">Moving a piece of holographic furniture around on the floor will likely be easier for the user if the furniture responds as if it were sliding across the floor with the appropriate inertia and friction.</span></span>

<span data-ttu-id="5a9e6-196">Для создания реалистичных физических поведений вам, скорее всего, потребуется выполнить некоторую [обработку сетки](spatial-mapping.md#mesh-processing) , например заполнение отверстий, удаление плавающих халлуЦинатионс и плавность грубых поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-196">To generate realistic physical behaviors, you'll likely need to do some [mesh processing](spatial-mapping.md#mesh-processing) such as filling holes, removing floating hallucinations and smoothing rough surfaces.</span></span>

<span data-ttu-id="5a9e6-197">Кроме того, необходимо учитывать, как [процесс сканирования](spatial-mapping.md#the-environment-scanning-experience) приложения влияет на его физическое моделирование.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-197">You'll also need to consider how your application's [scanning experience](spatial-mapping.md#the-environment-scanning-experience) influences its physics simulation.</span></span> <span data-ttu-id="5a9e6-198">Во-первых, отсутствующие поверхности не будут конфликтовать ни с чем. что происходит, когда резинка выходит из корридор и выходит за пределы известного мира?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-198">Firstly, missing surfaces won't collide with anything; what happens when the rubber ball rolls off down the corridor and off the end of the known world?</span></span> <span data-ttu-id="5a9e6-199">Во вторых, необходимо решить, будет ли продолжать отвечать на изменения в среде с течением времени.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-199">Secondly, you need to decide whether you'll continue to respond to changes in the environment over time.</span></span> <span data-ttu-id="5a9e6-200">В некоторых случаях вы захотите ответить как можно быстрее. Предположим, что пользователь использует двери и мебель в качестве перемещаемого баррикадеса при защите от темпестных стрелок.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-200">In some cases, you'll want to respond as quickly as possible; say if the user is using doors and furniture as movable barricades in defense against a tempest of incoming Roman arrows.</span></span> <span data-ttu-id="5a9e6-201">В других случаях может потребоваться пропустить новые обновления. Если вы решите навестись на середину курса, вы можете поработать с более рацетраккным автомобилем в течение всего мира.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-201">In other cases though, you may want to ignore new updates; driving your holographic sports car around the racetrack on your floor may suddenly not be so fun if your dog decides to sit in the middle of the track.</span></span>

### <a name="navigation"></a><span data-ttu-id="5a9e6-202">Навигация</span><span class="sxs-lookup"><span data-stu-id="5a9e6-202">Navigation</span></span>

<span data-ttu-id="5a9e6-203">Приложения могут использовать данные пространственного сопоставления, чтобы предоставить holographic (или агентам) возможность перемещаться по реальному миру таким же образом, как и реальный человек.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-203">Applications can use spatial mapping data to grant holographic characters (or agents) the ability to navigate the real world in the same way a real person would.</span></span> <span data-ttu-id="5a9e6-204">Это может помочь в улучшении наличия holographic символов, запретив их одному и тому же набору естественных, привычных вариантов поведения пользователя и их друзей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-204">This can help reinforce the presence of holographic characters by restricting them to the same set of natural, familiar behaviors as those of the user and their friends.</span></span>

<span data-ttu-id="5a9e6-205">Возможности навигации также могут быть полезными для пользователей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-205">Navigation capabilities could be useful to users as well.</span></span> <span data-ttu-id="5a9e6-206">После того как схема навигации создана в определенной области, она может предоставить общий доступ для новых пользователей, не знакомых с этим расположением.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-206">Once a navigation map has been built in a given area, it could be shared to provide holographic directions for new users unfamiliar with that location.</span></span> <span data-ttu-id="5a9e6-207">Эта схема может помочь в предотвращении бесперебойной работы пешеход трафика или во избежание всякое в опасных расположениях, таких как разработка сайтов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-207">This map could be designed to help keep pedestrian 'traffic' flowing smoothly, or to avoid accidents in dangerous locations like construction sites.</span></span>

<span data-ttu-id="5a9e6-208">Основные технические проблемы, связанные с реализацией функций навигации, будут надежно обнаруживать поверхности неанализируемой (люди не проходят по таблицам!) и корректно адаптации к изменениям в среде (люди не проходят через замкнутые двери).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-208">The key technical challenges involved in implementing navigation functionality will be reliable detection of walkable surfaces (humans don't walk on tables!) and graceful adaptation to changes in the environment (humans don't walk through closed doors!).</span></span> <span data-ttu-id="5a9e6-209">Для сети может потребоваться определенная [Обработка](spatial-mapping.md#mesh-processing) , прежде чем ее можно будет использовать для планирования пути и перехода по виртуальному символу.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-209">The mesh may require some [processing](spatial-mapping.md#mesh-processing) before it's usable for path-planning and navigation by a virtual character.</span></span> <span data-ttu-id="5a9e6-210">Смягчение сетки и удаление халлуЦинатионс могут помочь избежать зависания символов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-210">Smoothing the mesh and removing hallucinations may help avoid characters becoming stuck.</span></span> <span data-ttu-id="5a9e6-211">Вы также можете значительно упростить эту сетку, чтобы ускорить вычисление пути и вычислений навигации.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-211">You may also wish to drastically simplify the mesh to speed up your character's path-planning and navigation calculations.</span></span> <span data-ttu-id="5a9e6-212">Эти трудности приступили к разработку технологии видеоигр, и в этих статьях есть множество доступных справочных материалов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-212">These challenges have received a great deal of attention in the development of video game technology, and there's a wealth of available research literature on these topics.</span></span>

<span data-ttu-id="5a9e6-213">Встроенные функции Навмеш в Unity нельзя использовать с областями пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-213">The built-in NavMesh functionality in Unity cannot be used with spatial mapping surfaces.</span></span> <span data-ttu-id="5a9e6-214">Это связано с тем, что поверхности пространственного сопоставления не известны до запуска приложения, но Навмеш файлы данных должны создаваться из исходных ресурсов заранее.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-214">This is because spatial mapping surfaces aren't known until the application starts, but NavMesh data files need to be generated from source assets ahead of time.</span></span> <span data-ttu-id="5a9e6-215">Также обратите внимание, что система пространственных сопоставлений не будет предоставлять [сведения о поверхностях далеко](spatial-mapping.md#the-environment-scanning-experience) от текущего расположения пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-215">Also note that, the spatial mapping system won't provide [information about surfaces far away](spatial-mapping.md#the-environment-scanning-experience) from the user's current location.</span></span> <span data-ttu-id="5a9e6-216">Поэтому приложение должно «запомнить» поверхности, если нужно создать карту большой области.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-216">So the application must 'remember' surfaces itself if it's to build a map of a large area.</span></span>

### <a name="visualization"></a><span data-ttu-id="5a9e6-217">Визуализация</span><span class="sxs-lookup"><span data-stu-id="5a9e6-217">Visualization</span></span>

<span data-ttu-id="5a9e6-218">В большинстве случаев пространственные поверхности должны быть невидимыми. чтобы избежать ненужных визуальных элементов и позволить реально говорить себе.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-218">Most of the time it's appropriate for spatial surfaces to be invisible; to minimize visual clutter and let the real world speak for itself.</span></span> <span data-ttu-id="5a9e6-219">Тем не менее иногда полезно визуализировать поверхности пространственного сопоставления напрямую, несмотря на то, что их реальные аналоги видимы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-219">However, sometimes it's useful to visualize spatial mapping surfaces directly, despite their real-world counterparts being visible.</span></span>

<span data-ttu-id="5a9e6-220">Например, когда пользователь пытается поместить голограмму на поверхность (поместив в нее файл holographic, скажем), это может быть полезно для «заземления» голограммы путем приведения тени к поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-220">For example, when the user is trying to place a hologram onto a surface (placing a holographic cabinet on the wall, say) it can be useful to 'ground' the hologram by casting a shadow onto the surface.</span></span> <span data-ttu-id="5a9e6-221">Это дает пользователю более четкое представление о точном физическом сходстве между голограммой и поверхностью.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-221">This gives the user a much clearer sense of the exact physical proximity between the hologram and the surface.</span></span> <span data-ttu-id="5a9e6-222">Это также пример более общего способа визуального просмотра изменений до того, как пользователь зафиксирует в нем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-222">This is also an example of the more general practice of visually 'previewing' a change before the user commits to it.</span></span>

<span data-ttu-id="5a9e6-223">Визуализируя поверхности, приложение может предоставить пользователю общее представление о среде.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-223">By visualizing surfaces, the application can share with the user its understanding of the environment.</span></span> <span data-ttu-id="5a9e6-224">Например, игра с платой holographic может визуализировать горизонтальные поверхности, идентифицированные как «таблицы», чтобы пользователь знал, где они должны работать.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-224">For example, a holographic board game could visualize the horizontal surfaces that it has identified as 'tables', so the user knows where they should go to interact.</span></span>

<span data-ttu-id="5a9e6-225">Визуализация поверхностей может быть удобным способом отображения ближайших к пользователю пространств, которые скрыты от представления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-225">Visualizing surfaces can be a useful way to show the user nearby spaces that are hidden from view.</span></span> <span data-ttu-id="5a9e6-226">Это позволяет предоставить пользователю доступ к его кухни (и всем содержащимся в нем голограммам) из своей гостиной.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-226">This could provide a way to give the user access to their kitchen (and all of its contained holograms) from their living room.</span></span>

<span data-ttu-id="5a9e6-227">Сетки Surface, предоставляемые пространственным сопоставлением, могут быть не в частности "чистыми".</span><span class="sxs-lookup"><span data-stu-id="5a9e6-227">The surface meshes provided by spatial mapping may not be particularly 'clean'.</span></span> <span data-ttu-id="5a9e6-228">Очень важно визуализировать их соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-228">It's important to visualize them appropriately.</span></span> <span data-ttu-id="5a9e6-229">Традиционные вычисления освещения могут выделять ошибки в нормалях в области визуального отприятного изображения, а «чистые» текстуры, проецированные на поверхность, могут помочь придать ей аккуратная внешний вид.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-229">Traditional lighting calculations may highlight errors in surface normals in a visually distracting manner, while 'clean' textures projected onto the surface may help to give it a tidier appearance.</span></span> <span data-ttu-id="5a9e6-230">Можно также выполнить [обработку сетки](spatial-mapping.md#mesh-processing) , чтобы улучшить свойства сетки перед отрисовкой поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-230">It's also possible to do [mesh processing](spatial-mapping.md#mesh-processing) to improve mesh properties, before the surfaces are rendered.</span></span>

> [!NOTE]
> <span data-ttu-id="5a9e6-231">В HoloLens 2 реализована новая [сцена для понимания среды выполнения](scene-understanding.md), которая предоставляет разработчикам смешанной реальности доступ к структурированному, высокоуровневой представлению среды, предназначенному для упрощения реализации размещения, перекрытия, физикы и навигации.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-231">HoloLens 2 implements a new [Scene Understanding Runtime](scene-understanding.md), that provides Mixed Reality developers with a structured, high-level environment representation designed to simplify the implementation of placement, occlusion, physics and navigation.</span></span>

## <a name="using-the-surface-observer"></a><span data-ttu-id="5a9e6-232">Использование наблюдателя Surface</span><span class="sxs-lookup"><span data-stu-id="5a9e6-232">Using The Surface Observer</span></span>

<span data-ttu-id="5a9e6-233">Отправной точкой для пространственного сопоставления является наблюдатель поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-233">The starting point for spatial mapping is the surface observer.</span></span> <span data-ttu-id="5a9e6-234">Процесс программы выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5a9e6-234">Program flow is as follows:</span></span>
* <span data-ttu-id="5a9e6-235">Создание объекта наблюдателя Surface</span><span class="sxs-lookup"><span data-stu-id="5a9e6-235">Create a surface observer object</span></span>
   * <span data-ttu-id="5a9e6-236">Укажите один или несколько пространственных томов, чтобы определить интересующие Вас регионы, в которых приложение хочет получить данные пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-236">Provide one or more spatial volumes, to define the regions of interest in which the application wishes to receive spatial mapping data.</span></span> <span data-ttu-id="5a9e6-237">Пространственный том — это просто фигура, определяющая область пространства, например сферу или поле.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-237">A spatial volume is simply a shape defining a region of space, such as a sphere or a box.</span></span>
   * <span data-ttu-id="5a9e6-238">Используйте пространственный том с заблокированной мировой системой координат, чтобы указать фиксированную область физического мира.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-238">Use a spatial volume with a world-locked spatial coordinate system to identify a fixed region of the physical world.</span></span>
   * <span data-ttu-id="5a9e6-239">Используйте пространственный том, изменяя каждый кадр с помощью системы пространственных координат, заблокированной телом, чтобы указать область пространства, которая перемещается (но не вращается) пользователем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-239">Use a spatial volume, updated each frame with a body-locked spatial coordinate system, to identify a region of space that moves (but doesn't rotate) with the user.</span></span>
   * <span data-ttu-id="5a9e6-240">Эти пространственные тома могут быть изменены позже в любое время, по мере изменения состояния приложения или пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-240">These spatial volumes may be changed later at any time, as the status of the application or the user changes.</span></span>
* <span data-ttu-id="5a9e6-241">Использование опроса или уведомления для получения сведений о пространственных поверхностях</span><span class="sxs-lookup"><span data-stu-id="5a9e6-241">Use polling or notification to retrieve information about spatial surfaces</span></span>
   * <span data-ttu-id="5a9e6-242">Вы можете опросить наблюдатель Surface в любое время, чтобы получить состояние пространственной поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-242">You may 'poll' the surface observer for spatial surface status at any time.</span></span> <span data-ttu-id="5a9e6-243">Вместо этого вы можете зарегистрироваться для события Change Surfaces наблюдателя, которое будет уведомлять приложение при изменении пространственных поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-243">Instead, you may register for the surface observer's 'surfaces changed' event, which will notify the application when spatial surfaces have changed.</span></span>
   * <span data-ttu-id="5a9e6-244">Для динамического пространственного тома, такого как View фрустум, или тома с блокировкой текста, приложения должны опрашивать изменения каждого кадра, задавая интересующую область, а затем получая текущий набор пространственных поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-244">For a dynamic spatial volume, such as the view frustum, or a body-locked volume, applications will need to poll for changes each frame by setting the region of interest and then obtaining the current set of spatial surfaces.</span></span>
   * <span data-ttu-id="5a9e6-245">Для статического тома, например Куба, охватывающего одну комнату, приложения могут зарегистрироваться для события Changed (поверхности), чтобы получать уведомления при изменении пространственных поверхностей внутри этого тома.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-245">For a static volume, such as a world-locked cube covering a single room, applications may register for the 'surfaces changed' event to be notified when spatial surfaces inside that volume may have changed.</span></span>
* <span data-ttu-id="5a9e6-246">Изменения поверхности процесса</span><span class="sxs-lookup"><span data-stu-id="5a9e6-246">Process surfaces changes</span></span>
   * <span data-ttu-id="5a9e6-247">Выполните итерацию указанного набора пространственных поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-247">Iterate the provided set of spatial surfaces.</span></span>
   * <span data-ttu-id="5a9e6-248">Классификация пространственных поверхностей как добавленных, измененных или удаленных.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-248">Classify spatial surfaces as added, changed, or removed.</span></span>
   * <span data-ttu-id="5a9e6-249">Для каждой добавленной или измененной пространственной поверхности при необходимости отправьте асинхронный запрос на получение обновленной сетки, представляющей текущее состояние поверхности, на нужном уровне детализации.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-249">For each added or changed spatial surface, if appropriate submit an asynchronous request to receive updated mesh representing the surface's current state at the desired level of detail.</span></span>
* <span data-ttu-id="5a9e6-250">Обработайте асинхронный запрос сетки (Дополнительные сведения см. в следующих разделах).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-250">Process the asynchronous mesh request (more details in following sections).</span></span>

## <a name="mesh-caching"></a><span data-ttu-id="5a9e6-251">Кэширование сетки</span><span class="sxs-lookup"><span data-stu-id="5a9e6-251">Mesh Caching</span></span>

<span data-ttu-id="5a9e6-252">Пространственные поверхности представлены с помощью плотных сеток треугольников.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-252">Spatial surfaces are represented by dense triangle meshes.</span></span> <span data-ttu-id="5a9e6-253">Хранение, отрисовка и обработка этих сеток могут потреблять значительные вычислительные ресурсы и хранилища.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-253">Storing, rendering, and processing these meshes can consume significant computational and storage resources.</span></span> <span data-ttu-id="5a9e6-254">Таким образом, каждое приложение должно применять схему кэширования сетки в соответствии с потребностями, чтобы максимально сокращать ресурсы, используемые для обработки и хранения данных сетки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-254">As such, each application should adopt a mesh caching scheme appropriate to its needs, to minimize the resources used for mesh processing and storage.</span></span> <span data-ttu-id="5a9e6-255">Эта схема должна определять, какие сети следует сохранить, а какие — отклонять, а также обновлять сетку для каждой пространственной поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-255">This scheme should determine which meshes to keep and which to discard, and when to update the mesh for each spatial surface.</span></span>

<span data-ttu-id="5a9e6-256">Многие из обсуждаемых рекомендаций непосредственно информируют о том, как приложение должно поподходить к кэшированию сетки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-256">Many of the considerations discussed there will directly inform how your application should approach mesh caching.</span></span> <span data-ttu-id="5a9e6-257">Следует учитывать, как пользователь перемещается через среду, какие поверхности требуются, когда будут отслеживаться различные поверхности и когда необходимо записать изменения в среде.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-257">You should consider how the user moves through the environment, which surfaces are needed, when different surfaces will be observed and when changes in the environment should be captured.</span></span>

<span data-ttu-id="5a9e6-258">При интерпретации события Changed, предоставленного наблюдателем Surface, логика базового кэширования сетки выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5a9e6-258">When interpreting the 'surfaces changed' event provided by the surface observer, the basic mesh caching logic is as follows:</span></span>
* <span data-ttu-id="5a9e6-259">Если приложение видит идентификатор пространственной поверхности, который ранее не встречался, он должен рассматривать его как новую пространственное пространство.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-259">If the application sees a spatial surface ID that it hasn't seen before, it should treat this as a new spatial surface.</span></span>
* <span data-ttu-id="5a9e6-260">Если приложение видит пространственной контакт с известным ИДЕНТИФИКАТОРом, но с новым временем обновления, оно должно рассматриваться как обновленная пространственное поверхность.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-260">If the application sees a spatial surface with a known ID but with a new update time, it should treat this as an updated spatial surface.</span></span>
* <span data-ttu-id="5a9e6-261">Если приложение больше не видит пространственной поверхности с известным ИДЕНТИФИКАТОРом, оно должно рассматривать его как удаленную пространственное поверхность.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-261">If the application no longer sees a spatial surface with a known ID, it should treat this as a removed spatial surface.</span></span>

<span data-ttu-id="5a9e6-262">Для каждого приложения необходимо выбрать следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-262">It's up to each application to then make the following choices:</span></span>
* <span data-ttu-id="5a9e6-263">Следует ли запрашивать сетку для новых пространственных поверхностей?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-263">For new spatial surfaces, should mesh be requested?</span></span>
   * <span data-ttu-id="5a9e6-264">Обычно сетка должна запрашиваться немедленно для новых пространственных поверхностей, что может предоставить пользователю полезные новые сведения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-264">Generally mesh should be requested immediately for new spatial surfaces, which may provide useful new information to the user.</span></span>
   * <span data-ttu-id="5a9e6-265">Однако новые пространственные области, расположенные рядом с пользователем и перед ними, должны иметь приоритет, и их сеть должна быть запрошена первыми.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-265">However, new spatial surfaces near and in front of the user should be given priority and their mesh should be requested first.</span></span>
   * <span data-ttu-id="5a9e6-266">Если новая сетка не нужна, то если, например, приложение постоянно или временно заблокировало свою модель среды, оно не должно запрашиваться.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-266">If the new mesh isn't needed, if for example the application has permanently or temporarily 'frozen' its model of the environment, then it shouldn't be requested.</span></span>
* <span data-ttu-id="5a9e6-267">Для обновленных пространственных поверхностей следует запрашивать сетку?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-267">For updated spatial surfaces, should mesh be requested?</span></span>
   * <span data-ttu-id="5a9e6-268">Перед обновленными пространственными областями рядом с пользователем должен быть указан приоритет, и их сеть должна быть запрошена первыми.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-268">Updated spatial surfaces near and in front of the user should be given priority and their mesh should be requested first.</span></span>
   * <span data-ttu-id="5a9e6-269">Также может быть целесообразно повысить приоритет для новых поверхностей, чем для обновленных поверхностей, особенно во время сканирования.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-269">It may also be appropriate to give higher priority to new surfaces than to updated surfaces, especially during the scanning experience.</span></span>
   * <span data-ttu-id="5a9e6-270">Чтобы ограничить затраты на обработку, приложениям может потребоваться регулировать скорость обработки обновлений на пространственные поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-270">To limit processing costs, applications may wish to throttle the rate at which they process updates to spatial surfaces.</span></span>
   * <span data-ttu-id="5a9e6-271">Можно определить, что изменения в пространственной поверхности являются небольшими, например если границы поверхности невелики, в этом случае обновление может быть недостаточно важным для обработки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-271">It may be possible to infer that changes to a spatial surface are minor, for example if the bounds of the surface are small, in which case the update may not be important enough to process.</span></span>
   * <span data-ttu-id="5a9e6-272">Обновления пространственных поверхностей за пределами текущего интересующего вас региона пользователя могут игнорироваться полностью, хотя в этом случае может быть более эффективным изменение пространственных ограничивающих томов, используемых наблюдателем Surface.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-272">Updates to spatial surfaces outside the current region of interest of the user may be ignored entirely, though in this case it may be more efficient to modify the spatial bounding volumes in use by the surface observer.</span></span>
* <span data-ttu-id="5a9e6-273">Для удаленных пространственных поверхностей следует ли отменять сетку?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-273">For removed spatial surfaces, should mesh be discarded?</span></span>
   * <span data-ttu-id="5a9e6-274">Обычно сетка следует отменять немедленно для удаленных пространственных поверхностей, чтобы перекрытияная голограмма оставалась правильной.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-274">Generally mesh should be discarded immediately for removed spatial surfaces, so that hologram occlusion remains correct.</span></span>
   * <span data-ttu-id="5a9e6-275">Тем не менее, если в приложении есть основания предполагать, что в ближайшее время будет появляться пространственное пространство (в зависимости от структуры взаимодействия с пользователем), это может оказаться более эффективным, чем отбросить ее и повторно создать позже.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-275">However, if the application has reason to believe that a spatial surface will reappear shortly (based upon the design of the user experience), then it may be more efficient to keep it than to discard its mesh and recreate it again later.</span></span>
   * <span data-ttu-id="5a9e6-276">Если приложение создает крупномасштабную модель среды пользователя, то, возможно, не хотите вообще отбросить все сетки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-276">If the application is building a large-scale model of the user's environment, then it may not wish to discard any meshes at all.</span></span> <span data-ttu-id="5a9e6-277">Тем не менее потребуется ограничить использование ресурсов, но, возможно, путем буферизации сеток на диск, так как пространственные поверхности исчезают.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-277">It will still need to limit resource usage though, possibly by spooling meshes to disk as spatial surfaces disappear.</span></span>
   * <span data-ttu-id="5a9e6-278">Некоторые сравнительно редкие события во время создания пространственной поверхности могут привести к замене пространственных поверхностей новыми пространственными областями в аналогичном расположении, но с разными идентификаторами.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-278">Some relatively rare events during spatial surface generation can cause spatial surfaces to be replaced by new spatial surfaces in a similar location but with different IDs.</span></span> <span data-ttu-id="5a9e6-279">Таким образом, приложения, которые не удаляют удаленную поверхность, должны отказаться от использования нескольких перекрывающихся сеток пространственных поверхностей, охватывающих одно и то же расположение.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-279">So, applications that choose not to discard a removed surface should take care not to end up with multiple highly overlapped spatial surfaces meshes covering the same location.</span></span>
* <span data-ttu-id="5a9e6-280">Следует ли отменять сетку для других пространственных поверхностей?</span><span class="sxs-lookup"><span data-stu-id="5a9e6-280">Should mesh be discarded for any other spatial surfaces?</span></span>
   * <span data-ttu-id="5a9e6-281">Даже при наличии пространственной поверхности, если она больше не полезна для работы пользователя, она должна быть отклонена.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-281">Even while a spatial surface exists, if it's no longer useful to the user's experience then it should be discarded.</span></span> <span data-ttu-id="5a9e6-282">Например, если приложение "заменяет" комнату на другой стороне двери с альтернативным виртуальным пространством, пространственные поверхности в этой комнате больше не важны.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-282">For example, if the application 'replaces' the room on the other side of a doorway with an alternate virtual space then the spatial surfaces in that room no longer matter.</span></span>

<span data-ttu-id="5a9e6-283">Ниже приведен пример стратегии кэширования сетки с использованием пространственного и временного гистерезиса.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-283">Here's an example mesh caching strategy, using spatial and temporal hysteresis:</span></span>
* <span data-ttu-id="5a9e6-284">Рассмотрим приложение, желающее использовать фрустумый пространственный том в форме, который следует за взглядом пользователя по мере того, как они выглядят и обходится.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-284">Consider an application that wishes to use a frustum-shaped spatial volume of interest that follows the user's gaze as they look around and walk around.</span></span>
* <span data-ttu-id="5a9e6-285">Пространственный Surface может быть временно удалена из этого тома, просто потому, что пользователь выходит за пределы поверхности или с него... только для обратного просмотра или перехода чуть позже.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-285">A spatial surface may disappear temporarily from this volume simply because the user looks away from the surface or steps further away from it... only to look back or moves closer again a moment later.</span></span> <span data-ttu-id="5a9e6-286">В этом случае отмена и повторное создание сетки для этой поверхности представляет множество избыточных процессов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-286">In this case, discarding and re-creating the mesh for this surface represents many redundant processings.</span></span>
* <span data-ttu-id="5a9e6-287">Чтобы сократить число обработанных изменений, приложение использует две пространственные наблюдатели, которые находятся внутри другого.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-287">To reduce the number of changes processed, the application uses two spatial surface observers, one contained within the other.</span></span> <span data-ttu-id="5a9e6-288">Больший объем представляет собой сферу, который следует за неактивностью пользователя. он перемещается только при необходимости, чтобы гарантировать, что его центр находится в пределах 2,0 метров пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-288">The larger volume is spherical and follows the user 'lazily'; it only moves when necessary to ensure that its center is within 2.0 meters of the user.</span></span>
* <span data-ttu-id="5a9e6-289">Новые и обновленные сетки пространственных поверхностей всегда обрабатываются с помощью меньшего внутреннего наблюдателя поверхности, но сетки кэшируются до тех пор, пока они не исчезнут из большего внешнего наблюдателя поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-289">New and updated spatial surface meshes are always processed from the smaller inner surface observer, but meshes are cached until they disappear from the larger outer surface observer.</span></span> <span data-ttu-id="5a9e6-290">Это позволяет приложению избежать обработки большого количества избыточных изменений из-за перемещения локальных пользователей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-290">This allows the application to avoid processing many redundant changes because of local user movement.</span></span>
* <span data-ttu-id="5a9e6-291">Так как пространственное пространство может также исчезнуть временно из-за потери данных отслеживания, приложение также откладывает отмену удаленных пространственных поверхностей во время отслеживания потерь.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-291">Since a spatial surface may also disappear temporarily because of tracking loss, the application also defers discarding removed spatial surfaces during tracking loss.</span></span>
* <span data-ttu-id="5a9e6-292">Как правило, приложение должно оценивать компромисс между сокращением обработки обновлений и увеличением объема используемой памяти для определения идеальной стратегии кэширования.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-292">In general, an application should evaluate the tradeoff between reduced update processing and increased memory usage to determine its ideal caching strategy.</span></span>

## <a name="rendering"></a><span data-ttu-id="5a9e6-293">Отрисовка</span><span class="sxs-lookup"><span data-stu-id="5a9e6-293">Rendering</span></span>

<span data-ttu-id="5a9e6-294">Существуют три основных способа, в которых сетки пространственного сопоставления обычно используются для отрисовки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-294">There are three primary ways in which spatial mapping meshes tend to be used for rendering:</span></span>
* <span data-ttu-id="5a9e6-295">Для визуализации поверхности</span><span class="sxs-lookup"><span data-stu-id="5a9e6-295">For surface visualization</span></span>
   * <span data-ttu-id="5a9e6-296">Часто бывает удобно визуализировать пространственные поверхности напрямую.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-296">It's often useful to visualize spatial surfaces directly.</span></span> <span data-ttu-id="5a9e6-297">Например, приведение "Shadows" от объектов к пространственным областям может предоставить пользователю полезные визуальные отзывы, когда они помещают на поверхности самые голограммы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-297">For example, casting 'shadows' from objects onto spatial surfaces can provide helpful visual feedback to the user while they're placing holograms on surfaces.</span></span>
   * <span data-ttu-id="5a9e6-298">Следует помнить, что пространственные сети отличаются от типов сеток, которые может создать трехмерный исполнитель.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-298">One thing to bear in mind is that spatial meshes are different to the kind of meshes that a 3D artist might create.</span></span> <span data-ttu-id="5a9e6-299">Топология треугольника не будет "чистым" в качестве топологии, созданной человеком, и сеть будет испытывать [различные ошибки](spatial-mapping.md#what-influences-spatial-mapping-quality).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-299">The triangle topology won't be as 'clean' as human-created topology, and the mesh will suffer from [various errors](spatial-mapping.md#what-influences-spatial-mapping-quality).</span></span>
   * <span data-ttu-id="5a9e6-300">Чтобы создать привлекательный визуальный Aesthetic, вам может потребоваться выполнить некоторую [обработку сетки](spatial-mapping.md#mesh-processing), например, чтобы заполнить отверстия или плавные нормали к поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-300">To create a pleasing visual aesthetic, you may want to do some [mesh processing](spatial-mapping.md#mesh-processing), for example to fill holes or smooth surface normals.</span></span> <span data-ttu-id="5a9e6-301">Вы также можете использовать шейдер для проецирования в сеть текстур, разработанных на основе исполнителя, а не напрямую визуализировать топологию сетки и нормали.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-301">You may also wish to use a shader to project artist-designed textures onto your mesh instead of directly visualizing mesh topology and normals.</span></span>
* <span data-ttu-id="5a9e6-302">Для окклудингной голограммы за реальными областями</span><span class="sxs-lookup"><span data-stu-id="5a9e6-302">For occluding holograms behind real-world surfaces</span></span>
   * <span data-ttu-id="5a9e6-303">Пространственные поверхности можно подготавливать к просмотру только по глубине, что влияет только на [буфер глубины](/windows/win32/direct3d9/depth-buffers) и не влияет на целевые объекты рендеринга цвета.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-303">Spatial surfaces can be rendered in a depth-only pass, which only affects the [depth buffer](/windows/win32/direct3d9/depth-buffers) and doesn't affect color render targets.</span></span>
   * <span data-ttu-id="5a9e6-304">Это окклуде буфер глубины для последующего отображения голограмм, расположенных за пространственными областями.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-304">This primes the depth buffer to occlude subsequently rendered holograms behind spatial surfaces.</span></span> <span data-ttu-id="5a9e6-305">Точная перекрытияа голограмм повышает смысл того, что голограммы действительно существуют в физическом пространстве пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-305">Accurate occlusion of holograms enhances the sense that holograms really exist within the user's physical space.</span></span>
   * <span data-ttu-id="5a9e6-306">Чтобы включить визуализацию только по глубине, обновите состояние смешения, чтобы установить [рендертаржетвритемаск](/windows/win32/api/d3d11_1/ns-d3d11_1-d3d11_render_target_blend_desc1) в значение 0 для всех целевых объектов рендеринга цвета.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-306">To enable depth-only rendering, update your blend state to set the [RenderTargetWriteMask](/windows/win32/api/d3d11_1/ns-d3d11_1-d3d11_render_target_blend_desc1) to zero for all color render targets.</span></span>
* <span data-ttu-id="5a9e6-307">Изменение внешнего вида голограмм, перекрыто на реальных поверхностях</span><span class="sxs-lookup"><span data-stu-id="5a9e6-307">For modifying the appearance of holograms occluded by real-world surfaces</span></span>
   * <span data-ttu-id="5a9e6-308">Обычно визуализированная геометрия скрыта, когда она перекрыто.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-308">Normally rendered geometry is hidden when it's occluded.</span></span> <span data-ttu-id="5a9e6-309">Это достигается путем установки функции глубины в [состоянии шаблона глубины](/windows/win32/api/d3d11/ns-d3d11-d3d11_depth_stencil_desc) в значение "меньше или равно", что приводит к тому, что геометрия будет видна только в том месте, где она находится **ближе** к камере, чем у всех ранее визуализированных геометрических объектов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-309">This is achieved by setting the depth function in your [depth-stencil state](/windows/win32/api/d3d11/ns-d3d11-d3d11_depth_stencil_desc) to "less than or equal", which causes geometry to be visible only where it's **closer** to the camera than all previously rendered geometry.</span></span>
   * <span data-ttu-id="5a9e6-310">Однако может оказаться полезным, чтобы определенный геометрический объект оставался видимым даже в том случае, если он перекрыто, и изменить его внешний вид при перекрыто как способ предоставления визуальной обратной связи с пользователем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-310">However, it may be useful to keep certain geometry visible even when it's occluded, and to modify its appearance when occluded as a way of providing visual feedback to the user.</span></span> <span data-ttu-id="5a9e6-311">Например, это позволяет приложению отображать расположение объекта, в то время как оно ясно, что находится за реальной поверхностью.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-311">For example, this allows the application to show the user the location of an object while making it clear that is behind a real-world surface.</span></span>
   * <span data-ttu-id="5a9e6-312">Для этого создайте геометрию во второй раз с помощью другого шейдера, который создает требуемый внешний вид "перекрыто".</span><span class="sxs-lookup"><span data-stu-id="5a9e6-312">To achieve this, render the geometry a second time with a different shader that creates the desired 'occluded' appearance.</span></span> <span data-ttu-id="5a9e6-313">Прежде чем отображать геометрию во второй раз, внесите два изменения в [состояние шаблона глубины](/windows/win32/api/d3d11/ns-d3d11-d3d11_depth_stencil_desc).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-313">Before rendering the geometry for the second time, make two changes to your [depth-stencil state](/windows/win32/api/d3d11/ns-d3d11-d3d11_depth_stencil_desc).</span></span> <span data-ttu-id="5a9e6-314">Сначала задайте для функции глубины значение "больше или равно", чтобы эта геометрия была видима только в том случае, если она находится **дальше** от камеры, чем у всех ранее визуализированных геометрических объектов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-314">First, set the depth function to "greater than or equal" so that the geometry will be visible only where it's **further** from the camera than all previously rendered geometry.</span></span> <span data-ttu-id="5a9e6-315">Во-вторых, установите Депсвритемаск равным нулю, чтобы буфер глубины не изменялся (буфер глубины должен по-прежнему представлять глубину геометрии, **ближайшей** к камере).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-315">Second, set the DepthWriteMask to zero, so that the depth buffer won't be modified (the depth buffer should continue to represent the depth of the geometry **closest** to the camera).</span></span>

<span data-ttu-id="5a9e6-316">[Производительность](../develop/platform-capabilities-and-apis/understanding-performance-for-mixed-reality.md) является важной проблемой при отрисовке сеток пространственных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-316">[Performance](../develop/platform-capabilities-and-apis/understanding-performance-for-mixed-reality.md) is an important concern when rendering spatial mapping meshes.</span></span> <span data-ttu-id="5a9e6-317">Ниже приведены некоторые методы повышения производительности, связанные с отрисовкой сеток пространственных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-317">Here are some rendering performance techniques specific to rendering spatial mapping meshes:</span></span>
* <span data-ttu-id="5a9e6-318">Настройка плотности треугольников</span><span class="sxs-lookup"><span data-stu-id="5a9e6-318">Adjust triangle density</span></span>
   * <span data-ttu-id="5a9e6-319">При запросе сеток пространственных поверхностей от наблюдателя Surface запросите наименьшую плотность сетки треугольников, которая будет достаточной для ваших потребностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-319">When requesting spatial surface meshes from your surface observer, request the lowest density of triangle meshes that will suffice for your needs.</span></span>
   * <span data-ttu-id="5a9e6-320">Может иметь смысл изменить плотность треугольника на поверхности с помощью поверхности, в зависимости от расстояния поверхности от пользователя и его релевантности для взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-320">It may make sense to vary triangle density on a surface by surface basis, depending on the surface's distance from the user, and its relevance to the user experience.</span></span>
   * <span data-ttu-id="5a9e6-321">Уменьшение числа треугольников сокращает потребление памяти и затраты на обработку вершин на GPU, но не влияет на затраты на обработку пикселов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-321">Reducing triangle counts will reduce memory usage and vertex processing costs on the GPU, though it won't affect pixel processing costs.</span></span>
* <span data-ttu-id="5a9e6-322">Использовать отбор фрустум</span><span class="sxs-lookup"><span data-stu-id="5a9e6-322">Use frustum culling</span></span>
   * <span data-ttu-id="5a9e6-323">При исфрустуме не удается увидеть графические объекты, так как они выходят за пределы текущего отображаемого фрустум.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-323">Frustum culling skips drawing objects that cannot be seen because they are outside the current display frustum.</span></span> <span data-ttu-id="5a9e6-324">Это сокращает затраты на обработку ЦП и GPU.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-324">This reduces both CPU and GPU processing costs.</span></span>
   * <span data-ttu-id="5a9e6-325">Так как отбор выполняется для отдельных сеток, а пространственные поверхности могут быть большими, разбиение каждой сетки пространственных областей на небольшие фрагменты может привести к более эффективному исследовательному применению (в этом случае выводятся меньшее количество треугольников).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-325">Since culling is performed on a per-mesh basis and spatial surfaces can be large, breaking each spatial surface mesh into smaller chunks may result in more efficient culling (in that fewer offscreen triangles are rendered).</span></span> <span data-ttu-id="5a9e6-326">Однако существует компромисс. чем больше сеток у вас есть, тем больше придется нарисовать вызовы, что может увеличить затраты на ресурсы ЦП.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-326">There's a tradeoff, however; the more meshes you have, the more draw calls you must make, which can increase CPU costs.</span></span> <span data-ttu-id="5a9e6-327">В экстремальном случае фрустумные вычисления могут даже иметь измеряемую стоимость ЦП.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-327">In an extreme case, the frustum culling calculations themselves could even have a measurable CPU cost.</span></span>
* <span data-ttu-id="5a9e6-328">Настройка порядка отрисовки</span><span class="sxs-lookup"><span data-stu-id="5a9e6-328">Adjust rendering order</span></span>
   * <span data-ttu-id="5a9e6-329">Пространственные поверхности обычно имеют большой размер, так как они представляют всю окружающую среду пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-329">Spatial surfaces tend to be large, because they represent the user's entire environment surrounding them.</span></span> <span data-ttu-id="5a9e6-330">Затраты на обработку пикселей в GPU могут быть большими, особенно в случаях, когда имеется несколько уровней видимой геометрии (включая пространственные поверхности и другие голограммы).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-330">Pixel processing costs on the GPU can be high, especially in cases where there's more than one layer of visible geometry (including both spatial surfaces and other holograms).</span></span> <span data-ttu-id="5a9e6-331">В этом случае слой, ближайший к пользователю, будет окклудинг все слои, так что все время GPU, потраченное на отрисовку более удаленных слоев, будет пролишним.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-331">In this case, the layer nearest to the user will be occluding any layers further away, so any GPU time spent rendering those more distant layers is wasted.</span></span>
   * <span data-ttu-id="5a9e6-332">Чтобы уменьшить эту избыточную работу на GPU, она помогает визуализировать непрозрачные поверхности в порядке «от начала до конца» (ближе к первой, более отдаленным).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-332">To reduce this redundant work on the GPU, it helps to render opaque surfaces in front-to-back order (closer ones first, more distant ones last).</span></span> <span data-ttu-id="5a9e6-333">По "непрозрачному" мы имеем в виду поверхности, для которых для параметра Депсвритемаск задано значение One в вашем [состоянии](/windows/win32/api/d3d11/ns-d3d11-d3d11_depth_stencil_desc).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-333">By 'opaque' we mean surfaces for which the DepthWriteMask is set to one in your [depth-stencil state](/windows/win32/api/d3d11/ns-d3d11-d3d11_depth_stencil_desc).</span></span> <span data-ttu-id="5a9e6-334">При отрисовке ближайших поверхностей они покажут буфер глубины, чтобы более отдаленные поверхности эффективно пропускались процессором пикселей в GPU.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-334">When the nearest surfaces are rendered, they'll prime the depth buffer so that more distant surfaces are efficiently skipped by the pixel processor on the GPU.</span></span>

## <a name="mesh-processing"></a><span data-ttu-id="5a9e6-335">Обработка сетки</span><span class="sxs-lookup"><span data-stu-id="5a9e6-335">Mesh Processing</span></span>

<span data-ttu-id="5a9e6-336">Приложение может захотеть выполнять [различные операции](spatial-mapping.md#mesh-processing) с сетчатыми сетками в соответствии с потребностями.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-336">An application may want to do [various operations](spatial-mapping.md#mesh-processing) on spatial surface meshes to suit its needs.</span></span> <span data-ttu-id="5a9e6-337">Данные индекса и вершин, предоставляемые с каждой сеткой пространственных поверхностей, используют тот же привычный макет, что [и буферы вершин и индексов](/windows/win32/direct3d9/rendering-from-vertex-and-index-buffers) , которые используются для отрисовки сеток треугольников во всех современных API-интерфейсах отрисовки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-337">The index and vertex data provided with each spatial surface mesh uses the same familiar layout as the [vertex and index buffers](/windows/win32/direct3d9/rendering-from-vertex-and-index-buffers) that are used for rendering triangle meshes in all modern rendering APIs.</span></span> <span data-ttu-id="5a9e6-338">Однако один ключевой факт, который следует учитывать, заключается в том, что треугольники пространственного сопоставления имеют **порядок поворота на передний план по часовой стрелке**.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-338">However, one key fact to be aware of is that spatial mapping triangles have a **front-clockwise winding order**.</span></span> <span data-ttu-id="5a9e6-339">Каждый треугольник представляется тремя индексами вершин в буфере индекса сетки, и эти индексы определяют вершины треугольника в порядке по **часовой стрелке** , при просмотре треугольника с **передней** стороны.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-339">Each triangle is represented by three vertex indices in the mesh's index buffer and these indices will identify the triangle's vertices in a **clockwise** order, when the triangle is viewed from the **front** side.</span></span> <span data-ttu-id="5a9e6-340">Передняя сторона (или снаружи) сеток пространственных областей соответствует, как и на лицевой стороне (видимой) стороны реальных миров.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-340">The front side (or outside) of spatial surface meshes corresponds as you would expect to the front (visible) side of real world surfaces.</span></span>

<span data-ttu-id="5a9e6-341">Приложения должны выполнять только упрощение сетки, если грубая плотность треугольника, предоставляемая наблюдателем Surface, по-прежнему недостаточна. Эта работа является ресурсоемкой и уже выполняется средой выполнения для создания различных предоставленных уровней детализации.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-341">Applications should only do mesh simplification if the coarsest triangle density provided by the surface observer is still insufficiently coarse - this work is computationally expensive and already being performed by the runtime to generate the various provided levels of detail.</span></span>

<span data-ttu-id="5a9e6-342">Так как каждый наблюдатель поверхности может предоставлять несколько неподключенных пространственных поверхностей, некоторым приложениям может потребоваться обрезать эти сетки пространственных областей, а затем Зиппер их вместе.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-342">Because each surface observer can provide multiple unconnected spatial surfaces, some applications may wish to clip these spatial surface meshes against each other, then zipper them together.</span></span> <span data-ttu-id="5a9e6-343">Как правило, шаг обрезки является обязательным, поскольку соседние сетки пространственных областей часто перекрываются немного.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-343">In general, the clipping step is required, as nearby spatial surface meshes often overlap slightly.</span></span>

## <a name="raycasting-and-collision"></a><span data-ttu-id="5a9e6-344">Райкастинг и конфликты</span><span class="sxs-lookup"><span data-stu-id="5a9e6-344">Raycasting and Collision</span></span>

<span data-ttu-id="5a9e6-345">Чтобы API-интерфейс физикы (например, [Хавок](https://www.havok.com/)) предоставил приложению функции райкастинг и конфликтов для пространственных поверхностей, приложение должно предоставить физические поверхности для API-интерфейса физикы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-345">In order for a physics API (such as [Havok](https://www.havok.com/)) to provide an application with raycasting and collision functionality for spatial surfaces, the application must provide spatial surface meshes to the physics API.</span></span> <span data-ttu-id="5a9e6-346">Сетки, используемые для физики, часто имеют следующие свойства:</span><span class="sxs-lookup"><span data-stu-id="5a9e6-346">Meshes used for physics often have the following properties:</span></span>
* <span data-ttu-id="5a9e6-347">Они содержат только небольшое число треугольников.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-347">They contain only small numbers of triangles.</span></span> <span data-ttu-id="5a9e6-348">Операции физикы потребляют больше вычислений, чем операции отрисовки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-348">Physics operations are more computationally intensive than rendering operations.</span></span>
* <span data-ttu-id="5a9e6-349">Они "ограничены" водами ".</span><span class="sxs-lookup"><span data-stu-id="5a9e6-349">They're 'water-tight'.</span></span> <span data-ttu-id="5a9e6-350">Поверхности, которые должны быть сплошными, не должны иметь небольшие бреши; даже отверстия слишком малы, чтобы быть видимыми, могут вызвать проблемы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-350">Surfaces intended to be solid shouldn't have small holes in them; even holes too small to be visible can cause problems.</span></span>
* <span data-ttu-id="5a9e6-351">Они преобразуются в выпуклой хуллс.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-351">They're converted into convex hulls.</span></span> <span data-ttu-id="5a9e6-352">Выпуклой хуллс имеет несколько многоугольников и не имеет свободных отверстий, и они гораздо более эффективны для обработки, чем необработанные сетки треугольников.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-352">Convex hulls have few polygons and are free of holes, and they're much more computationally efficient to process than raw triangle meshes.</span></span>

<span data-ttu-id="5a9e6-353">При выполнении райкастс с пространственными областями следует помнить, что эти поверхности часто сложны и нередко изменяют фигуры, как и на столе!</span><span class="sxs-lookup"><span data-stu-id="5a9e6-353">When doing raycasts against spatial surfaces, bear in mind that these surfaces are often complex, cluttered shapes full of messy little details - just like your desk!</span></span> <span data-ttu-id="5a9e6-354">Это означает, что одному райкасту часто недостаточно, чтобы предоставить достаточно информации о форме поверхности и форме пустого пространства рядом с ним.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-354">This means that a single raycast is often insufficient to give you enough information about the shape of the surface and the shape of the empty space near it.</span></span> <span data-ttu-id="5a9e6-355">Обычно рекомендуется выполнять много райкастс в небольшой области и использовать статистические результаты для получения более надежного понимания поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-355">It's usually a good idea to do many raycasts within a small area and to use the aggregate results to derive a more reliable understanding of the surface.</span></span> <span data-ttu-id="5a9e6-356">Например, при использовании среднего значения, равного 10 райкастс, для размещения голограммы на поверхности будет использоваться гораздо более гладкий и менее "неограниченный" результат, использующий только один райкаст.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-356">For example, using the average of 10 raycasts to guide hologram placement on a surface will yield a far smoother and less 'jittery' result that using just a single raycast.</span></span>

<span data-ttu-id="5a9e6-357">Однако помните, что каждый райкаст может иметь высокую вычислительную стоимость.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-357">However, bear in mind that each raycast can have a high computational cost.</span></span> <span data-ttu-id="5a9e6-358">В зависимости от сценария использования следует выплатить вычислительную стоимость дополнительного райкастс (для каждого кадра) относительно вычислительной стоимости [обработки сетки](spatial-mapping.md#mesh-processing) , чтобы сгладить и удалять отверстия на пространственных поверхностях (выполняется при обновлении пространственных сеток).</span><span class="sxs-lookup"><span data-stu-id="5a9e6-358">Depending on your usage scenario, you should trade off the computational cost of extra raycasts (done every frame) against the computational cost of [mesh processing](spatial-mapping.md#mesh-processing) to smooth and remove holes in spatial surfaces (done when spatial meshes are updated).</span></span>

## <a name="the-environment-scanning-experience"></a><span data-ttu-id="5a9e6-359">Процесс сканирования среды</span><span class="sxs-lookup"><span data-stu-id="5a9e6-359">The environment scanning experience</span></span>

<span data-ttu-id="5a9e6-360">Каждое приложение, использующее пространственное сопоставление, должно использовать проверку. процесс, с помощью которого приложение помогает пользователю проверять поверхности, необходимые для правильной работы приложения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-360">Each application that uses spatial mapping should consider providing a 'scanning experience'; the process through which the application guides the user to scan surfaces that are necessary for the application to function correctly.</span></span>

<span data-ttu-id="5a9e6-361">![Пример сканирования](images/sr-mixedworld-140429-8pm-00068-1000px.png)</span><span class="sxs-lookup"><span data-stu-id="5a9e6-361">![Example of scanning](images/sr-mixedworld-140429-8pm-00068-1000px.png)</span></span><br>
<span data-ttu-id="5a9e6-362">*Пример сканирования*</span><span class="sxs-lookup"><span data-stu-id="5a9e6-362">*Example of scanning*</span></span>

<span data-ttu-id="5a9e6-363">Характер этого процесса сканирования может сильно различаться в зависимости от потребностей конкретного приложения, но при проектировании необходимо иметь два основных принципа.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-363">The nature of this scanning experience can vary greatly depending upon each application's needs, but two main principles should guide its design.</span></span>

<span data-ttu-id="5a9e6-364">Во-первых, необходимо **четко понять, что связь с пользователем является основной задачей**.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-364">Firstly, **clear communication with the user is the primary concern**.</span></span> <span data-ttu-id="5a9e6-365">Пользователь всегда должен знать, выполняются ли требования приложения.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-365">The user should always be aware of whether the application's requirements are being met.</span></span> <span data-ttu-id="5a9e6-366">Если они не соблюдаются, необходимо сразу же очистить пользователя, почему это так, и они должны быстро принять соответствующие меры.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-366">When they aren't being met, it should be immediately clear to the user why this is so and they should be quickly led to take the appropriate action.</span></span>

<span data-ttu-id="5a9e6-367">Во-вторых, **приложения должны попытаться обеспечить баланс между эффективностью и надежностью**.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-367">Secondly, **applications should attempt to strike a balance between efficiency and reliability**.</span></span> <span data-ttu-id="5a9e6-368">Если это возможно, приложения должны автоматически анализировать пространственные данные **сопоставления, чтобы** сэкономить время пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-368">When it's possible to do so **reliably**, applications should automatically analyze spatial mapping data to save the user time.</span></span> <span data-ttu-id="5a9e6-369">Если это невозможно, приложения должны позволить пользователю быстро предоставить приложению дополнительные сведения, необходимые для этого.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-369">When it isn't possible to do so reliably, applications should instead enable the user to quickly provide the application with the additional information it requires.</span></span>

<span data-ttu-id="5a9e6-370">Чтобы помочь вам в проектировании правильного процесса сканирования, определите, какие из следующих возможностей применимы к вашему приложению:</span><span class="sxs-lookup"><span data-stu-id="5a9e6-370">To help design the right scanning experience, consider which of the following possibilities are applicable to your application:</span></span>

* <span data-ttu-id="5a9e6-371">**Нет опыта сканирования**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-371">**No scanning experience**</span></span>
   * <span data-ttu-id="5a9e6-372">Приложение может работать идеально без пошагового сканирования. Он узнает о поверхностях, которые наблюдаются в процессе естественного перемещения пользователей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-372">An application may function perfectly without any guided scanning experience; it will learn about surfaces that are observed in the course of natural user movement.</span></span>
   * <span data-ttu-id="5a9e6-373">Например, приложение, которое позволяет пользователю рисовать на поверхностях с помощью holographic и распылителя, требует знания только тех поверхностей, которые в настоящее время видны пользователю.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-373">For example, an application that lets the user draw on surfaces with holographic spray paint requires knowledge only of the surfaces currently visible to the user.</span></span>
   * <span data-ttu-id="5a9e6-374">Среда может быть проверена, если это одна из них, в которой пользователь уже тратит много времени на использование HoloLens.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-374">The environment may be scanned already if it's one in which the user has already spent lots of time using the HoloLens.</span></span>
   * <span data-ttu-id="5a9e6-375">Следует иметь в виду, что камера, используемая пространственным сопоставлением, может видеть 3,1 м перед пользователем, поэтому при пространственном сопоставлении не будет сведений о более удаленных поверхностях, если пользователь не насмотрел их на более близком расстоянии в прошлом.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-375">Bear in mind however that the camera used by spatial mapping can only see 3.1 m in front of the user, so spatial mapping won't know about any more distant surfaces unless the user has observed them from a closer distance in the past.</span></span>
   * <span data-ttu-id="5a9e6-376">Так что пользователь понимает, какие поверхности были проверены, приложение должно предоставить визуальный отзыв об этом эффекте, например приведение виртуальных теней на отсканированные поверхности, может помочь пользователю разместить голограммы на этих поверхностях.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-376">So the user understands which surfaces have been scanned, the application should provide visual feedback to this effect, for example casting virtual shadows onto scanned surfaces may help the user place holograms on those surfaces.</span></span>
   * <span data-ttu-id="5a9e6-377">В этом случае ограничивающие тома наблюдателя-поверхности должны обновляться в каждом кадре в [пространственной системе координат](coordinate-systems.md), так что они следуют за пользователем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-377">For this case, the spatial surface observer's bounding volumes should be updated each frame to a body-locked [spatial coordinate system](coordinate-systems.md), so that they follow the user.</span></span>

* <span data-ttu-id="5a9e6-378">**Найти подходящее расположение**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-378">**Find a suitable location**</span></span>
   * <span data-ttu-id="5a9e6-379">Приложение может быть предназначено для использования в расположении с конкретными требованиями.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-379">An application may be designed for use in a location with specific requirements.</span></span>
   * <span data-ttu-id="5a9e6-380">Например, приложению может потребоваться пустая область вокруг пользователя, чтобы они могли безопасно практиковаться в кунг-э.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-380">For example, the application may require an empty area around the user so they can safely practice holographic kung-fu.</span></span>
   * <span data-ttu-id="5a9e6-381">Приложения должны заранее взаимодействовать с любыми конкретными требованиями и подключаться к ним с четкими визуальными отзывами.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-381">Applications should communicate any specific requirements to the user up-front, and reinforce them with clear visual feedback.</span></span>
   * <span data-ttu-id="5a9e6-382">В этом примере приложение должно визуализировать экстент необходимой пустой области и визуально выделить присутствие любых нежелательных объектов в этой зоне.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-382">In this example, the application should visualize the extent of the required empty area and visually highlight the presence of any undesired objects within this zone.</span></span>
   * <span data-ttu-id="5a9e6-383">В этом случае ограничивающие тома наблюдателя Surface должны использовать заблокированную в мире [систему пространственных координат](coordinate-systems.md) в выбранном расположении.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-383">For this case, the spatial surface observer's bounding volumes should use a world-locked [spatial coordinate system](coordinate-systems.md) in the chosen location.</span></span>

* <span data-ttu-id="5a9e6-384">**Поиск подходящей конфигурации поверхностей**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-384">**Find a suitable configuration of surfaces**</span></span>
   * <span data-ttu-id="5a9e6-385">Для приложения может потребоваться определенная конфигурация поверхностей, например две крупные, плоские и противоположные стены, чтобы создать более holographic-зал зеркал.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-385">An application may require a specific configuration of surfaces, for example two large, flat, opposing walls to create a holographic hall of mirrors.</span></span>
   * <span data-ttu-id="5a9e6-386">В таких случаях приложению потребуется проанализировать поверхности, предоставляемые пространственным сопоставлением для определения подходящих поверхностей, и направить пользователя к ним.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-386">In such cases, the application will need to analyze the surfaces provided by spatial mapping to detect suitable surfaces, and direct the user toward them.</span></span>
   * <span data-ttu-id="5a9e6-387">Если анализ поверхности приложения не является надежным, у пользователя должен быть параметр отката.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-387">The user should have a fallback option if the application's surface analysis isn't reliable.</span></span> <span data-ttu-id="5a9e6-388">Например, если приложение неправильно определяет двери как плоскую стену, пользователю требуется простой способ исправить эту ошибку.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-388">For example, if the application incorrectly identifies a doorway as a flat wall, the user needs a simple way to correct this error.</span></span>

* <span data-ttu-id="5a9e6-389">**Сканирование части окружения**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-389">**Scan part of the environment**</span></span>
   * <span data-ttu-id="5a9e6-390">Приложение может захватывать только часть среды, которая направляется пользователем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-390">An application may wish to only capture part of the environment, as directed by the user.</span></span>
   * <span data-ttu-id="5a9e6-391">Например, приложение сканирует часть комнаты, чтобы пользователь мог разместить holographic-классифицированную рекламу для мебели, которую планируется продать.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-391">For example, the application scans part of a room so the user may post a holographic classified ad for furniture they wish to sell.</span></span>
   * <span data-ttu-id="5a9e6-392">В этом случае приложение должно записывать данные пространственного сопоставления в регионах, наблюдаемых пользователем во время проверки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-392">In this case, the application should capture spatial mapping data within the regions observed by the user during their scan.</span></span>

* <span data-ttu-id="5a9e6-393">**Сканирование всей комнаты**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-393">**Scan the whole room**</span></span>
   * <span data-ttu-id="5a9e6-394">Приложению может потребоваться просмотр всех поверхностей в текущем помещении, включая пользователей, которые находятся за ним.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-394">An application may require a scan of all of the surfaces in the current room, including those behind the user.</span></span>
   * <span data-ttu-id="5a9e6-395">Например, игра может поставить пользователя в роль Гулливер в осаде от сотен маленьких Лиллипутианс подхода из всех направлений.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-395">For example, a game may put the user in the role of Gulliver, under siege from hundreds of tiny Lilliputians approaching from all directions.</span></span>
   * <span data-ttu-id="5a9e6-396">В таких случаях приложению необходимо определить, сколько поверхностей в текущей комнате уже было проверено, и направить пользователю взгляд на значительные промежутки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-396">In such cases, the application will need to determine how many of the surfaces in the current room have already been scanned, and direct the user's gaze to fill in significant gaps.</span></span>
   * <span data-ttu-id="5a9e6-397">Ключом к этому процессу является предоставление визуальной обратной связи, которая упрощает для пользователя, какие поверхности еще не были проверены.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-397">The key to this process is providing visual feedback that makes it clear to the user which surfaces haven't yet been scanned.</span></span> <span data-ttu-id="5a9e6-398">Приложение может, например, использовать [туман на основе расстояния](/windows/win32/direct3d9/fog-formulas) для визуального выделения областей, не охваченных областями пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-398">The application could, for example,  use [distance-based fog](/windows/win32/direct3d9/fog-formulas) to visually highlight regions that aren't covered by spatial mapping surfaces.</span></span>

* <span data-ttu-id="5a9e6-399">**Создание исходного моментального снимка окружения**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-399">**Take an initial snapshot of the environment**</span></span>
   * <span data-ttu-id="5a9e6-400">Приложению может потребоваться игнорировать все изменения в среде после получения исходного снимка.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-400">An application may wish to ignore all changes in the environment after taking an initial 'snapshot'.</span></span>
   * <span data-ttu-id="5a9e6-401">Это может быть полезно во избежание нарушений данных, созданных пользователем, которые тесно связаны с первоначальным состоянием среды.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-401">This may be appropriate to avoid disruption of user-created data that is tightly coupled to the initial state of the environment.</span></span>
   * <span data-ttu-id="5a9e6-402">В этом случае приложение должно создать копию данных пространственного сопоставления в исходном состоянии после завершения проверки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-402">In this case, the application should make a copy of the spatial mapping data in its initial state once the scan is complete.</span></span>
   * <span data-ttu-id="5a9e6-403">Приложения должны продолжать получать обновления данных пространственного сопоставления, если они все еще должны быть правильно перекрыто средой.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-403">Applications should continue receiving updates to spatial mapping data if holograms are still to be correctly occluded by the environment.</span></span>
   * <span data-ttu-id="5a9e6-404">Продолжение обновления данных пространственного сопоставления также позволяет визуализировать все произошедшие изменения, что позволяет пользователю отличия между более ранними и текущими состояниями среды.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-404">Continued updates to spatial mapping data also allow visualizing any changes that have occurred, clarifying to the user the differences between prior and present states of the environment.</span></span>

* <span data-ttu-id="5a9e6-405">**Создание моментальных снимков среды, инициированных пользователем**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-405">**Take user-initiated snapshots of the environment**</span></span>
   * <span data-ttu-id="5a9e6-406">Приложение может реагировать на изменения окружающей среды только по указанному пользователем.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-406">An application may only wish to respond to environmental changes when instructed by the user.</span></span>
   * <span data-ttu-id="5a9e6-407">Например, пользователь может создать несколько трехмерных "статуес" друга, записывая их в разные моменты.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-407">For example, the user could create multiple 3D 'statues' of a friend by capturing their poses at different moments.</span></span>

* <span data-ttu-id="5a9e6-408">**Разрешить пользователю изменять окружение**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-408">**Allow the user to change the environment**</span></span>
   * <span data-ttu-id="5a9e6-409">Приложение может реагировать в реальном времени на любые изменения, внесенные в среду пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-409">An application may be designed to respond in real time to any changes made in the user's environment.</span></span>
   * <span data-ttu-id="5a9e6-410">Например, пользователь, рисующий прикрытием, может активировать "сцену Change" для более holographic-воспроизводимого воспроизведения на другой стороне.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-410">For example, the user drawing a curtain could trigger 'scene change' for a holographic play taking place on the other side.</span></span>

* <span data-ttu-id="5a9e6-411">**Помочь пользователю избежать ошибок в данных пространственного сопоставления**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-411">**Guide the user to avoid errors in the spatial mapping data**</span></span>
   * <span data-ttu-id="5a9e6-412">Приложение может предоставить пользователю рекомендации для проверки среды.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-412">An application may wish to provide guidance to the user while they're scanning their environment.</span></span>
   * <span data-ttu-id="5a9e6-413">Это может помочь пользователю избежать определенных видов [ошибок в данных пространственного сопоставления](spatial-mapping.md#what-influences-spatial-mapping-quality), например, не отключаясь от сунлит окон или зеркал.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-413">This can help the user to avoid certain kinds of [errors in the spatial mapping data](spatial-mapping.md#what-influences-spatial-mapping-quality), for example by staying away from sunlit windows or mirrors.</span></span>

<span data-ttu-id="5a9e6-414">Один из дополнительных сведений о том, что "Range" данных пространственного сопоставления не ограничен.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-414">One extra detail to be aware of is that the 'range' of spatial mapping data isn't unlimited.</span></span> <span data-ttu-id="5a9e6-415">Хотя при пространственном сопоставлении создается постоянная база данных с большими пространствами, она делает эти данные доступными для приложений в "пузырьковом" ограниченном размере вокруг пользователя.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-415">While spatial mapping does build a permanent database of large spaces, it only makes that data available to applications in a 'bubble' of limited size around the user.</span></span> <span data-ttu-id="5a9e6-416">Если вы начинаете с начала длинного корридора и не сможете пройти с самого начала, то в конечном итоге пространственные поверхности возвращаются в начале.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-416">If you start at the beginning of a long corridor and walk far enough away from the start, then eventually the spatial surfaces back at the beginning will disappear.</span></span> <span data-ttu-id="5a9e6-417">Это можно устранить путем кэширования этих поверхностей в приложении после исчезновения из доступных данных пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-417">You can mitigate this by caching those surfaces in your application after they've disappeared from the available spatial mapping data.</span></span>

## <a name="mesh-processing"></a><span data-ttu-id="5a9e6-418">Обработка сетки</span><span class="sxs-lookup"><span data-stu-id="5a9e6-418">Mesh processing</span></span>

<span data-ttu-id="5a9e6-419">Он может помочь обнаружить распространенные типы ошибок в поверхностях и фильтровать, удалять или изменять данные пространственного сопоставления соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-419">It may help to detect common types of errors in surfaces and to filter, remove or modify the spatial mapping data as appropriate.</span></span>

<span data-ttu-id="5a9e6-420">Имейте в виду, что данные пространственного сопоставления должны быть как можно точными для реальных поверхностей, поэтому любая обработка, которую вы применяете, переместит свои поверхности дальше от «правды».</span><span class="sxs-lookup"><span data-stu-id="5a9e6-420">Bear in mind that spatial mapping data is intended to be as faithful as possible to real-world surfaces, so any processing you apply risks shifting your surfaces further from the 'truth'.</span></span>

<span data-ttu-id="5a9e6-421">Ниже приведены некоторые примеры различных типов обработки сетки, которые могут оказаться полезными.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-421">Here are some examples of different types of mesh processing that you may find useful:</span></span>

* <span data-ttu-id="5a9e6-422">**Заполнение отверстия**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-422">**Hole filling**</span></span>
   * <span data-ttu-id="5a9e6-423">Если не удается проверить небольшой объект, состоящие из темного материала, он оставит отверстие в окружающей области.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-423">If a small object made of a dark material fails to scan, it will leave a hole in the surrounding surface.</span></span>
   * <span data-ttu-id="5a9e6-424">Отверстия влияют на перекрытия: голограммы могут рассматриваться как отверстия в непрозрачной области реального мира.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-424">Holes affect occlusion: holograms can be seen 'through' a hole in a supposedly opaque real-world surface.</span></span>
   * <span data-ttu-id="5a9e6-425">Отверстия влияют на райкастс: Если вы используете райкастс, чтобы помочь пользователям взаимодействовать с Surfaces, может быть нежелательно, чтобы эти лучи проходили через отверстия.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-425">Holes affect raycasts: if you're using raycasts to help users interact with surfaces, it may be undesirable for these rays to pass through holes.</span></span> <span data-ttu-id="5a9e6-426">Одним из способов устранения этой проблемы является использование пакета из нескольких райкастс, охватывающих регион соответствующего размера.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-426">One mitigation is to use a bundle of multiple raycasts covering an appropriately sized region.</span></span> <span data-ttu-id="5a9e6-427">Это позволит отфильтровать результаты выбросов, чтобы, даже если один райкаст пройдет небольшое отверстие, статистический результат по-прежнему будет действительным.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-427">This will allow you to filter 'outlier' results, so that even if one raycast passes through a small hole, the aggregate result will still be valid.</span></span> <span data-ttu-id="5a9e6-428">Однако этот подход обусловлен затратами вычислительных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-428">However, this approach comes at a computational cost.</span></span>
   * <span data-ttu-id="5a9e6-429">Отверстия повлияли на физические конфликты: объект, контролируемый функцией имитации физических объектов, может отбрасывать отверстие в этаже и потерять его.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-429">Holes affect physics collisions: an object controlled by physics simulation may drop through a hole in the floor and become lost.</span></span>
   * <span data-ttu-id="5a9e6-430">Можно алгоритмически заполнять такие отверстия в сетке Surface.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-430">It's possible to algorithmically fill such holes in the surface mesh.</span></span> <span data-ttu-id="5a9e6-431">Однако необходимо настроить алгоритм таким образом, чтобы «реальные отверстия», например Windows и заталкивает, не заполняются.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-431">However, you'll need to tune your algorithm so that 'real holes' such as windows and doorways don't get filled in.</span></span> <span data-ttu-id="5a9e6-432">Надежное отличие "реальных дыр" от "мнимых отверстий" может быть затруднено, поэтому необходимо поэкспериментировать с различными эвристиками, такими как "size" и "Граничный фигура".</span><span class="sxs-lookup"><span data-stu-id="5a9e6-432">It can be difficult to reliably differentiate 'real holes' from 'imaginary holes', so you'll need to experiment with different heuristics such as 'size' and 'boundary shape'.</span></span>

* <span data-ttu-id="5a9e6-433">**Удаление халлуЦинатион**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-433">**Hallucination removal**</span></span>
   * <span data-ttu-id="5a9e6-434">Отражения, яркие огни и перемещение объектов могут оставлять небольшие задержки "халлуЦинатионс" плавающей точкой в середине воздуха.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-434">Reflections, bright lights, and moving objects can leave small lingering 'hallucinations' floating in mid-air.</span></span>
   * <span data-ttu-id="5a9e6-435">ХаллуЦинатионс влияет на перекрытия: халлуЦинатионс может стать видимым, как темные фигуры перемещаются впереди и окклудинг другие голограммы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-435">Hallucinations affect occlusion: hallucinations may become visible as dark shapes moving in front of and occluding other holograms.</span></span>
   * <span data-ttu-id="5a9e6-436">ХаллуЦинатионс влияет на райкастс. Если вы используете райкастс, чтобы помочь пользователям взаимодействовать с поверхностями, эти лучи могут попасть на халлуЦинатион, а не на поверхность.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-436">Hallucinations affect raycasts: if you're using raycasts to help users interact with surfaces, these rays could hit a hallucination instead of the surface behind it.</span></span> <span data-ttu-id="5a9e6-437">Как и в случае с отверстиями, одним из способов устранения этой проблемы является использование многих райкастс вместо одного райкаст, но опять же это повлечет за собой вычислительные затраты.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-437">As with holes, one mitigation is to use many raycasts instead of a single raycast, but again this will come at a computational cost.</span></span>
   * <span data-ttu-id="5a9e6-438">ХаллуЦинатионс влияет на конфликты физических объектов: объект, контролируемый имитацией физикы, может быть задержан на халлуЦинатион и не может перемещаться по пустой области пространства.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-438">Hallucinations affect physics collisions: an object controlled by physics simulation may become stuck against a hallucination and be unable to move through a seemingly clear area of space.</span></span>
   * <span data-ttu-id="5a9e6-439">Можно отфильтровать такие халлуЦинатионс из сетки Surface.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-439">It's possible to filter such hallucinations from the surface mesh.</span></span> <span data-ttu-id="5a9e6-440">Однако, как и в случае с отверстиями, необходимо настроить алгоритм таким образом, чтобы реальные небольшие объекты, такие как лампы и маркеры двери, не удалялись.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-440">However, as with holes, you'll need to tune your algorithm so that real small objects such as lamp-stands and door handles don't get removed.</span></span>

* <span data-ttu-id="5a9e6-441">**Сглаживание**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-441">**Smoothing**</span></span>
   * <span data-ttu-id="5a9e6-442">Пространственное сопоставление может возвращать поверхности, которые выглядят как грубые или "шумные" в сравнении с реальными аналогами.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-442">Spatial mapping may return surfaces that appear to be rough or 'noisy' in comparison to their real-world counterparts.</span></span>
   * <span data-ttu-id="5a9e6-443">Гладкость влияет на конфликты физической связи: Если этаж является приблизительным, физически смоделированный шарик гольфа может не двигаться плавно по линии в прямой строке.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-443">Smoothness affects physics collisions: if the floor is rough, a physically simulated golf ball may not roll smoothly across it in a straight line.</span></span>
   * <span data-ttu-id="5a9e6-444">Плавность влияет на отрисовку. Если поверхность отображается напрямую, грубые нормали поверхности могут повлиять на внешний вид и нарушают вид "очистить".</span><span class="sxs-lookup"><span data-stu-id="5a9e6-444">Smoothness affects rendering: if a surface is visualized directly, rough surface normals can affect its appearance and disrupt a 'clean' look.</span></span> <span data-ttu-id="5a9e6-445">Это можно устранить с помощью соответствующего освещения и текстур в шейдере, который используется для визуализации поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-445">It's possible to mitigate this by using appropriate lighting and textures in the shader that is used to render the surface.</span></span>
   * <span data-ttu-id="5a9e6-446">Можно сгладить неровности в сетке поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-446">It's possible to smooth out roughness in a surface mesh.</span></span> <span data-ttu-id="5a9e6-447">Тем не менее, это может помещать поверхность с соответствующей реальной поверхности.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-447">However, this may push the surface further away from the corresponding real-world surface.</span></span> <span data-ttu-id="5a9e6-448">Поддержание близкой корреспонденции важна для создания точной перекрытияной голограммы и предоставления пользователям возможности достичь точных и предсказуемых взаимодействий с Holographic.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-448">Maintaining a close correspondence is important to produce accurate hologram occlusion, and to enable users to achieve precise and predictable interactions with holographic surfaces.</span></span>
   * <span data-ttu-id="5a9e6-449">Если требуется только косметические изменения, может быть достаточно для сглаживания нормалей вершин без изменения положений вершин.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-449">If only a cosmetic change is required, it may be sufficient to smooth vertex normals without changing vertex positions.</span></span>

* <span data-ttu-id="5a9e6-450">**Поиск плоскости**</span><span class="sxs-lookup"><span data-stu-id="5a9e6-450">**Plane finding**</span></span>
   * <span data-ttu-id="5a9e6-451">Существует множество видов анализа, которые приложение может выполнять на поверхностях, предоставляемых пространственным сопоставлением.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-451">There are many forms of analysis that an application may wish to perform on the surfaces provided by spatial mapping.</span></span>
   * <span data-ttu-id="5a9e6-452">Одним из простых примеров является "Поиск в плоскости"; определение ограниченных, преимущественно плоских областей поверхностей.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-452">One simple example is 'plane finding'; identifying bounded, mostly planar regions of surfaces.</span></span>
   * <span data-ttu-id="5a9e6-453">Плоские регионы можно использовать как holographic рабочих поверхностей, регионы, где holographic-содержимое может автоматически размещаться приложением.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-453">Planar regions can be used as holographic work-surfaces, regions where holographic content can be automatically placed by the application.</span></span>
   * <span data-ttu-id="5a9e6-454">Плоские регионы могут ограничивать пользовательский интерфейс, чтобы помочь пользователям взаимодействовать с поверхностями, которые лучше подходят для их нужд.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-454">Planar regions can constrain the user interface, to guide users to interact with the surfaces that best suit their needs.</span></span>
   * <span data-ttu-id="5a9e6-455">Плоские регионы можно использовать как в реальной среде, для holographic аналогов с функциональными объектами, такими как ЖК-экраны, таблицы или доски.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-455">Planar regions can be used as in the real world, for holographic counterparts to functional objects such as LCD screens, tables or whiteboards.</span></span>
   * <span data-ttu-id="5a9e6-456">Плоские регионы могут определять области воспроизведения, образуя уровень игры для видео.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-456">Planar regions can define play areas, forming the basis of video game levels.</span></span>
   * <span data-ttu-id="5a9e6-457">Плоские регионы могут помочь виртуальным агентам перемещаться по реальному миру, определяя области основания, с которыми могут посвящены реальные люди.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-457">Planar regions can aid virtual agents to navigate the real world, by identifying the areas of floor that real people are likely to walk on.</span></span>

## <a name="prototyping-and-debugging"></a><span data-ttu-id="5a9e6-458">Создание прототипов и отладка</span><span class="sxs-lookup"><span data-stu-id="5a9e6-458">Prototyping and debugging</span></span>

### <a name="useful-tools"></a><span data-ttu-id="5a9e6-459">Полезные средства</span><span class="sxs-lookup"><span data-stu-id="5a9e6-459">Useful tools</span></span>

* <span data-ttu-id="5a9e6-460">[Эмулятор hololens](../develop/platform-capabilities-and-apis/using-the-hololens-emulator.md) можно использовать для разработки приложений, использующих пространственное сопоставление без доступа к физическим HoloLens.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-460">The [HoloLens emulator](../develop/platform-capabilities-and-apis/using-the-hololens-emulator.md) can be used to develop applications using spatial mapping without access to a physical HoloLens.</span></span> <span data-ttu-id="5a9e6-461">Он позволяет имитировать динамический сеанс на HoloLens в реалистичной среде, при этом все данные, которые обычно будут использоваться приложением, включают в себя движение HoloLens, пространственные системы координат и сетки пространственных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-461">It allows you to simulate a live session on a HoloLens in a realistic environment, with all of the data your application would normally consume, including HoloLens motion, spatial coordinate systems, and spatial mapping meshes.</span></span> <span data-ttu-id="5a9e6-462">Это можно использовать для предоставления надежных, повторяемых входных данных, которые могут оказаться полезными при отладке проблем и оценке изменений в коде.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-462">This can be used to provide reliable, repeatable input, which can be useful for debugging problems and evaluating changes to your code.</span></span>
* <span data-ttu-id="5a9e6-463">Чтобы воспроизвести сценарий, запишите данные пространственного сопоставления по сети из динамического HoloLens, а затем сохраните его на диск и повторно используйте в последующих сеансах отладки.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-463">To reproduce a scenario, capture spatial mapping data over the network from a live HoloLens, then save it to disk and reuse it in later debugging sessions.</span></span>
* <span data-ttu-id="5a9e6-464">[Трехмерное представление портала устройств Windows](../develop/platform-capabilities-and-apis/using-the-windows-device-portal.md#3d-view) позволяет просматривать все пространственные поверхности, доступные в настоящее время через систему пространственных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-464">The [Windows device portal 3D view](../develop/platform-capabilities-and-apis/using-the-windows-device-portal.md#3d-view) provides a way to see all of the spatial surfaces currently available via the spatial mapping system.</span></span> <span data-ttu-id="5a9e6-465">Это дает основание для сравнения пространственных поверхностей внутри приложения; Например, можно легко определить, отсутствуют ли пространственные поверхности или они отображаются в неправильном месте.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-465">This provides a basis of comparison for the spatial surfaces inside your application; for example, you can easily tell if any spatial surfaces are missing or are being displayed in the wrong place.</span></span>

### <a name="general-prototyping-guidance"></a><span data-ttu-id="5a9e6-466">Общие рекомендации по созданию прототипов</span><span class="sxs-lookup"><span data-stu-id="5a9e6-466">General prototyping guidance</span></span>

* <span data-ttu-id="5a9e6-467">Поскольку [ошибки](spatial-mapping.md#what-influences-spatial-mapping-quality) в данных пространственного сопоставления могут сильно повлиять на взаимодействие с пользователем, рекомендуется тестировать приложение в самых разных средах.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-467">Because [errors](spatial-mapping.md#what-influences-spatial-mapping-quality) in the spatial mapping data may strongly affect your user's experience, we recommend that you test your application in a wide variety of environments.</span></span>
* <span data-ttu-id="5a9e6-468">Не загляните в привычку всегда тестировать в одном месте, например на рабочем столе.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-468">Don't get trapped in the habit of always testing in the same location, for example at your desk.</span></span> <span data-ttu-id="5a9e6-469">Обязательно протестируйте различные поверхности различных позиций, фигур, размеров и материалов.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-469">Make sure to test on various surfaces of different positions, shapes, sizes, and materials.</span></span>
* <span data-ttu-id="5a9e6-470">Аналогичным образом, хотя синтетические или записанные данные могут быть полезны для отладки, они не будут прилагаться к одному и тому же небольшому количеству тестовых случаев.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-470">Similarly, while synthetic or recorded data can be useful for debugging, don't become too reliant upon the same few test cases.</span></span> <span data-ttu-id="5a9e6-471">Это может задержать Поиск важных проблем, которые более разнообразные тесты будут перехвачены ранее.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-471">This may delay finding important issues that more varied testing would have caught earlier.</span></span>
* <span data-ttu-id="5a9e6-472">Рекомендуется выполнять тестирование с реальными (и идеальными нерекомендуемыми) пользователями, поскольку они могут не использовать HoloLens или приложение точно так же, как это делается.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-472">It's a good idea to perform testing with real (and ideally uncoached) users, because they may not use the HoloLens or your application in exactly the same way that you do.</span></span> <span data-ttu-id="5a9e6-473">На самом деле, это может неожиданно повлиять на то, насколько поведений, знаний и допущений людей может быть.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-473">In fact, it may surprise you how divergent people's behavior, knowledge, and assumptions can be!</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="5a9e6-474">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="5a9e6-474">Troubleshooting</span></span>

* <span data-ttu-id="5a9e6-475">Чтобы обеспечить правильную ориентированность сеток Surface, каждый GameObject должен быть активен перед отправкой в Сурфацеобсервер, чтобы была создана его сетка.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-475">In order for the surface meshes to be orientated correctly, each GameObject needs to be active before it's sent to the SurfaceObserver to have its mesh constructed.</span></span> <span data-ttu-id="5a9e6-476">В противном случае сетки будут отображаться в своем пространстве, но поворачиваются в странные углы.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-476">Otherwise, the meshes will show up in your space but rotated at weird angles.</span></span>
* <span data-ttu-id="5a9e6-477">GameObject, выполняющий сценарий, который обменивается данными с Сурфацеобсервер, должен быть установлен в качестве источника.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-477">The GameObject that runs the script that communicates with the SurfaceObserver needs to be set to the origin.</span></span> <span data-ttu-id="5a9e6-478">В противном случае все объекты gameobject, которые были созданы и отправлены в Сурфацеобсервер для создания своих сеток, будут иметь смещение, равное смещению родительского игрового объекта.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-478">Otherwise, all of GameObjects that you create and send to the SurfaceObserver to have their meshes constructed will have an offset equal to the offset of the Parent Game Object.</span></span> <span data-ttu-id="5a9e6-479">Это может привести к отображению нескольких метров сетки, что затрудняет отладку.</span><span class="sxs-lookup"><span data-stu-id="5a9e6-479">This can make your meshes show up several meters away, which makes it hard to debug what is going on.</span></span>

## <a name="see-also"></a><span data-ttu-id="5a9e6-480">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="5a9e6-480">See also</span></span>

* [<span data-ttu-id="5a9e6-481">Системы координат</span><span class="sxs-lookup"><span data-stu-id="5a9e6-481">Coordinate systems</span></span>](coordinate-systems.md)
* [<span data-ttu-id="5a9e6-482">Пространственное сопоставление в DirectX</span><span class="sxs-lookup"><span data-stu-id="5a9e6-482">Spatial mapping in DirectX</span></span>](../develop/native/spatial-mapping-in-directx.md)
* [<span data-ttu-id="5a9e6-483">Пространственное сопоставление в Unity</span><span class="sxs-lookup"><span data-stu-id="5a9e6-483">Spatial mapping in Unity</span></span>](../develop/unity/spatial-mapping-in-unity.md)
* [<span data-ttu-id="5a9e6-484">Основные сведения о сцене</span><span class="sxs-lookup"><span data-stu-id="5a9e6-484">Scene Understanding</span></span>](scene-understanding.md)
* [<span data-ttu-id="5a9e6-485">Визуализация при сканировании комнаты</span><span class="sxs-lookup"><span data-stu-id="5a9e6-485">Room scan visualization</span></span>](room-scan-visualization.md)
* [<span data-ttu-id="5a9e6-486">Проектирование пространственного звука</span><span class="sxs-lookup"><span data-stu-id="5a9e6-486">Spatial sound design</span></span>](spatial-sound-design.md)
* <span data-ttu-id="5a9e6-487">[Case study - Looking through holes in your reality](../out-of-scope/case-study-looking-through-holes-in-your-reality.md) (Пример использования. Взгляд сквозь отверстия в реальности)</span><span class="sxs-lookup"><span data-stu-id="5a9e6-487">[Case study - Looking through holes in your reality](../out-of-scope/case-study-looking-through-holes-in-your-reality.md)</span></span>