---
title: Пример использования — Холотаур
description: Холотаур для Microsoft HoloLens предоставляет впечатляющие трехмерные обзоры значков по всему миру. В этом практическом примере рассматривается процесс записи и создания содержимого, используемого для Холотаур.
author: dannyaskew
ms.author: daaske
ms.date: 03/21/2018
ms.topic: article
keywords: Холотаур, HoloLens, Windows Mixed Reality
ms.openlocfilehash: 9908327a1b8e70eef73d3f98adb7c75615e8e098
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2020
ms.locfileid: "91691937"
---
# <a name="case-study---holotour"></a>Пример использования — Холотаур

Холотаур для Microsoft HoloLens предоставляет впечатляющие трехмерные обзоры значков по всему миру. По мере того, как дизайнеры, исполнители, производители, проектировщики аудио и разработчики работают над этим проектом, создание убедительной трехмерной отрисовки хорошо известного расположения берет на себя уникальную смесь мастеров творческих и технологических решений. В этом практическом примере рассматривается процесс записи и создания содержимого, используемого для Холотаур.

## <a name="the-tech"></a>Технический

С Холотаур мы хотели сделать так, чтобы люди могли посетить некоторые из самых невероятных назначений, например [Руинс Мачу Пикчу](https://en.wikipedia.org/wiki/Machu_Picchu) в Перу или современный день [Пиазза Навона](https://en.wikipedia.org/wiki/Piazza_Navona) в Италии — прямо из своих собственных комнат. Наша группа предоставила ей цель «Холотаур». Необходимо, чтобы они были не только изображениями, но и видеороликами. Используя уникальную технологию представления, отслеживания и звука, мы надеемся, что мы могли бы виртуально передавать вас в другое место. Нам бы пришлось бы захватывать ставку, звуки и трехмерную геометрию всех посещаемых мест, а затем повторно создавать их в нашем приложении.

Для этого нам требовалась платформа на 360 ° с направлением звука. Это требовалось для захвата с очень высоким разрешением, чтобы при воспроизведении на HoloLens материал был четким, а камеры требовалось располагать близко друг к другу, чтобы свести к минимуму сшивания артефактов. Нам требовалось полное сферическое покрытие, а не только горизонт, но выше и ниже. Платформа также должна быть переносимой, чтобы мы могли взять ее по всему миру. Мы оценили доступные готовые варианты и поняли, что они просто не были достаточно хорошими для реализации нашего концепции — из-за разрешения, стоимости или размера. Если не удалось найти платформу камеры, которая удовлетворяет нашим потребностям, нам пришлось бы создать ее.

### <a name="building-the-rig"></a>Создание тестовой платформы

Первая версия, созданная из кардбоард, велкро, воздуховода и 14 GoPro камер, была что-то Макгивер было бы гордостью. После того как вы просматриваете все решения от низкоуровневых решений до пользовательских изготовленных платформ, GoProные камеры, в конечном итоге, были лучшим вариантом для нас, так как они были небольшими, недоступными и имели простое в использовании хранилище памяти. Небольшой форм-фактор был особенно важен, так как он позволял нам размещать камеры по-своему близко друг к другу — чем меньше расстояние между камерами, тем меньше будут небольшие артефакты. Наша уникальная схема камеры позволила нам получить полное покрытие сферы, а *также* достаточно перекрытия для интеллектуального распределения камер и смягчения некоторых артефактов во время процесса сшивания.

Использование возможностей [пространственного звука](../design/spatial-sound.md) в HoloLens очень важно для создания убедительного практического впечатления. Мы использовали массив с четырьмя микрофонами, расположенный под камерами на трипод, который бы мог записать звук из расположения камеры в четырех направлениях, предоставив нам достаточно информации для создания пространственных звуков в нашем монтажном кадре.

![Наша видеокамера 360 ° настроена на пленку за пределами Pantheon.](images/camera-pantheon-200px.png)

Наша видеокамера 360 ° настроена на пленку за пределами Pantheon. 


Мы протестировали нашу самодельноеную тестовую платформу, выполнив ее до Раттлеснакеа в Сиэтле, записывая пейзажей в верхней части прогуляться. Результат, хотя и значительно менее безупречен, чем места, которые вы видите в Холотаур сегодня, дает нам уверенность в том, что наша фабрика была достаточной для того, чтобы сделать вас в действительности.

Мы обновили платформу с велкро и кардбоард на трехмерный корпус камеры и приобрели внешние пакеты аккумулятора для камер GoPro, чтобы упростить управление зарядами батарей. Затем мы проделали более обширный тест, продолжим до Сан-Франциско, чтобы создать краткий обзор по городу города и мосту с значок золотого шлюза. Эта платформа камеры используется для большинства наших записей о расположениях, посещаемых в Холотаур.

![Мачу Пикчу на пленке на платформе с 360 °.](images/camera-machu-pichu-500px.png)

Мачу Пикчу на пленке на платформе с 360 °. 

## <a name="behind-the-scenes"></a>Сопутствующие ресурсы

Прежде чем приступать к фильмам, нам нужно было выяснить, какие места мы хотели бы включить в наш виртуальный обзор. Рим — это первое место, которое мы представили для доставки, и мы хотели получить его правильно, так что мы решили заранее продвинуться на должности. Мы отправили группе из шести людей, включая исполнителей, дизайнеров и поставщиков, посетить посещаемые вами веб-узлы. Поездка заняло около 9 дней — 2,5 для поездок, а остальное — для пленки. (Для Мачу Пикчу мы решили не выполнять поездку, прополняя Поиск заранее и зарезервирование нескольких дней буфера для пленки.)

В то же время, группа приняла фотографии каждой области и отметила интересные факты, а также практические соображения, например, насколько сложно переместиться в каждую из них и насколько трудно проделать ее из-за кровдс или ограничений. Это может показаться отпуском, но это очень много работы. Дни началися раньше, а пока не будут вечером. Каждый ночь мы отправили материал для команды в Сиэтле для просмотра. 

![Наш сотрудниковный сбор в Рим.](images/holotour-filming-crew-rome-500px.jpg) 

Наш сотрудниковный сбор в Рим. 


После завершения поездки Scout был создан окончательный план для фактической пленки. В этом случае требуется подробный список, где мы будем затронуть пленку, на какой день и в какое время. Каждый день занимает много ресурсов, поэтому эти поездки должны быть эффективными. Мы зарезервированы руководства и обработчики в Рим, чтобы помочь нам и полностью использовать каждый день с момента восход солнца до заката. Нам нужно получить лучший материал, чтобы вы могли узнать, как это действительно действительно.

### <a name="capturing-the-video"></a>Запись видео

Выполнение нескольких простых действий во время захвата может значительно упростить процесс обработки. Например, при объединении изображений из нескольких камер Вы прикончите визуальные артефакты, так как каждая камера имеет немного отличающееся представление. Более близкие объекты к камере, чем больше разница между представлениями, тем больше будет более крупными артефактами. Вот простой способ визуализации проблемы: Держите свой бегунок перед лицом и взгляните на него только с одним глазом. Теперь переключите глаза. Вы увидите, что бегунок будет перемещаться относительно фона. Если вы держите бегунок дальше от вашего лица и повторите эксперимент, ваш бегунок будет двигаться меньше. Очевидное движение похоже на проблему сшивания, о которой мы столкнулись: ваши глаза, такие как наши камеры, не видят точно тот же образ, так как они разделяются на небольшое расстояние.

Так как гораздо проще предотвратить худшее количество артефактов, но при их исправлении в ходе последующей обработки мы попытались отказаться от камеры в надеется, но мы могли бы исключить необходимость сшивания объектов. Большая Очистка нашей камеры, возможно, была одной из крупнейших проблем, которые мы имели в процессе ее устранения, и нам пришлось приступить к работе. Работа с локальными руководствами была огромной справкой по управлению кровдс, но мы также обнаружили, что с помощью знаков, а иногда небольшие конес или Bean сумки, пометить пространство на пленке было достаточно эффективным, особенно потому, что нам нужно только получить небольшой объем материала в каждом месте. Как правило, лучшим способом получения хорошей записи было просто приступить к началу утром, прежде чем большинство людей попадают в нее.

Некоторые другие полезные методики записи поступают непосредственно на основе традиционных методов работы с фильмами. Например, мы использовали карту коррекции цвета для всех камер и захваченные справочники по текстурам и объектам, которые могут потребоваться позже. 

![Вырезание Мачу Пикчу, в котором показана карта коррекции цвета.](images/rough-cut-machu-picchu-500px.png)

Предварительное вырезание Pantheonного материала перед началом сшивания.

### <a name="processing-the-video"></a>Обработка видео

Захват содержимого 360 ° — это лишь первый шаг — для преобразования необработанного материала камеры, полученного в конечные ресурсы, который вы видите в Холотаур, требуется большой объем обработки. Когда мы вернемся к домашней странице, нам потребовалось взять видео с 14 различных каналов камеры и превратить его в единое непрерывное видео с минимальными артефактами. Наша группа использовала ряд инструментов для объединения и польского материала, и мы разработали конвейер для оптимизации обработки, насколько это возможно. Этот материал должен быть соединен вместе, Исправлен цвет, а затем составить его, чтобы удалить ненужные элементы и артефакты или добавить дополнительные карманных устройствы жизни и движения, все с целью улучшения этого периода.

![Предварительное вырезание Pantheonного материала перед началом сшивания.](images/rough-cut-pantheon-500px.png)

Предварительное вырезание Pantheonного материала перед началом сшивания. 


Чтобы объединить видео, мы использовали средство с названием [птгуи](https://www.ptgui.com/) и интегрировано в наш конвейер обработки. Во время последующей обработки мы извлекли по-прежнему кадры из наших видеороликов и обнаружили шаблон сшивания, который хорошо подходит для одного из этих кадров. Затем мы применили этот шаблон к пользовательскому подключаемому модулю, написанному с помощью наших видеороликов, чтобы точно настроить шаблон сшивания и настроить его непосредственно во время компоновки в After Effects. 

![Снимок экрана Птгуи, иллюстрирующий Pantheonй материал.](images/stitching-tool-pantheon-500px.png)

Снимок экрана Птгуи, иллюстрирующий Pantheonй материал. 


### <a name="video-playback"></a>Воспроизведение видео

После завершения обработки материала у нас есть непрозрачный видеоролик, но он чрезвычайно большой — вокруг 8 Кбного разрешения. Декодирование видео является дорогостоящим, и есть несколько компьютеров, которые могут работать с 8 КБ видео, поэтому следующая задача найдет способ воспроизведения видео на HoloLens. Мы разработали ряд стратегий, которые позволят избежать затрат на декодирование, когда пользователь по-прежнему покажется, что он просматривает все видео.

Простейшая оптимизация заключается в том, чтобы избежать декодирования фрагментов видео, которые не меняются. Мы написали средство для обнаружения областей в каждой сцене с небольшим движением или без них. Для этих регионов отображается статическое изображение, а не декодирование видео по каждому кадру. Чтобы сделать это возможным, мы разбивает огромное видео на большие фрагменты.

Мы также проделали, что каждый пиксель, декодированный, использовался наиболее эффективно. Мы экспериментируем с методами сжатия, чтобы уменьшить размер видео. регионы видео разбиваются в соответствии с многоугольниками геометрической геометрии, на которую будет осуществляться проецирование. Мы настроили UVs и перефасованные видеоролики в зависимости от того, насколько подробно включены различные многоугольники. Результатом этой работы является то, что началось в виде одного 8 КБ видео, которое было включено в несколько фрагментов, которые выглядят почти нечитаемыми до тех пор, пока они не будут правильно перепроецированы в сцену. Для разработчика игр, который понимает сопоставление текстур и UV-упаковку, это, вероятно, покажется знакомым. 

![Полное представление Pantheon перед оптимизацией.](images/pantheon-before-optimization-500px.png) 

Полное представление Pantheon перед оптимизацией. 


![Правая половина Pantheon, обрабатывалась для воспроизведения видео.](images/pantheon-process-video-playback-500px.png) 

Правая половина Pantheon, обрабатывалась для воспроизведения видео. 


![Пример отдельной видеообласти после оптимизации и упаковки.](images/single-video-region-after-optimization-500px.png) 

Пример отдельной видеообласти после оптимизации и упаковки. 


Еще один прием, который мы использовали, — избежать декодирования видео, которое активно не просматривается. В Холотаур вы можете видеть только часть полной сцены в любой момент времени. Мы декодированы видео только в пределах поля представления (фов) или вскоре за его пределами. Когда вы поворачиваете свой головной компьютер, мы начали воспроизводить регионы видео, которые теперь находятся в фов, и прекращать воспроизведение, которые больше не находятся в нем. Большинство людей даже не заметят, что это происходит, но если вы быстро перейдете, вы увидите, что видео займет еще одну секунду – в то же время вы увидите статический рисунок, который затем постепенно восстановится видео после того, как он будет готов.

Чтобы обеспечить эту стратегию, мы разработали обширную систему воспроизведения видео. Оптимизирован код воспроизведения нижнего уровня, чтобы обеспечить чрезвычайно эффективное переключение видео. Кроме того, нам пришлось закодировать видео особым способом, чтобы можно было быстро переключиться на видео в любое время. Этот конвейер воспроизведения занял значительный объем времени разработки, поэтому мы реализовали его поэтапно. Мы начали использовать более простую систему, которая была менее эффективной, но позволяла дизайнерам и исполнителям работать над интерфейсом и медленно улучшить ее до более надежной системы воспроизведения, которая позволила бы нам поставляться на окончательной панели качества. В этой конечной системе были созданы пользовательские инструменты, созданные в Unity для настройки видео в сцене и мониторинга подсистемы воспроизведения.

### <a name="recreating-near-space-objects-in-3d"></a>Повторное создание объектов, близких к месту, в трехмерном пространстве

Видеоролики составляют большую часть того, что вы видите в Холотаур, но существует ряд трехмерных объектов, которые выглядят ближе к вам, например, рисование в Пиазза Навона, фаунтаин за пределами Pantheon или всплывающая подсказка, используемая для аэрофотосъемки сцен. Эти трехмерные объекты важны, так как человеческие ощущения очень хорошо близко, но не слишком далеко. Мы можем отказаться от видео на расстоянии, но чтобы позволить пользователям проанализировать свое пространство, как на самом деле, соседние объекты нуждаются в глубине. Этот метод аналогичен тому, который можно увидеть в естественном музей — на рисунке диорама, который имеет физические ландскапинг, растения и животные чучел на переднем плане, но перемещается в фоновом режиме.

Некоторые объекты — это просто трехмерные ресурсы, которые мы создали и добавили в сцену для улучшения работы. Рисование и всплывающая подсказка воздуха попадают в эту категорию, так как они не были представлены на пленке. Как и ресурсы игры, они были созданы трехмерным исполнителем в нашей группе и соответствующим образом текстурированы. Мы разместите их в нашей сцене рядом с тем местом, где вы размещаете, и модуль игры может отобразить их в два вида HoloLens, чтобы они отображались в виде трехмерного объекта.

Другие активы, такие как фаунтаин за пределами Pantheon, являются реальными объектами, которые существуют в расположениях, где мы относим видео, но для переноса этих объектов из видео и трехмерной графики необходимо выполнить ряд действий.

Сначала требуется дополнительная информация о каждом объекте. В то время как для фотопленки наша группа записала множество справочных материалов по этим объектам, чтобы было достаточно подробных изображений для правильного воссоздания текстур. Группа также выполнила проверку [фотограмметри](https://en.wikipedia.org/wiki/Photogrammetry) , которая строит трехмерную модель из десятков 2D-изображений, что дает нам приблизительную модель объекта в идеальном масштабе.

По мере обработки нашего материала объекты, которые позже будут заменены трехмерным представлением, удаляются из видео. Трехмерный ресурс основан на модели фотограмметри, но очищен и упрощен нашими исполнителями. Для некоторых объектов мы можем использовать части видео (например, текстуру воды в фаунтаине), но большая часть фаунтаин теперь является трехмерным объектом, что позволяет пользователям воспринимать глубину и обходить ее в ограниченном пространстве в интерфейсе. Наличие объектов практическиго пространства, таких как, значительно увеличивает смысл реальных данных и помогает пользователям навести себя на виртуальные точки. 

![Pantheonный материал с удаленным фаунтаин. Он будет заменен на 3D-ресурс.](images/object-removal-pantheon-500px.png)

Pantheonный материал с удаленным фаунтаин. Он будет заменен на 3D-ресурс.


## <a name="final-thoughts"></a>В заключение

Очевидно, что создание этого содержимого было больше, чем мы обсуждали здесь. Существует несколько сцен: мы хотим назвать их «невозможными перспективами», включая всплывающие окна горячего воздуха и Гладиатор борьба в Колоссеум, что занимало более творческий подход. Мы будем решать эти ситуации в будущем.

Мы надеемся, что совместное использование решений с некоторыми более крупными задачами, которые мы имели в рабочей среде, было полезным для других разработчиков, и вы будете использовать некоторые из этих методов для создания собственных впечатляющих возможностей HoloLens. (Если вы сделаете это, не забудьте поделиться им с нами на [форуме по разработке приложений HoloLens](https://forums.hololens.com/)!)

## <a name="about-the-authors"></a>Об авторах

<table style="border:0">
<tr>
<td style="border:0" width="60px"> <img alt="David Haley" width="60" height="60" src="images/haley.png" /></td>
<td style="border:0" width="408"> <b>Дэвид халэй</b> — старший разработчик, получивший больше внимания на платформах камеры и воспроизведении видео, чем это было возможно от работы над холотаур.</td>
<td style="border:0" width="60px"> <img alt="Danny Askew" width="60" height="60" src="images/askew.png" /></td>
<td style="border:0" width="408"> <b>Дэнни аскев</b> — это видеоисполнитель, который уверен, что ваш путешествие через Рим был как можно более безупречным.</td>
</tr>
<tr>
<td style="border:0" width="60px"> <img alt="Jason Syltebo" width="60" height="60" src="images/syltebo.png" /></td>
<td style="border:0" width="408"> <b>Джейсон силтебо</b> — это конструктор аудио, который уверен в том, что вы можете столкнуться с саундскапеами всех мест назначения, даже когда вы перейдете назад.</td>
<td style="border:0" width="60px"> <img alt="Travis Steiner" width="60" height="60" src="images/steiner.png" /></td>
<td style="border:0" width="408"> <b>Travis Стеинер</b> — это директор по проектированию, который проработал в должности и намерена ее местоположение, создал планы поездки и намерена пропленки на сайте.</td>
</tr>
</table>



## <a name="see-also"></a>См. также раздел
* [Видео: Microsoft HoloLens: Холотаур](https://www.youtube.com/watch?v=pLd9WPlaMpY)
