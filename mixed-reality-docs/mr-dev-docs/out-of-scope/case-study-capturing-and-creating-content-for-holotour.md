---
title: Пример использования — Холотаур
description: Холотаур для Microsoft HoloLens предоставляет впечатляющие трехмерные обзоры значков по всему миру. В этом практическом примере рассматривается процесс записи и создания содержимого, используемого для Холотаур.
author: dannyaskew
ms.author: daaske
ms.date: 03/21/2018
ms.topic: article
keywords: Холотаур, HoloLens, Windows Mixed Reality
ms.openlocfilehash: 9908327a1b8e70eef73d3f98adb7c75615e8e098
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2020
ms.locfileid: "91691937"
---
# <a name="case-study---holotour"></a><span data-ttu-id="2c67d-105">Пример использования — Холотаур</span><span class="sxs-lookup"><span data-stu-id="2c67d-105">Case study - HoloTour</span></span>

<span data-ttu-id="2c67d-106">Холотаур для Microsoft HoloLens предоставляет впечатляющие трехмерные обзоры значков по всему миру.</span><span class="sxs-lookup"><span data-stu-id="2c67d-106">HoloTour for Microsoft HoloLens provides immersive 3D personal tours of iconic locations around the world.</span></span> <span data-ttu-id="2c67d-107">По мере того, как дизайнеры, исполнители, производители, проектировщики аудио и разработчики работают над этим проектом, создание убедительной трехмерной отрисовки хорошо известного расположения берет на себя уникальную смесь мастеров творческих и технологических решений.</span><span class="sxs-lookup"><span data-stu-id="2c67d-107">As the designers, artists, producers, audio designers, and developers working on this project found out, creating a convincingly real 3D rendering of a well-known location takes a unique blend of creative and technological wizardry.</span></span> <span data-ttu-id="2c67d-108">В этом практическом примере рассматривается процесс записи и создания содержимого, используемого для Холотаур.</span><span class="sxs-lookup"><span data-stu-id="2c67d-108">This case study will walk through the process of capturing and creating the content used for HoloTour.</span></span>

## <a name="the-tech"></a><span data-ttu-id="2c67d-109">Технический</span><span class="sxs-lookup"><span data-stu-id="2c67d-109">The tech</span></span>

<span data-ttu-id="2c67d-110">С Холотаур мы хотели сделать так, чтобы люди могли посетить некоторые из самых невероятных назначений, например [Руинс Мачу Пикчу](https://en.wikipedia.org/wiki/Machu_Picchu) в Перу или современный день [Пиазза Навона](https://en.wikipedia.org/wiki/Piazza_Navona) в Италии — прямо из своих собственных комнат.</span><span class="sxs-lookup"><span data-stu-id="2c67d-110">With HoloTour, we wanted to make it possible for people to visit some of the world’s most amazing destinations—like the [ruins of Machu Picchu](https://en.wikipedia.org/wiki/Machu_Picchu) in Peru or the modern day [Piazza Navona](https://en.wikipedia.org/wiki/Piazza_Navona) in Italy—right from their own living rooms.</span></span> <span data-ttu-id="2c67d-111">Наша группа предоставила ей цель «Холотаур».</span><span class="sxs-lookup"><span data-stu-id="2c67d-111">Our team made it the goal of HoloTour to “make you feel like you’re really there.”</span></span> <span data-ttu-id="2c67d-112">Необходимо, чтобы они были не только изображениями, но и видеороликами.</span><span class="sxs-lookup"><span data-stu-id="2c67d-112">The experience needed to be more than just pictures or videos.</span></span> <span data-ttu-id="2c67d-113">Используя уникальную технологию представления, отслеживания и звука, мы надеемся, что мы могли бы виртуально передавать вас в другое место.</span><span class="sxs-lookup"><span data-stu-id="2c67d-113">By leveraging the unique display, tracking, and audio technology of HoloLens we believed we could virtually transport you to another place.</span></span> <span data-ttu-id="2c67d-114">Нам бы пришлось бы захватывать ставку, звуки и трехмерную геометрию всех посещаемых мест, а затем повторно создавать их в нашем приложении.</span><span class="sxs-lookup"><span data-stu-id="2c67d-114">We would need to capture the sights, sounds, and three-dimensional geometry of every location we visited and then recreate that within our app.</span></span>

<span data-ttu-id="2c67d-115">Для этого нам требовалась платформа на 360 ° с направлением звука.</span><span class="sxs-lookup"><span data-stu-id="2c67d-115">In order to do this, we needed a 360° camera rig with directional audio capture.</span></span> <span data-ttu-id="2c67d-116">Это требовалось для захвата с очень высоким разрешением, чтобы при воспроизведении на HoloLens материал был четким, а камеры требовалось располагать близко друг к другу, чтобы свести к минимуму сшивания артефактов.</span><span class="sxs-lookup"><span data-stu-id="2c67d-116">It needed to capture at extremely high resolution, so that the footage would look crisp when played back on a HoloLens and the cameras would need to be positioned close together in order to minimize stitching artifacts.</span></span> <span data-ttu-id="2c67d-117">Нам требовалось полное сферическое покрытие, а не только горизонт, но выше и ниже.</span><span class="sxs-lookup"><span data-stu-id="2c67d-117">We wanted full spherical coverage, not just along the horizon, but above and below you as well.</span></span> <span data-ttu-id="2c67d-118">Платформа также должна быть переносимой, чтобы мы могли взять ее по всему миру.</span><span class="sxs-lookup"><span data-stu-id="2c67d-118">The rig also needed to be portable so that we could take it all over the world.</span></span> <span data-ttu-id="2c67d-119">Мы оценили доступные готовые варианты и поняли, что они просто не были достаточно хорошими для реализации нашего концепции — из-за разрешения, стоимости или размера.</span><span class="sxs-lookup"><span data-stu-id="2c67d-119">We evaluated available off-the-shelf options and realized they simply weren’t good enough to realize our vision – either because of resolution, cost, or size.</span></span> <span data-ttu-id="2c67d-120">Если не удалось найти платформу камеры, которая удовлетворяет нашим потребностям, нам пришлось бы создать ее.</span><span class="sxs-lookup"><span data-stu-id="2c67d-120">If we couldn’t find a camera rig that satisfied our needs, we would have to build one ourselves.</span></span>

### <a name="building-the-rig"></a><span data-ttu-id="2c67d-121">Создание тестовой платформы</span><span class="sxs-lookup"><span data-stu-id="2c67d-121">Building the rig</span></span>

<span data-ttu-id="2c67d-122">Первая версия, созданная из кардбоард, велкро, воздуховода и 14 GoPro камер, была что-то Макгивер было бы гордостью.</span><span class="sxs-lookup"><span data-stu-id="2c67d-122">The first version—made from cardboard, Velcro, duct tape, and 14 GoPro cameras—was something MacGyver would have been proud of.</span></span> <span data-ttu-id="2c67d-123">После того как вы просматриваете все решения от низкоуровневых решений до пользовательских изготовленных платформ, GoProные камеры, в конечном итоге, были лучшим вариантом для нас, так как они были небольшими, недоступными и имели простое в использовании хранилище памяти.</span><span class="sxs-lookup"><span data-stu-id="2c67d-123">After reviewing everything from low-end solutions to custom manufactured rigs, GoPro cameras were ultimately the best option for us because they were small, affordable, and had easy-to-use memory storage.</span></span> <span data-ttu-id="2c67d-124">Небольшой форм-фактор был особенно важен, так как он позволял нам размещать камеры по-своему близко друг к другу — чем меньше расстояние между камерами, тем меньше будут небольшие артефакты.</span><span class="sxs-lookup"><span data-stu-id="2c67d-124">The small form factor was especially important because it allowed us to place cameras fairly close together—the smaller the distance between cameras, the smaller the stitching artifacts will be.</span></span> <span data-ttu-id="2c67d-125">Наша уникальная схема камеры позволила нам получить полное покрытие сферы, а *также* достаточно перекрытия для интеллектуального распределения камер и смягчения некоторых артефактов во время процесса сшивания.</span><span class="sxs-lookup"><span data-stu-id="2c67d-125">Our unique camera arrangement allowed us to get full sphere coverage *plus* enough overlap to intelligently align cameras and smooth out some artifacts during the stitching process.</span></span>

<span data-ttu-id="2c67d-126">Использование возможностей [пространственного звука](../design/spatial-sound.md) в HoloLens очень важно для создания убедительного практического впечатления.</span><span class="sxs-lookup"><span data-stu-id="2c67d-126">Taking advantage of the [spatial sound](../design/spatial-sound.md) capabilities on HoloLens is critical to creating a convincingly real immersive experience.</span></span> <span data-ttu-id="2c67d-127">Мы использовали массив с четырьмя микрофонами, расположенный под камерами на трипод, который бы мог записать звук из расположения камеры в четырех направлениях, предоставив нам достаточно информации для создания пространственных звуков в нашем монтажном кадре.</span><span class="sxs-lookup"><span data-stu-id="2c67d-127">We used a four-microphone array situated beneath the cameras on the tripod, which would capture sound from the location of our camera in four directions, giving us enough information to create spatial sounds in our scenes.</span></span>

![Наша видеокамера 360 ° настроена на пленку за пределами Pantheon.](images/camera-pantheon-200px.png)

<span data-ttu-id="2c67d-129">Наша видеокамера 360 ° настроена на пленку за пределами Pantheon.</span><span class="sxs-lookup"><span data-stu-id="2c67d-129">Our 360° camera rig set up for filming outside the Pantheon.</span></span> 


<span data-ttu-id="2c67d-130">Мы протестировали нашу самодельноеную тестовую платформу, выполнив ее до Раттлеснакеа в Сиэтле, записывая пейзажей в верхней части прогуляться.</span><span class="sxs-lookup"><span data-stu-id="2c67d-130">We tested out our homemade rig by taking it up to Rattlesnake Ridge near Seattle, capturing the scenery at the top of the hike.</span></span> <span data-ttu-id="2c67d-131">Результат, хотя и значительно менее безупречен, чем места, которые вы видите в Холотаур сегодня, дает нам уверенность в том, что наша фабрика была достаточной для того, чтобы сделать вас в действительности.</span><span class="sxs-lookup"><span data-stu-id="2c67d-131">The result, though significantly less polished than the locations you see in HoloTour today, gave us confidence that our rig design was good enough to make you feel like you’re really there.</span></span>

<span data-ttu-id="2c67d-132">Мы обновили платформу с велкро и кардбоард на трехмерный корпус камеры и приобрели внешние пакеты аккумулятора для камер GoPro, чтобы упростить управление зарядами батарей.</span><span class="sxs-lookup"><span data-stu-id="2c67d-132">We upgraded our rig from Velcro and cardboard to a 3D-printed camera housing and bought external battery packs for the GoPro cameras to simplify battery management.</span></span> <span data-ttu-id="2c67d-133">Затем мы проделали более обширный тест, продолжим до Сан-Франциско, чтобы создать краткий обзор по городу города и мосту с значок золотого шлюза.</span><span class="sxs-lookup"><span data-stu-id="2c67d-133">We then did a more extensive test, traveling down to San Francisco to create a miniature tour of the city’s coast and the iconic Golden Gate bridge.</span></span> <span data-ttu-id="2c67d-134">Эта платформа камеры используется для большинства наших записей о расположениях, посещаемых в Холотаур.</span><span class="sxs-lookup"><span data-stu-id="2c67d-134">This camera rig is what we used for most of our captures of the locations you visit in HoloTour.</span></span>

![Мачу Пикчу на пленке на платформе с 360 °.](images/camera-machu-pichu-500px.png)

<span data-ttu-id="2c67d-136">Мачу Пикчу на пленке на платформе с 360 °.</span><span class="sxs-lookup"><span data-stu-id="2c67d-136">The 360° camera rig filming in Machu Picchu.</span></span> 

## <a name="behind-the-scenes"></a><span data-ttu-id="2c67d-137">Сопутствующие ресурсы</span><span class="sxs-lookup"><span data-stu-id="2c67d-137">Behind the scenes</span></span>

<span data-ttu-id="2c67d-138">Прежде чем приступать к фильмам, нам нужно было выяснить, какие места мы хотели бы включить в наш виртуальный обзор.</span><span class="sxs-lookup"><span data-stu-id="2c67d-138">Before filming, we needed to figure out which locations we wanted to include on our virtual tour.</span></span> <span data-ttu-id="2c67d-139">Рим — это первое место, которое мы представили для доставки, и мы хотели получить его правильно, так что мы решили заранее продвинуться на должности.</span><span class="sxs-lookup"><span data-stu-id="2c67d-139">Rome was the first location we intended to ship and we wanted to get it right, so we decided to do a scouting trip in advance.</span></span> <span data-ttu-id="2c67d-140">Мы отправили группе из шести людей, включая исполнителей, дизайнеров и поставщиков, посетить посещаемые вами веб-узлы.</span><span class="sxs-lookup"><span data-stu-id="2c67d-140">We sent a team of six people—including artists, designers, and producers—for an in-person visit to the sites we were considering.</span></span> <span data-ttu-id="2c67d-141">Поездка заняло около 9 дней — 2,5 для поездок, а остальное — для пленки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-141">The trip took about 9 days – 2.5 for travel, the rest for filming.</span></span> <span data-ttu-id="2c67d-142">(Для Мачу Пикчу мы решили не выполнять поездку, прополняя Поиск заранее и зарезервирование нескольких дней буфера для пленки.)</span><span class="sxs-lookup"><span data-stu-id="2c67d-142">(For Machu Picchu we opted not to do a scout trip, researching in advance and booking a few days of buffer for filming.)</span></span>

<span data-ttu-id="2c67d-143">В то же время, группа приняла фотографии каждой области и отметила интересные факты, а также практические соображения, например, насколько сложно переместиться в каждую из них и насколько трудно проделать ее из-за кровдс или ограничений.</span><span class="sxs-lookup"><span data-stu-id="2c67d-143">While in Rome, the team took photos of each area and noted interesting facts as well as practical considerations, such as how hard it is to travel to each spot and how difficult it would be to film because of crowds or restrictions.</span></span> <span data-ttu-id="2c67d-144">Это может показаться отпуском, но это очень много работы.</span><span class="sxs-lookup"><span data-stu-id="2c67d-144">This may sound like a vacation, but it’s a lot of work.</span></span> <span data-ttu-id="2c67d-145">Дни началися раньше, а пока не будут вечером.</span><span class="sxs-lookup"><span data-stu-id="2c67d-145">Days started early in the morning and would go non-stop until evening.</span></span> <span data-ttu-id="2c67d-146">Каждый ночь мы отправили материал для команды в Сиэтле для просмотра.</span><span class="sxs-lookup"><span data-stu-id="2c67d-146">Each night, footage was uploaded for the team back in Seattle to review.</span></span> 

![Наш сотрудниковный сбор в Рим.](images/holotour-filming-crew-rome-500px.jpg) 

<span data-ttu-id="2c67d-148">Наш сотрудниковный сбор в Рим.</span><span class="sxs-lookup"><span data-stu-id="2c67d-148">Our capture crew in Rome.</span></span> 


<span data-ttu-id="2c67d-149">После завершения поездки Scout был создан окончательный план для фактической пленки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-149">After the scout trip was completed, a final plan was made for actual filming.</span></span> <span data-ttu-id="2c67d-150">В этом случае требуется подробный список, где мы будем затронуть пленку, на какой день и в какое время.</span><span class="sxs-lookup"><span data-stu-id="2c67d-150">This required a detailed list of where we were going to film, on what day, and at what time.</span></span> <span data-ttu-id="2c67d-151">Каждый день занимает много ресурсов, поэтому эти поездки должны быть эффективными.</span><span class="sxs-lookup"><span data-stu-id="2c67d-151">Every day overseas is expensive, so these trips needed to be efficient.</span></span> <span data-ttu-id="2c67d-152">Мы зарезервированы руководства и обработчики в Рим, чтобы помочь нам и полностью использовать каждый день с момента восход солнца до заката.</span><span class="sxs-lookup"><span data-stu-id="2c67d-152">We booked guides and handlers in Rome to help us and fully used every day from before sunrise to after sunset.</span></span> <span data-ttu-id="2c67d-153">Нам нужно получить лучший материал, чтобы вы могли узнать, как это действительно действительно.</span><span class="sxs-lookup"><span data-stu-id="2c67d-153">We need to get the best footage possible in order to make you feel like you’re really there.</span></span>

### <a name="capturing-the-video"></a><span data-ttu-id="2c67d-154">Запись видео</span><span class="sxs-lookup"><span data-stu-id="2c67d-154">Capturing the video</span></span>

<span data-ttu-id="2c67d-155">Выполнение нескольких простых действий во время захвата может значительно упростить процесс обработки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-155">Doing a few simple things during capture can make post-processing much easier.</span></span> <span data-ttu-id="2c67d-156">Например, при объединении изображений из нескольких камер Вы прикончите визуальные артефакты, так как каждая камера имеет немного отличающееся представление.</span><span class="sxs-lookup"><span data-stu-id="2c67d-156">For example, whenever you stitch together images from multiple cameras, you end up with visual artifacts because each camera has a slightly different view.</span></span> <span data-ttu-id="2c67d-157">Более близкие объекты к камере, чем больше разница между представлениями, тем больше будет более крупными артефактами.</span><span class="sxs-lookup"><span data-stu-id="2c67d-157">The closer objects are to the camera, the larger the difference between the views, and the larger the stitching artifacts will be.</span></span> <span data-ttu-id="2c67d-158">Вот простой способ визуализации проблемы: Держите свой бегунок перед лицом и взгляните на него только с одним глазом.</span><span class="sxs-lookup"><span data-stu-id="2c67d-158">Here's an easy way to visualize the problem: hold your thumb up in front of your face and look at it with only one eye.</span></span> <span data-ttu-id="2c67d-159">Теперь переключите глаза.</span><span class="sxs-lookup"><span data-stu-id="2c67d-159">Now switch eyes.</span></span> <span data-ttu-id="2c67d-160">Вы увидите, что бегунок будет перемещаться относительно фона.</span><span class="sxs-lookup"><span data-stu-id="2c67d-160">You’ll see that your thumb appears to move relative to the background.</span></span> <span data-ttu-id="2c67d-161">Если вы держите бегунок дальше от вашего лица и повторите эксперимент, ваш бегунок будет двигаться меньше.</span><span class="sxs-lookup"><span data-stu-id="2c67d-161">If you hold your thumb further away from your face and repeat the experiment, your thumb will appear to move less.</span></span> <span data-ttu-id="2c67d-162">Очевидное движение похоже на проблему сшивания, о которой мы столкнулись: ваши глаза, такие как наши камеры, не видят точно тот же образ, так как они разделяются на небольшое расстояние.</span><span class="sxs-lookup"><span data-stu-id="2c67d-162">That apparent movement is similar to the stitching problem we faced: Your eyes, like our cameras, don’t see the exact same image because they are separated by a little distance.</span></span>

<span data-ttu-id="2c67d-163">Так как гораздо проще предотвратить худшее количество артефактов, но при их исправлении в ходе последующей обработки мы попытались отказаться от камеры в надеется, но мы могли бы исключить необходимость сшивания объектов.</span><span class="sxs-lookup"><span data-stu-id="2c67d-163">Because it’s much easier to prevent the worst artifacts while filming than it is to correct them in post-processing, we tried to keep people and things far away from the camera in the hopes we could eliminate the need to stitch close-up objects.</span></span> <span data-ttu-id="2c67d-164">Большая Очистка нашей камеры, возможно, была одной из крупнейших проблем, которые мы имели в процессе ее устранения, и нам пришлось приступить к работе.</span><span class="sxs-lookup"><span data-stu-id="2c67d-164">Maintaining a large clearing around our camera was probably one of the biggest challenges we had during shooting and we had to get creative to make it work.</span></span> <span data-ttu-id="2c67d-165">Работа с локальными руководствами была огромной справкой по управлению кровдс, но мы также обнаружили, что с помощью знаков, а иногда небольшие конес или Bean сумки, пометить пространство на пленке было достаточно эффективным, особенно потому, что нам нужно только получить небольшой объем материала в каждом месте.</span><span class="sxs-lookup"><span data-stu-id="2c67d-165">Working with local guides was a huge help in managing crowds, but we also found that using signs—and sometimes small cones or bean bags—to mark our filming space was reasonably effective, especially since we only needed to get a short amount of footage at each location.</span></span> <span data-ttu-id="2c67d-166">Как правило, лучшим способом получения хорошей записи было просто приступить к началу утром, прежде чем большинство людей попадают в нее.</span><span class="sxs-lookup"><span data-stu-id="2c67d-166">Often the best way to get a good capture was to just to arrive very early in the morning, before most people showed up.</span></span>

<span data-ttu-id="2c67d-167">Некоторые другие полезные методики записи поступают непосредственно на основе традиционных методов работы с фильмами.</span><span class="sxs-lookup"><span data-stu-id="2c67d-167">Some other useful capture techniques come straight from traditional film practices.</span></span> <span data-ttu-id="2c67d-168">Например, мы использовали карту коррекции цвета для всех камер и захваченные справочники по текстурам и объектам, которые могут потребоваться позже.</span><span class="sxs-lookup"><span data-stu-id="2c67d-168">For example, we used a color correction card on all of our cameras and captured reference photos of textures and objects we might need later.</span></span> 

![Вырезание Мачу Пикчу, в котором показана карта коррекции цвета.](images/rough-cut-machu-picchu-500px.png)

<span data-ttu-id="2c67d-170">Предварительное вырезание Pantheonного материала перед началом сшивания.</span><span class="sxs-lookup"><span data-stu-id="2c67d-170">A rough cut of Pantheon footage before stitching.</span></span>

### <a name="processing-the-video"></a><span data-ttu-id="2c67d-171">Обработка видео</span><span class="sxs-lookup"><span data-stu-id="2c67d-171">Processing the video</span></span>

<span data-ttu-id="2c67d-172">Захват содержимого 360 ° — это лишь первый шаг — для преобразования необработанного материала камеры, полученного в конечные ресурсы, который вы видите в Холотаур, требуется большой объем обработки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-172">Capturing 360° content is only the first step—a lot of processing is needed to convert the raw camera footage we captured into the final assets you see in HoloTour.</span></span> <span data-ttu-id="2c67d-173">Когда мы вернемся к домашней странице, нам потребовалось взять видео с 14 различных каналов камеры и превратить его в единое непрерывное видео с минимальными артефактами.</span><span class="sxs-lookup"><span data-stu-id="2c67d-173">Once we were back home we needed to take the video from 14 different camera feeds and turn it into a single continuous video with minimal artifacts.</span></span> <span data-ttu-id="2c67d-174">Наша группа использовала ряд инструментов для объединения и польского материала, и мы разработали конвейер для оптимизации обработки, насколько это возможно.</span><span class="sxs-lookup"><span data-stu-id="2c67d-174">Our art team used a number of tools to combine and polish the captured footage and we developed a pipeline to optimize the processing as much as possible.</span></span> <span data-ttu-id="2c67d-175">Этот материал должен быть соединен вместе, Исправлен цвет, а затем составить его, чтобы удалить ненужные элементы и артефакты или добавить дополнительные карманных устройствы жизни и движения, все с целью улучшения этого периода.</span><span class="sxs-lookup"><span data-stu-id="2c67d-175">The footage had to be stitched together, color corrected, and then composited to remove distracting elements and artifacts or to add supplemental pockets of life and motion, all with the goal to enhance that feeling of actually being there.</span></span>

![Предварительное вырезание Pantheonного материала перед началом сшивания.](images/rough-cut-pantheon-500px.png)

<span data-ttu-id="2c67d-177">Предварительное вырезание Pantheonного материала перед началом сшивания.</span><span class="sxs-lookup"><span data-stu-id="2c67d-177">A rough cut of Pantheon footage before stitching.</span></span> 


<span data-ttu-id="2c67d-178">Чтобы объединить видео, мы использовали средство с названием [птгуи](https://www.ptgui.com/) и интегрировано в наш конвейер обработки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-178">To stitch the videos together, we used a tool called [PTGui](https://www.ptgui.com/) and integrated it into our processing pipeline.</span></span> <span data-ttu-id="2c67d-179">Во время последующей обработки мы извлекли по-прежнему кадры из наших видеороликов и обнаружили шаблон сшивания, который хорошо подходит для одного из этих кадров.</span><span class="sxs-lookup"><span data-stu-id="2c67d-179">As part of post-processing we extracted still frames from our videos and found a stitching pattern that looked good for one of those frames.</span></span> <span data-ttu-id="2c67d-180">Затем мы применили этот шаблон к пользовательскому подключаемому модулю, написанному с помощью наших видеороликов, чтобы точно настроить шаблон сшивания и настроить его непосредственно во время компоновки в After Effects.</span><span class="sxs-lookup"><span data-stu-id="2c67d-180">We then applied that pattern to a custom plugin we wrote that allowed our video artists to fine tune and tweak the stitching pattern directly while compositing in After Effects.</span></span> 

![Снимок экрана Птгуи, иллюстрирующий Pantheonй материал.](images/stitching-tool-pantheon-500px.png)

<span data-ttu-id="2c67d-182">Снимок экрана Птгуи, иллюстрирующий Pantheonй материал.</span><span class="sxs-lookup"><span data-stu-id="2c67d-182">Screenshot of PTGui showing the stitched Pantheon footage.</span></span> 


### <a name="video-playback"></a><span data-ttu-id="2c67d-183">Воспроизведение видео</span><span class="sxs-lookup"><span data-stu-id="2c67d-183">Video playback</span></span>

<span data-ttu-id="2c67d-184">После завершения обработки материала у нас есть непрозрачный видеоролик, но он чрезвычайно большой — вокруг 8 Кбного разрешения.</span><span class="sxs-lookup"><span data-stu-id="2c67d-184">After processing of the footage is completed, we have a seamless video but it’s extraordinarily large—around 8K resolution.</span></span> <span data-ttu-id="2c67d-185">Декодирование видео является дорогостоящим, и есть несколько компьютеров, которые могут работать с 8 КБ видео, поэтому следующая задача найдет способ воспроизведения видео на HoloLens.</span><span class="sxs-lookup"><span data-stu-id="2c67d-185">Decoding video is expensive and there are very few computers that can handle an 8K video so the next challenge was finding a way to play this video back on HoloLens.</span></span> <span data-ttu-id="2c67d-186">Мы разработали ряд стратегий, которые позволят избежать затрат на декодирование, когда пользователь по-прежнему покажется, что он просматривает все видео.</span><span class="sxs-lookup"><span data-stu-id="2c67d-186">We developed a number of strategies to avoid the cost of decoding while still making the user feel like they were viewing the entire video.</span></span>

<span data-ttu-id="2c67d-187">Простейшая оптимизация заключается в том, чтобы избежать декодирования фрагментов видео, которые не меняются.</span><span class="sxs-lookup"><span data-stu-id="2c67d-187">The easiest optimization is to avoid decoding parts of the video that don’t change much.</span></span> <span data-ttu-id="2c67d-188">Мы написали средство для обнаружения областей в каждой сцене с небольшим движением или без них.</span><span class="sxs-lookup"><span data-stu-id="2c67d-188">We wrote a tool to identify areas in each scene that have little or no motion.</span></span> <span data-ttu-id="2c67d-189">Для этих регионов отображается статическое изображение, а не декодирование видео по каждому кадру.</span><span class="sxs-lookup"><span data-stu-id="2c67d-189">For those regions we show a static image rather than decoding a video each frame.</span></span> <span data-ttu-id="2c67d-190">Чтобы сделать это возможным, мы разбивает огромное видео на большие фрагменты.</span><span class="sxs-lookup"><span data-stu-id="2c67d-190">To make this possible, we divided up the massive video into much smaller chunks.</span></span>

<span data-ttu-id="2c67d-191">Мы также проделали, что каждый пиксель, декодированный, использовался наиболее эффективно.</span><span class="sxs-lookup"><span data-stu-id="2c67d-191">We also made sure that every pixel we decoded was used most effectively.</span></span> <span data-ttu-id="2c67d-192">Мы экспериментируем с методами сжатия, чтобы уменьшить размер видео. регионы видео разбиваются в соответствии с многоугольниками геометрической геометрии, на которую будет осуществляться проецирование. Мы настроили UVs и перефасованные видеоролики в зависимости от того, насколько подробно включены различные многоугольники.</span><span class="sxs-lookup"><span data-stu-id="2c67d-192">We experimented with compression techniques to lower the size of the video; we split the video regions according to the polygons of the geometry it would be projected onto; we adjusted UVs and repacked the videos based on how much detail different polygons included.</span></span> <span data-ttu-id="2c67d-193">Результатом этой работы является то, что началось в виде одного 8 КБ видео, которое было включено в несколько фрагментов, которые выглядят почти нечитаемыми до тех пор, пока они не будут правильно перепроецированы в сцену.</span><span class="sxs-lookup"><span data-stu-id="2c67d-193">The result of this work is that what started as a single 8k video turned into many chunks that look almost unintelligible until they are properly re-projected into the scene.</span></span> <span data-ttu-id="2c67d-194">Для разработчика игр, который понимает сопоставление текстур и UV-упаковку, это, вероятно, покажется знакомым.</span><span class="sxs-lookup"><span data-stu-id="2c67d-194">For a game developer who understands texture mapping and UV packing, this will probably look familiar.</span></span> 

![Полное представление Pantheon перед оптимизацией.](images/pantheon-before-optimization-500px.png) 

<span data-ttu-id="2c67d-196">Полное представление Pantheon перед оптимизацией.</span><span class="sxs-lookup"><span data-stu-id="2c67d-196">A full view of the Pantheon before optimizations.</span></span> 


![Правая половина Pantheon, обрабатывалась для воспроизведения видео.](images/pantheon-process-video-playback-500px.png) 

<span data-ttu-id="2c67d-198">Правая половина Pantheon, обрабатывалась для воспроизведения видео.</span><span class="sxs-lookup"><span data-stu-id="2c67d-198">The right half of the Pantheon, processed for video playback.</span></span> 


![Пример отдельной видеообласти после оптимизации и упаковки.](images/single-video-region-after-optimization-500px.png) 

<span data-ttu-id="2c67d-200">Пример отдельной видеообласти после оптимизации и упаковки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-200">Example of a single video region after optimization and packing.</span></span> 


<span data-ttu-id="2c67d-201">Еще один прием, который мы использовали, — избежать декодирования видео, которое активно не просматривается.</span><span class="sxs-lookup"><span data-stu-id="2c67d-201">Another trick we used was to avoid decoding video you aren’t actively viewing.</span></span> <span data-ttu-id="2c67d-202">В Холотаур вы можете видеть только часть полной сцены в любой момент времени.</span><span class="sxs-lookup"><span data-stu-id="2c67d-202">While in HoloTour, you can only see part of the full scene at any given moment.</span></span> <span data-ttu-id="2c67d-203">Мы декодированы видео только в пределах поля представления (фов) или вскоре за его пределами.</span><span class="sxs-lookup"><span data-stu-id="2c67d-203">We only decode videos within or shortly outside of your field of view (FOV).</span></span> <span data-ttu-id="2c67d-204">Когда вы поворачиваете свой головной компьютер, мы начали воспроизводить регионы видео, которые теперь находятся в фов, и прекращать воспроизведение, которые больше не находятся в нем.</span><span class="sxs-lookup"><span data-stu-id="2c67d-204">As you rotate your head, we start playing the regions of the video that are now in your FOV and stop playing ones that are no longer within it.</span></span> <span data-ttu-id="2c67d-205">Большинство людей даже не заметят, что это происходит, но если вы быстро перейдете, вы увидите, что видео займет еще одну секунду – в то же время вы увидите статический рисунок, который затем постепенно восстановится видео после того, как он будет готов.</span><span class="sxs-lookup"><span data-stu-id="2c67d-205">Most people won’t even notice this is happening, but if you turn around rapidly, you’ll see the video takes a second to start— in the meantime you’ll see a static image which then fades back to video once it’s ready.</span></span>

<span data-ttu-id="2c67d-206">Чтобы обеспечить эту стратегию, мы разработали обширную систему воспроизведения видео.</span><span class="sxs-lookup"><span data-stu-id="2c67d-206">To make this strategy work we developed an extensive video playback system.</span></span> <span data-ttu-id="2c67d-207">Оптимизирован код воспроизведения нижнего уровня, чтобы обеспечить чрезвычайно эффективное переключение видео.</span><span class="sxs-lookup"><span data-stu-id="2c67d-207">We optimized the low level playback code in order to make video switching extremely efficient.</span></span> <span data-ttu-id="2c67d-208">Кроме того, нам пришлось закодировать видео особым способом, чтобы можно было быстро переключиться на видео в любое время.</span><span class="sxs-lookup"><span data-stu-id="2c67d-208">Additionally, we had to encode our videos in a special way to make it possible to rapidly switch to any video at any time.</span></span> <span data-ttu-id="2c67d-209">Этот конвейер воспроизведения занял значительный объем времени разработки, поэтому мы реализовали его поэтапно.</span><span class="sxs-lookup"><span data-stu-id="2c67d-209">This playback pipeline took a significant amount of development time so we implemented it in stages.</span></span> <span data-ttu-id="2c67d-210">Мы начали использовать более простую систему, которая была менее эффективной, но позволяла дизайнерам и исполнителям работать над интерфейсом и медленно улучшить ее до более надежной системы воспроизведения, которая позволила бы нам поставляться на окончательной панели качества.</span><span class="sxs-lookup"><span data-stu-id="2c67d-210">We started with a simpler system that was less efficient, but allowed designers and artists to work on the experience, and slowly improved it to a more robust playback system that allowed us to ship at the final quality bar.</span></span> <span data-ttu-id="2c67d-211">В этой конечной системе были созданы пользовательские инструменты, созданные в Unity для настройки видео в сцене и мониторинга подсистемы воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="2c67d-211">This final system had custom tools we created within Unity to set up the video within the scene and monitor the playback engine.</span></span>

### <a name="recreating-near-space-objects-in-3d"></a><span data-ttu-id="2c67d-212">Повторное создание объектов, близких к месту, в трехмерном пространстве</span><span class="sxs-lookup"><span data-stu-id="2c67d-212">Recreating near-space objects in 3D</span></span>

<span data-ttu-id="2c67d-213">Видеоролики составляют большую часть того, что вы видите в Холотаур, но существует ряд трехмерных объектов, которые выглядят ближе к вам, например, рисование в Пиазза Навона, фаунтаин за пределами Pantheon или всплывающая подсказка, используемая для аэрофотосъемки сцен.</span><span class="sxs-lookup"><span data-stu-id="2c67d-213">Videos make up the majority of what you see in HoloTour, but there are a number of 3D objects that appear close to you, such as the painting in Piazza Navona, the fountain outside the Pantheon, or the hot air balloon you stand in for aerial scenes.</span></span> <span data-ttu-id="2c67d-214">Эти трехмерные объекты важны, так как человеческие ощущения очень хорошо близко, но не слишком далеко.</span><span class="sxs-lookup"><span data-stu-id="2c67d-214">These 3D objects are important because human depth perception is very good up close, but not very good far away.</span></span> <span data-ttu-id="2c67d-215">Мы можем отказаться от видео на расстоянии, но чтобы позволить пользователям проанализировать свое пространство, как на самом деле, соседние объекты нуждаются в глубине.</span><span class="sxs-lookup"><span data-stu-id="2c67d-215">We can get away with video in the distance, but to allow users to walk around their space and feel like they’re really there, nearby objects need depth.</span></span> <span data-ttu-id="2c67d-216">Этот метод аналогичен тому, который можно увидеть в естественном музей — на рисунке диорама, который имеет физические ландскапинг, растения и животные чучел на переднем плане, но перемещается в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="2c67d-216">This technique is similar to the sort of thing you might see in a natural history museum—picture a diorama that has physical landscaping, plants, and animal specimens in the foreground, but recedes into a cleverly masked matte painting in the background.</span></span>

<span data-ttu-id="2c67d-217">Некоторые объекты — это просто трехмерные ресурсы, которые мы создали и добавили в сцену для улучшения работы.</span><span class="sxs-lookup"><span data-stu-id="2c67d-217">Some objects are simply 3D assets we created and added to the scene to enhance the experience.</span></span> <span data-ttu-id="2c67d-218">Рисование и всплывающая подсказка воздуха попадают в эту категорию, так как они не были представлены на пленке.</span><span class="sxs-lookup"><span data-stu-id="2c67d-218">The painting and the hot air balloon fall into this category because they weren’t present when we filmed.</span></span> <span data-ttu-id="2c67d-219">Как и ресурсы игры, они были созданы трехмерным исполнителем в нашей группе и соответствующим образом текстурированы.</span><span class="sxs-lookup"><span data-stu-id="2c67d-219">Similar to game assets, they were created by a 3D artist on our team and textured appropriately.</span></span> <span data-ttu-id="2c67d-220">Мы разместите их в нашей сцене рядом с тем местом, где вы размещаете, и модуль игры может отобразить их в два вида HoloLens, чтобы они отображались в виде трехмерного объекта.</span><span class="sxs-lookup"><span data-stu-id="2c67d-220">We place these in our scenes near where you stand, and the game engine can render them to the two HoloLens displays so that they appear as a 3D object.</span></span>

<span data-ttu-id="2c67d-221">Другие активы, такие как фаунтаин за пределами Pantheon, являются реальными объектами, которые существуют в расположениях, где мы относим видео, но для переноса этих объектов из видео и трехмерной графики необходимо выполнить ряд действий.</span><span class="sxs-lookup"><span data-stu-id="2c67d-221">Other assets, like the fountain outside the Pantheon, are real objects that exist in the locations where we're shooting video, but to bring these objects out of the video and into 3D, we have to do a number of things.</span></span>

<span data-ttu-id="2c67d-222">Сначала требуется дополнительная информация о каждом объекте.</span><span class="sxs-lookup"><span data-stu-id="2c67d-222">First, we need additional information about each object.</span></span> <span data-ttu-id="2c67d-223">В то время как для фотопленки наша группа записала множество справочных материалов по этим объектам, чтобы было достаточно подробных изображений для правильного воссоздания текстур.</span><span class="sxs-lookup"><span data-stu-id="2c67d-223">While on location for filming, our team captured a lot of reference footage of these objects so that we would have enough detailed images to accurately recreate the textures.</span></span> <span data-ttu-id="2c67d-224">Группа также выполнила проверку [фотограмметри](https://en.wikipedia.org/wiki/Photogrammetry) , которая строит трехмерную модель из десятков 2D-изображений, что дает нам приблизительную модель объекта в идеальном масштабе.</span><span class="sxs-lookup"><span data-stu-id="2c67d-224">The team also performed a [photogrammetry](https://en.wikipedia.org/wiki/Photogrammetry) scan, which constructs a 3D model from dozens of 2D images, giving us a rough model of the object at perfect scale.</span></span>

<span data-ttu-id="2c67d-225">По мере обработки нашего материала объекты, которые позже будут заменены трехмерным представлением, удаляются из видео.</span><span class="sxs-lookup"><span data-stu-id="2c67d-225">As we process our footage, objects that will later be replaced with a 3D representation are removed from the video.</span></span> <span data-ttu-id="2c67d-226">Трехмерный ресурс основан на модели фотограмметри, но очищен и упрощен нашими исполнителями.</span><span class="sxs-lookup"><span data-stu-id="2c67d-226">The 3D asset is based on the photogrammetry model but cleaned up and simplified by our artists.</span></span> <span data-ttu-id="2c67d-227">Для некоторых объектов мы можем использовать части видео (например, текстуру воды в фаунтаине), но большая часть фаунтаин теперь является трехмерным объектом, что позволяет пользователям воспринимать глубину и обходить ее в ограниченном пространстве в интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="2c67d-227">For some objects, we can use parts of the video—such as the water texture on the fountain—but most of the fountain is now a 3D object, which allows users to perceive depth and walk around it in a limited space in the experience.</span></span> <span data-ttu-id="2c67d-228">Наличие объектов практическиго пространства, таких как, значительно увеличивает смысл реальных данных и помогает пользователям навести себя на виртуальные точки.</span><span class="sxs-lookup"><span data-stu-id="2c67d-228">Having near-space objects like this greatly adds to the sense of realism and helps to ground the users in the virtual location.</span></span> 

![Pantheonный материал с удаленным фаунтаин.](images/object-removal-pantheon-500px.png)

<span data-ttu-id="2c67d-231">Pantheonный материал с удаленным фаунтаин.</span><span class="sxs-lookup"><span data-stu-id="2c67d-231">Pantheon footage with the fountain removed.</span></span> <span data-ttu-id="2c67d-232">Он будет заменен на 3D-ресурс.</span><span class="sxs-lookup"><span data-stu-id="2c67d-232">It will be replaced with a 3D asset.</span></span>


## <a name="final-thoughts"></a><span data-ttu-id="2c67d-233">В заключение</span><span class="sxs-lookup"><span data-stu-id="2c67d-233">Final thoughts</span></span>

<span data-ttu-id="2c67d-234">Очевидно, что создание этого содержимого было больше, чем мы обсуждали здесь.</span><span class="sxs-lookup"><span data-stu-id="2c67d-234">Obviously, there was more to creating this content than what we've discussed here.</span></span> <span data-ttu-id="2c67d-235">Существует несколько сцен: мы хотим назвать их «невозможными перспективами», включая всплывающие окна горячего воздуха и Гладиатор борьба в Колоссеум, что занимало более творческий подход.</span><span class="sxs-lookup"><span data-stu-id="2c67d-235">There are a few scenes—we like to call them "impossible perspectives"—including the hot air balloon ride and the gladiator fight in the Colosseum, which took a more creative approach.</span></span> <span data-ttu-id="2c67d-236">Мы будем решать эти ситуации в будущем.</span><span class="sxs-lookup"><span data-stu-id="2c67d-236">We'll address these in a future case study.</span></span>

<span data-ttu-id="2c67d-237">Мы надеемся, что совместное использование решений с некоторыми более крупными задачами, которые мы имели в рабочей среде, было полезным для других разработчиков, и вы будете использовать некоторые из этих методов для создания собственных впечатляющих возможностей HoloLens.</span><span class="sxs-lookup"><span data-stu-id="2c67d-237">We hope that sharing solutions to some of the bigger challenges we had during production is helpful to other developers and that you're inspired to use some of these techniques to create your own immersive experiences for HoloLens.</span></span> <span data-ttu-id="2c67d-238">(Если вы сделаете это, не забудьте поделиться им с нами на [форуме по разработке приложений HoloLens](https://forums.hololens.com/)!)</span><span class="sxs-lookup"><span data-stu-id="2c67d-238">(And if you do, please make sure to share it with us on the [HoloLens App Development forum](https://forums.hololens.com/)!)</span></span>

## <a name="about-the-authors"></a><span data-ttu-id="2c67d-239">Об авторах</span><span class="sxs-lookup"><span data-stu-id="2c67d-239">About the authors</span></span>

<table style="border:0">
<tr>
<td style="border:0" width="60px"> <img alt="David Haley" width="60" height="60" src="images/haley.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="2c67d-240"><b>Дэвид халэй</b> — старший разработчик, получивший больше внимания на платформах камеры и воспроизведении видео, чем это было возможно от работы над холотаур.</span><span class="sxs-lookup"><span data-stu-id="2c67d-240"><b>David Haley</b> is a Senior Developer who learned more about camera rigs and video playback than he thought possible from working on HoloTour.</span></span></td>
<td style="border:0" width="60px"> <img alt="Danny Askew" width="60" height="60" src="images/askew.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="2c67d-241"><b>Дэнни аскев</b> — это видеоисполнитель, который уверен, что ваш путешествие через Рим был как можно более безупречным.</span><span class="sxs-lookup"><span data-stu-id="2c67d-241"><b>Danny Askew</b> is a Video Artist who made sure your journey through Rome was as flawless as possible.</span></span></td>
</tr>
<tr>
<td style="border:0" width="60px"> <img alt="Jason Syltebo" width="60" height="60" src="images/syltebo.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="2c67d-242"><b>Джейсон силтебо</b> — это конструктор аудио, который уверен в том, что вы можете столкнуться с саундскапеами всех мест назначения, даже когда вы перейдете назад.</span><span class="sxs-lookup"><span data-stu-id="2c67d-242"><b>Jason Syltebo</b> is an Audio Designer who made sure you could experience the soundscape of every destination you visit, even when you go back in time.</span></span></td>
<td style="border:0" width="60px"> <img alt="Travis Steiner" width="60" height="60" src="images/steiner.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="2c67d-243"><b>Travis Стеинер</b> — это директор по проектированию, который проработал в должности и намерена ее местоположение, создал планы поездки и намерена пропленки на сайте.</span><span class="sxs-lookup"><span data-stu-id="2c67d-243"><b>Travis Steiner</b> is a Design Director who researched and scouted locations, created trip plans, and directed filming on site.</span></span></td>
</tr>
</table>



## <a name="see-also"></a><span data-ttu-id="2c67d-244">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="2c67d-244">See also</span></span>
* [<span data-ttu-id="2c67d-245">Видео: Microsoft HoloLens: Холотаур</span><span class="sxs-lookup"><span data-stu-id="2c67d-245">Video: Microsoft HoloLens: HoloTour</span></span>](https://www.youtube.com/watch?v=pLd9WPlaMpY)
