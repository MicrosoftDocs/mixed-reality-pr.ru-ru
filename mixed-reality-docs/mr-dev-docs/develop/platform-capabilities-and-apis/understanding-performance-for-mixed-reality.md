---
title: Основные сведения о производительности смешанной реальности
description: Дополнительные сведения и сведения для анализа и оптимизации производительности приложений Windows Mixed Reality.
author: hferrone
ms.author: v-hferrone
ms.date: 3/26/2019
ms.topic: article
keywords: Windows Mixed Reality, Смешанная реальность, виртуальная реальность, VR, MR, производительность, оптимизация, ЦП, GPU
ms.openlocfilehash: d0218902864586e678f6d51dfade58bd567bcc02
ms.sourcegitcommit: 3236abcba27335fe3d52e38423d2b265ca883355
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2021
ms.locfileid: "106269960"
---
# <a name="understanding-performance-for-mixed-reality"></a><span data-ttu-id="4ed70-104">Основные сведения о производительности смешанной реальности</span><span class="sxs-lookup"><span data-stu-id="4ed70-104">Understanding performance for mixed reality</span></span>

<span data-ttu-id="4ed70-105">В этой статье приводятся общие сведения о значимости производительности для приложения смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="4ed70-105">This article is an introduction to understanding the significance of performance for your Mixed Reality app.</span></span>  <span data-ttu-id="4ed70-106">Работа пользователей может быть значительно снижена, если приложение не работает с оптимальной частотой кадров.</span><span class="sxs-lookup"><span data-stu-id="4ed70-106">User experience can be greatly degraded if your application doesn't run at optimal frame rate.</span></span> <span data-ttu-id="4ed70-107">Голограммы будут отображаться нестабильно, а отслеживание головного окружения будет неточным, что приведет к ухудшению работы пользователя.</span><span class="sxs-lookup"><span data-stu-id="4ed70-107">Holograms will appear unstable and head tracking of the environment will be inaccurate, leading to a poor experience for the user.</span></span> <span data-ttu-id="4ed70-108">Производительность должна рассматриваться как первая функция класса для разработки смешанной реальности, а не для польской задачи.</span><span class="sxs-lookup"><span data-stu-id="4ed70-108">Performance must be considered a first class feature for mixed reality development and not a polish task.</span></span>

<span data-ttu-id="4ed70-109">Недавно мы выпустили приложение с названием "основы качества", которое охватывает общие проблемы с производительностью, проектированием и средой и решениями для приложений HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="4ed70-109">We recently released an application called Quality Fundamentals that covers common performance, design, and environment issues and solutions for HoloLens 2 apps.</span></span> <span data-ttu-id="4ed70-110">Это приложение является великолепной визуальной демонстрацией для содержимого, приведенного ниже.</span><span class="sxs-lookup"><span data-stu-id="4ed70-110">This app is a great visual demo for the content the follows.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="4ed70-111">Скачать приложение "основы качества"</span><span class="sxs-lookup"><span data-stu-id="4ed70-111">Download the Quality Fundamentals app</span></span>](https://www.microsoft.com/en-us/p/quality-fundamentals/9mwz852q88fw)

<span data-ttu-id="4ed70-112">Ниже перечислены значения для выполнения частоты кадров для каждой целевой платформы.</span><span class="sxs-lookup"><span data-stu-id="4ed70-112">The performant framerate values for each target platform are listed below.</span></span>

| <span data-ttu-id="4ed70-113">Платформа</span><span class="sxs-lookup"><span data-stu-id="4ed70-113">Platform</span></span> | <span data-ttu-id="4ed70-114">Частота целевых кадров</span><span class="sxs-lookup"><span data-stu-id="4ed70-114">Target Frame Rate</span></span> |
|----------|-------------------|
| [<span data-ttu-id="4ed70-115">HoloLens</span><span class="sxs-lookup"><span data-stu-id="4ed70-115">HoloLens</span></span>](/hololens/hololens1-hardware) | <span data-ttu-id="4ed70-116">60 кадров/с</span><span class="sxs-lookup"><span data-stu-id="4ed70-116">60 FPS</span></span> |
| [<span data-ttu-id="4ed70-117">Портативные компьютеры Windows Mixed Reality</span><span class="sxs-lookup"><span data-stu-id="4ed70-117">Windows Mixed Reality Ultra PCs</span></span>](../../discover/immersive-headset-hardware-details.md) | <span data-ttu-id="4ed70-118">90 КАДРОВ/С</span><span class="sxs-lookup"><span data-stu-id="4ed70-118">90 FPS</span></span> |
| [<span data-ttu-id="4ed70-119">Компьютеры Windows Mixed Reality</span><span class="sxs-lookup"><span data-stu-id="4ed70-119">Windows Mixed Reality PCs</span></span>](../../discover/immersive-headset-hardware-details.md) | <span data-ttu-id="4ed70-120">60 кадров/с</span><span class="sxs-lookup"><span data-stu-id="4ed70-120">60 FPS</span></span> |

<span data-ttu-id="4ed70-121">В приведенной ниже структуре представлены рекомендации по использованию ставок целевых кадров.</span><span class="sxs-lookup"><span data-stu-id="4ed70-121">The framework below outlines best practices for hitting target frame rates.</span></span> <span data-ttu-id="4ed70-122">Мы рекомендуем ознакомиться со [статьей рекомендации по производительности для Unity](../unity/performance-recommendations-for-unity.md) , чтобы получить советы по измерению и улучшению частоты кадров в среде Unity.</span><span class="sxs-lookup"><span data-stu-id="4ed70-122">We recommend reading the [performance recommendations for Unity article](../unity/performance-recommendations-for-unity.md) for tips on measuring and improving framerate in the Unity environment.</span></span>

## <a name="understanding-performance-bottlenecks"></a><span data-ttu-id="4ed70-123">Основные сведения о узких местах производительности</span><span class="sxs-lookup"><span data-stu-id="4ed70-123">Understanding performance bottlenecks</span></span>

<span data-ttu-id="4ed70-124">Если приложение имеет небольшую частоту кадров, первый шаг состоит в анализе и понимании того, где приложение получает ресурсоемкие вычисления.</span><span class="sxs-lookup"><span data-stu-id="4ed70-124">If your app has an underperforming framerate, the first step is to analyze and understand where your application is computationally intensive.</span></span> <span data-ttu-id="4ed70-125">Существует два основных процессора, ответственных за работу с визуализацией сцены: ЦП и GPU, каждый из которых обрабатывает различные аспекты приложения смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="4ed70-125">There are two primary processors responsible for the work to render your scene: the CPU and the GPU, each handling different aspects of your Mixed Reality app.</span></span> <span data-ttu-id="4ed70-126">Ниже приведены три ключевых места, где могут возникнуть узкие места:</span><span class="sxs-lookup"><span data-stu-id="4ed70-126">The three key places where bottlenecks may occur are:</span></span> 

1. <span data-ttu-id="4ed70-127">**Поток приложения — ЦП** -
    Отвечает за логику приложения, включая обработку входных данных, анимацию, физику и другую логику приложения.</span><span class="sxs-lookup"><span data-stu-id="4ed70-127">**App Thread - CPU** -
 Responsible for your app logic, including processing input, animations, physics, and other app logic.</span></span>
2. <span data-ttu-id="4ed70-128">**Прорисовка потока — ЦП в GPU** — отвечает за отправку вызовов рисования в GPU.</span><span class="sxs-lookup"><span data-stu-id="4ed70-128">**Render Thread - CPU to GPU** - Responsible for submitting your draw calls to the GPU.</span></span> <span data-ttu-id="4ed70-129">Когда приложение хочет отобразить объект, например куб или модель, этот поток отправляет в графический процессор запрос на выполнение операций.</span><span class="sxs-lookup"><span data-stu-id="4ed70-129">When your app wants to render an object such as a cube or model, this thread sends a request to the GPU to do the operations.</span></span>
3. <span data-ttu-id="4ed70-130">**GPU** — чаще всего обрабатывает графический конвейер приложения для преобразования трехмерных данных (моделей, текстур и т. д.) в пиксели.</span><span class="sxs-lookup"><span data-stu-id="4ed70-130">**GPU** - Most commonly handles the graphics pipeline of your application to transform 3D data (models, textures, and so on) into pixels.</span></span> <span data-ttu-id="4ed70-131">В итоге он создает 2D-образ для отправки на экран устройства.</span><span class="sxs-lookup"><span data-stu-id="4ed70-131">It ultimately produces a 2D image to submit to your device's screen.</span></span>

![Время существования кадра](images/lifetime-of-a-frame.png)

<span data-ttu-id="4ed70-133">Как правило, приложения HoloLens будут привязаны к GPU, но не всегда.</span><span class="sxs-lookup"><span data-stu-id="4ed70-133">Generally, HoloLens applications will be GPU bound, but not always.</span></span> <span data-ttu-id="4ed70-134">Используйте приведенные ниже средства и методики, чтобы понять, где размещается узкие места в конкретном приложении.</span><span class="sxs-lookup"><span data-stu-id="4ed70-134">Use the tools and techniques below to understand where your particular app is bottlenecked.</span></span>

## <a name="how-to-analyze-your-application"></a><span data-ttu-id="4ed70-135">Анализ приложения</span><span class="sxs-lookup"><span data-stu-id="4ed70-135">How to analyze your application</span></span>

<span data-ttu-id="4ed70-136">Существует множество средств, позволяющих понять профиль производительности и потенциальные узкие места в приложении смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="4ed70-136">There are many tools that allow you to understand the performance profile and potential bottlenecks in your mixed reality application.</span></span> 

<span data-ttu-id="4ed70-137">Ниже приведены некоторые распространенные средства, помогающие собрать подробные сведения о профилировании для приложения.</span><span class="sxs-lookup"><span data-stu-id="4ed70-137">Below are some common tools to help you gather deep profiling information for your application:</span></span>
- [<span data-ttu-id="4ed70-138">Анализаторы производительности графики Intel</span><span class="sxs-lookup"><span data-stu-id="4ed70-138">Intel Graphics Performance Analyzers</span></span>](https://software.intel.com/gpa)
- [<span data-ttu-id="4ed70-139">Отладчики графики Visual Studio</span><span class="sxs-lookup"><span data-stu-id="4ed70-139">Visual Studio Graphics Debuggers</span></span>](/visualstudio/debugger/graphics/visual-studio-graphics-diagnostics)
- [<span data-ttu-id="4ed70-140">Профилировщик Unity</span><span class="sxs-lookup"><span data-stu-id="4ed70-140">Unity Profiler</span></span>](https://docs.unity3d.com/Manual/Profiler.html)
- [<span data-ttu-id="4ed70-141">Отладчик фреймов Unity</span><span class="sxs-lookup"><span data-stu-id="4ed70-141">Unity Frame Debugger</span></span>](https://docs.unity3d.com/Manual/FrameDebugger.html)
- [<span data-ttu-id="4ed70-142">Неreal Insights</span><span class="sxs-lookup"><span data-stu-id="4ed70-142">Unreal Insights</span></span>](../unreal/unreal-insights.md)
- [<span data-ttu-id="4ed70-143">ЭКРАНА</span><span class="sxs-lookup"><span data-stu-id="4ed70-143">PIX</span></span>](https://devblogs.microsoft.com/pix/)
- [<span data-ttu-id="4ed70-144">Пофилинг GPU в нереальном режиме</span><span class="sxs-lookup"><span data-stu-id="4ed70-144">GPU Pofiling in Unreal</span></span>](https://docs.unrealengine.com/en-US/TestingAndOptimization/PerformanceAndProfiling/GPU/index.html)

### <a name="how-to-profile-in-any-environment"></a><span data-ttu-id="4ed70-145">Профилирование в любой среде</span><span class="sxs-lookup"><span data-stu-id="4ed70-145">How to profile in any environment</span></span>

<span data-ttu-id="4ed70-146">Один из способов определить, является ли приложение процессором GPU или ЦП, — снизить разрешение выходных данных целевого объекта отрисовки.</span><span class="sxs-lookup"><span data-stu-id="4ed70-146">One way to determine if your app is GPU or CPU bound is to lower the resolution of the render target output.</span></span> <span data-ttu-id="4ed70-147">Уменьшая количество пикселей для вычисления, вы сокращаете нагрузку на GPU.</span><span class="sxs-lookup"><span data-stu-id="4ed70-147">By reducing the number of pixels to calculate, you'll reduce your GPU load.</span></span> <span data-ttu-id="4ed70-148">Устройство будет отображаться в текстуре меньшего размера, а затем — в виде образца, чтобы отобразить окончательный образ.</span><span class="sxs-lookup"><span data-stu-id="4ed70-148">The device will render to a smaller texture, then up-sample to display your final image.</span></span>

<span data-ttu-id="4ed70-149">При понижении разрешения отрисовки, если:</span><span class="sxs-lookup"><span data-stu-id="4ed70-149">After lowering rendering resolution, if:</span></span>
1) <span data-ttu-id="4ed70-150">Частота приложений **увеличивается**, и вы, скорее всего, **привязаны к GPU**</span><span class="sxs-lookup"><span data-stu-id="4ed70-150">Application framerate **increases**, then you're likely **GPU Bound**</span></span>
1) <span data-ttu-id="4ed70-151">Частота кадров приложения не **изменилась**, скорее всего, **с границей ЦП**</span><span class="sxs-lookup"><span data-stu-id="4ed70-151">Application framerate **unchanged**, then you're likely **CPU Bound**</span></span>

>[!NOTE]
><span data-ttu-id="4ed70-152">Unity предоставляет возможность легко изменять разрешение целевого объекта отрисовки приложения во время выполнения с помощью свойства *[ксрсеттингс. рендервиевпортскале](https://docs.unity3d.com/ScriptReference/XR.XRSettings-renderViewportScale.html)* .</span><span class="sxs-lookup"><span data-stu-id="4ed70-152">Unity provides the ability to easily modify the render target resolution of your application at runtime through the *[XRSettings.renderViewportScale](https://docs.unity3d.com/ScriptReference/XR.XRSettings-renderViewportScale.html)* property.</span></span> <span data-ttu-id="4ed70-153">Конечный образ, представленный на устройстве, имеет фиксированное разрешение.</span><span class="sxs-lookup"><span data-stu-id="4ed70-153">The final image presented on device has a fixed resolution.</span></span> <span data-ttu-id="4ed70-154">Платформа будет выполнять выборку выходных данных с низким разрешением для создания изображения более высокого разрешения для отображения на экране.</span><span class="sxs-lookup"><span data-stu-id="4ed70-154">The platform will sample the lower resolution output to build a higher resolution image for rendering on displays.</span></span> 
>
>```CS
>UnityEngine.XR.XRSettings.renderScale = 0.7f;
>```

## <a name="how-to-improve-your-application"></a><span data-ttu-id="4ed70-155">Как улучшить приложение</span><span class="sxs-lookup"><span data-stu-id="4ed70-155">How to improve your application</span></span>

### <a name="cpu-performance-recommendations"></a><span data-ttu-id="4ed70-156">Рекомендации по производительности ЦП</span><span class="sxs-lookup"><span data-stu-id="4ed70-156">CPU performance recommendations</span></span>

<span data-ttu-id="4ed70-157">Как правило, большинство работы в приложении смешанной реальности на ЦП предполагает выполнение "моделирования" сцены и обработку логики приложения.</span><span class="sxs-lookup"><span data-stu-id="4ed70-157">Generally, most work in a mixed reality application on the CPU involves doing the "simulation" of the scene and processing your application logic.</span></span> <span data-ttu-id="4ed70-158">Следующие области предназначены для оптимизации:</span><span class="sxs-lookup"><span data-stu-id="4ed70-158">The following areas are targeted for optimization:</span></span>

- <span data-ttu-id="4ed70-159">Анимации</span><span class="sxs-lookup"><span data-stu-id="4ed70-159">Animations</span></span>
- <span data-ttu-id="4ed70-160">Физика</span><span class="sxs-lookup"><span data-stu-id="4ed70-160">Physics</span></span>
- <span data-ttu-id="4ed70-161">Выделение памяти</span><span class="sxs-lookup"><span data-stu-id="4ed70-161">Memory allocations</span></span>
- <span data-ttu-id="4ed70-162">Сложные алгоритмы (т. е.</span><span class="sxs-lookup"><span data-stu-id="4ed70-162">Complex algorithms (i.e</span></span> <span data-ttu-id="4ed70-163">Обратная кинематика, поиск по пути)</span><span class="sxs-lookup"><span data-stu-id="4ed70-163">inverse kinematics, path-finding)</span></span>

### <a name="gpu-performance-recommendations"></a><span data-ttu-id="4ed70-164">Рекомендации по производительности GPU</span><span class="sxs-lookup"><span data-stu-id="4ed70-164">GPU performance recommendations</span></span>

#### <a name="understanding-bandwidth-vs-fill-rate"></a><span data-ttu-id="4ed70-165">Общие сведения о пропускной способности и скорости заполнения</span><span class="sxs-lookup"><span data-stu-id="4ed70-165">Understanding bandwidth vs. fill rate</span></span>
<span data-ttu-id="4ed70-166">При отрисовке кадра на GPU приложение либо ограничивается пропускной способностью памяти, либо скоростью заполнения.</span><span class="sxs-lookup"><span data-stu-id="4ed70-166">When rendering a frame on the GPU, an application is either bound by memory bandwidth or fill rate.</span></span>

- <span data-ttu-id="4ed70-167">**Пропускная способность памяти** — это частота операций чтения и записи, которую GPU может выполнять из памяти.</span><span class="sxs-lookup"><span data-stu-id="4ed70-167">**Memory bandwidth** is the rate of reads and writes the GPU can do from memory</span></span>
    - <span data-ttu-id="4ed70-168">Чтобы определить ограничения пропускной способности, уменьшите качество текстуры и проверьте, увеличилась ли частота кадров.</span><span class="sxs-lookup"><span data-stu-id="4ed70-168">To identify bandwidth limitations, reduce texture quality and check if the framerate has improved.</span></span>
    - <span data-ttu-id="4ed70-169">В Unity измените **качество текстуры** в окне **изменение** параметров  >  **проекта** параметры  >  **[качества](https://docs.unity3d.com/Manual/class-QualitySettings.html)**.</span><span class="sxs-lookup"><span data-stu-id="4ed70-169">In Unity, change **Texture Quality** in **Edit** > **Project Settings** > **[Quality Settings](https://docs.unity3d.com/Manual/class-QualitySettings.html)**.</span></span>
- <span data-ttu-id="4ed70-170">**Коэффициент заполнения** относится к пикселям, которые могут быть выведены в секунду графическим процессором.</span><span class="sxs-lookup"><span data-stu-id="4ed70-170">**Fill rate** refers to the pixels that can be drawn per second by the GPU.</span></span>
    - <span data-ttu-id="4ed70-171">Чтобы определить ограничения скорости заполнения, уменьшите разрешение экрана и проверьте, увеличилась ли частота кадров.</span><span class="sxs-lookup"><span data-stu-id="4ed70-171">To identify fill rate limitations, lower the display resolution and check if framerate improved.</span></span> 
    - <span data-ttu-id="4ed70-172">В Unity используйте свойство *[ксрсеттингс. рендервиевпортскале.](https://docs.unity3d.com/ScriptReference/XR.XRSettings-renderViewportScale.html)*</span><span class="sxs-lookup"><span data-stu-id="4ed70-172">In Unity, use the  *[XRSettings.renderViewportScale](https://docs.unity3d.com/ScriptReference/XR.XRSettings-renderViewportScale.html)* property</span></span>

<span data-ttu-id="4ed70-173">Пропускная способность памяти обычно включает оптимизацию для одного из следующих вариантов:</span><span class="sxs-lookup"><span data-stu-id="4ed70-173">Memory bandwidth generally involves optimizations to either:</span></span>
1) <span data-ttu-id="4ed70-174">Уменьшение разрешений текстуры</span><span class="sxs-lookup"><span data-stu-id="4ed70-174">Lower texture resolutions</span></span>
2) <span data-ttu-id="4ed70-175">Использование меньшего числа текстур (нормалей, отраженных и т. д.)</span><span class="sxs-lookup"><span data-stu-id="4ed70-175">Use fewer textures (normals, specular, and so on)</span></span>

<span data-ttu-id="4ed70-176">Скорость заполнения сосредоточена на уменьшении количества операций, которые необходимо вычислить для итогового отрисованного пикселя, включая:</span><span class="sxs-lookup"><span data-stu-id="4ed70-176">Fill rate is focused on reducing the number of operations that need to be computed for a final rendered pixel, including:</span></span>
1) <span data-ttu-id="4ed70-177">Число объектов для отрисовки или обработки</span><span class="sxs-lookup"><span data-stu-id="4ed70-177">Number of objects to render/process</span></span>
2) <span data-ttu-id="4ed70-178">Число операций на шейдер</span><span class="sxs-lookup"><span data-stu-id="4ed70-178">Number of operations per shader</span></span>
3) <span data-ttu-id="4ed70-179">Число стадий GPU до окончательного результата (шейдеры Geometry, эффекты последующей обработки и т. д.)</span><span class="sxs-lookup"><span data-stu-id="4ed70-179">Number of GPU stages to final result (geometry shaders, post-processing effects, and so on)</span></span>
4) <span data-ttu-id="4ed70-180">Число пикселей для отрисовки (разрешение экрана)</span><span class="sxs-lookup"><span data-stu-id="4ed70-180">Number of pixels to render (display resolution)</span></span>

#### <a name="reduce-polygon-count"></a><span data-ttu-id="4ed70-181">Уменьшить число многоугольников</span><span class="sxs-lookup"><span data-stu-id="4ed70-181">Reduce polygon count</span></span>

<span data-ttu-id="4ed70-182">Чем больше число многоугольников, тем больше операций для GPU, тем самым [уменьшая количество многоугольников](/dynamics365/mixed-reality/import-tool/optimize-models#performance-targets) в сцене, тем меньше время визуализации.</span><span class="sxs-lookup"><span data-stu-id="4ed70-182">Higher polygon counts result in more operations for the GPU, so [reducing the number of polygons](/dynamics365/mixed-reality/import-tool/optimize-models#performance-targets) in your scene reduces the render time.</span></span> <span data-ttu-id="4ed70-183">Есть и другие факторы, которые делают геометрические объекты геометрическими, но количество многоугольников является самой простой метрикой, определяющей объем работы, которую займет визуализация сцены.</span><span class="sxs-lookup"><span data-stu-id="4ed70-183">There are other factors that make shading the geometry expensive, but polygon count is the simplest metric to determine how much work it will take to render a scene.</span></span>

#### <a name="limit-overdraw"></a><span data-ttu-id="4ed70-184">Ограничение перерисовки</span><span class="sxs-lookup"><span data-stu-id="4ed70-184">Limit overdraw</span></span>

<span data-ttu-id="4ed70-185">Высокая перерисовка происходит, когда несколько объектов визуализируются, но не отображаются на экране, так как они скрыты объектом окклудинг.</span><span class="sxs-lookup"><span data-stu-id="4ed70-185">High overdraw occurs when multiple objects are rendered but not shown on screen as they're hidden by an occluding object.</span></span> <span data-ttu-id="4ed70-186">Представьте себе, что у стены есть объекты, находящиеся за ней.</span><span class="sxs-lookup"><span data-stu-id="4ed70-186">Imagine looking at a wall that has objects behind it.</span></span> <span data-ttu-id="4ed70-187">Вся геометрия будет обработана для подготовки к просмотру, но необходимо будет визуализировать только непрозрачную стену, что приведет к ненужным операциям.</span><span class="sxs-lookup"><span data-stu-id="4ed70-187">All of the geometry would be processed for rendering, but only the opaque wall needs to be rendered, which results in unnecessary operations.</span></span>

#### <a name="shaders"></a><span data-ttu-id="4ed70-188">Шейдеры</span><span class="sxs-lookup"><span data-stu-id="4ed70-188">Shaders</span></span>

<span data-ttu-id="4ed70-189">Шейдер — это небольшие программы, которые работают на GPU и выполняют два важных шага при подготовке к просмотру:</span><span class="sxs-lookup"><span data-stu-id="4ed70-189">Shaders are small programs that run on the GPU and do two important steps in rendering:</span></span>
1) <span data-ttu-id="4ed70-190">Определение того, какие вершины должны рисоваться и где они находятся в пространстве экрана (шейдер вершин)</span><span class="sxs-lookup"><span data-stu-id="4ed70-190">Determining which vertices should be drawn and where they are in screen space (the Vertex shader)</span></span>
    - <span data-ttu-id="4ed70-191">Шейдер вершин выполняется на вершину для каждой сетки.</span><span class="sxs-lookup"><span data-stu-id="4ed70-191">The Vertex shader is executed per vertex for every mesh.</span></span>
2) <span data-ttu-id="4ed70-192">Определение цвета каждого пикселя (шейдер пикселей)</span><span class="sxs-lookup"><span data-stu-id="4ed70-192">Determining the color of each pixel (the Pixel shader)</span></span>
    - <span data-ttu-id="4ed70-193">Построитель текстуры выполняется на пиксель и визуализируется с помощью геометрии в целевую текстуру рендеринга.</span><span class="sxs-lookup"><span data-stu-id="4ed70-193">The Pixel shader is executed per pixel and rendered by the geometry to the target render texture.</span></span>

<span data-ttu-id="4ed70-194">Обычно шейдеры выполняют много преобразований и вычислений освещения.</span><span class="sxs-lookup"><span data-stu-id="4ed70-194">Typically, shaders do many transformations and lighting calculations.</span></span> <span data-ttu-id="4ed70-195">Хотя сложные модели освещения, тени и другие операции могут создавать отличные результаты, они также поставляются с ценой.</span><span class="sxs-lookup"><span data-stu-id="4ed70-195">Although complex lighting models, shadows, and other operations can generate fantastic results, they also come with a price.</span></span> <span data-ttu-id="4ed70-196">Уменьшение числа операций, вычисленных в шейдере, может значительно снизить объем работы, необходимый для GPU на кадр.</span><span class="sxs-lookup"><span data-stu-id="4ed70-196">Reducing the number of operations computed in shaders can greatly reduce the work needed for the GPU per frame.</span></span>

##### <a name="shader-coding-recommendations"></a><span data-ttu-id="4ed70-197">Рекомендации по кодированию шейдера</span><span class="sxs-lookup"><span data-stu-id="4ed70-197">Shader coding recommendations</span></span>

- <span data-ttu-id="4ed70-198">Используйте фильтрацию билинейной, когда это возможно</span><span class="sxs-lookup"><span data-stu-id="4ed70-198">Use bilinear filtering, whenever possible</span></span>
- <span data-ttu-id="4ed70-199">Переупорядочение выражений для использования встроенных функций MAD для умножения и добавления в одно и то же время</span><span class="sxs-lookup"><span data-stu-id="4ed70-199">Rearrange expressions to use MAD intrinsics to do a multiply and an add at the same time</span></span>
- <span data-ttu-id="4ed70-200">Предварительно вычислить как можно больше ресурсов ЦП и передать его в качестве констант в материал</span><span class="sxs-lookup"><span data-stu-id="4ed70-200">Precalculate as much as possible on the CPU and pass as constants to the material</span></span>
- <span data-ttu-id="4ed70-201">**Предпочитать операции перемещения из шейдера пикселей к шейдеру вершин**</span><span class="sxs-lookup"><span data-stu-id="4ed70-201">**Favor moving operations from the pixel shader to the vertex shader**</span></span>
    - <span data-ttu-id="4ed70-202">Как правило, количество вершин намного меньше числа пикселов (720p — 921 600 пикселей, 1080p — 2 073 600 пикселей и т. д.)</span><span class="sxs-lookup"><span data-stu-id="4ed70-202">Generally, the number of vertices is much smaller than the number of pixels (720p is 921,600 pixels, 1080p is 2,073,600 pixels, and so on)</span></span>

#### <a name="remove-gpu-stages"></a><span data-ttu-id="4ed70-203">Удалить этапы GPU</span><span class="sxs-lookup"><span data-stu-id="4ed70-203">Remove GPU stages</span></span>

<span data-ttu-id="4ed70-204">Эффекты последующей обработки могут быть дорогостоящими и увеличивать скорость заполнения приложения, включая такие приемы сглаживания, как MSAA.</span><span class="sxs-lookup"><span data-stu-id="4ed70-204">Post-processing effects can be expensive and increase the fill rate of your application, including anti-aliasing techniques like MSAA.</span></span> <span data-ttu-id="4ed70-205">В HoloLens мы рекомендуем избегать этих приемов и дополнительных стадий шейдера, таких как Geometry, поверхности и шейдеры вычислений.</span><span class="sxs-lookup"><span data-stu-id="4ed70-205">On HoloLens, we recommended avoiding these techniques and additional shader stages such as geometry, hull, and compute shaders.</span></span>

## <a name="memory-recommendations"></a><span data-ttu-id="4ed70-206">Рекомендации по использованию памяти</span><span class="sxs-lookup"><span data-stu-id="4ed70-206">Memory recommendations</span></span>

<span data-ttu-id="4ed70-207">Чрезмерная операция выделения и освобождения памяти может привести к нестабильной производительности, замороженным кадрам и другим неблагоприятным результатам.</span><span class="sxs-lookup"><span data-stu-id="4ed70-207">Excessive memory allocation and deallocation operations can result in inconsistent performance, frozen frames, and other detrimental behavior.</span></span> <span data-ttu-id="4ed70-208">Особенно важно понимать требования к памяти при разработке в Unity, так как управление памятью контролируется сборщиком мусора.</span><span class="sxs-lookup"><span data-stu-id="4ed70-208">It's especially important to understand memory considerations when developing in Unity, since memory management is controlled by the garbage collector.</span></span>

#### <a name="object-pooling"></a><span data-ttu-id="4ed70-209">Использование пулов объектов</span><span class="sxs-lookup"><span data-stu-id="4ed70-209">Object pooling</span></span>

<span data-ttu-id="4ed70-210">Пул объектов — это популярная методика снижения затрат на непрерывное выделение и освобождение объектов.</span><span class="sxs-lookup"><span data-stu-id="4ed70-210">Object pooling is a popular technique to reduce the cost of continuous allocations and deallocations of objects.</span></span> <span data-ttu-id="4ed70-211">Для этого выделяется большой пул идентичных объектов, из которого извлекаются для повторного использования доступные и неактивные экземпляры. Это эффективнее, чем постоянный процесс создания и уничтожения объектов.</span><span class="sxs-lookup"><span data-stu-id="4ed70-211">This is done by allocating a large pool of identical objects and reusing inactive, available instances from this pool instead of constantly spawning and destroying objects over time.</span></span> <span data-ttu-id="4ed70-212">Пулы объектов отлично подходят для многократно используемых компонентов с переменными периодами жизни в приложении.</span><span class="sxs-lookup"><span data-stu-id="4ed70-212">Object pools are great for reuseable components that have variable lifetime during an app.</span></span>

## <a name="see-also"></a><span data-ttu-id="4ed70-213">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="4ed70-213">See also</span></span>
- [<span data-ttu-id="4ed70-214">Рекомендации по производительности для Unity</span><span class="sxs-lookup"><span data-stu-id="4ed70-214">Performance recommendations for Unity</span></span>](../unity/performance-recommendations-for-unity.md)
- [<span data-ttu-id="4ed70-215">Рекомендуемые параметры для Unity</span><span class="sxs-lookup"><span data-stu-id="4ed70-215">Recommended settings for Unity</span></span>](../unity/recommended-settings-for-unity.md)
- [<span data-ttu-id="4ed70-216">Рекомендации по производительности для Unreal</span><span class="sxs-lookup"><span data-stu-id="4ed70-216">Performance recommendations for Unreal</span></span>](../unreal/performance-recommendations-for-unreal.md)
- [<span data-ttu-id="4ed70-217">Рекомендации по использованию материалов в Unreal</span><span class="sxs-lookup"><span data-stu-id="4ed70-217">Material recommendations in Unreal</span></span>](../unreal/unreal-materials.md)
- [<span data-ttu-id="4ed70-218">Оптимизация трехмерных моделей</span><span class="sxs-lookup"><span data-stu-id="4ed70-218">Optimize 3D models</span></span>](/dynamics365/mixed-reality/import-tool/optimize-models#performance-targets)
- [<span data-ttu-id="4ed70-219">Рекомендации по преобразованию и оптимизации трехмерных моделей в режиме реального времени</span><span class="sxs-lookup"><span data-stu-id="4ed70-219">Best practices for converting and optimizing real-time 3D Models</span></span>](/dynamics365/mixed-reality/import-tool/best-practices)
- [<span data-ttu-id="4ed70-220">Рекомендации по производительности для исполнителей и конструкторов в нереальном режиме</span><span class="sxs-lookup"><span data-stu-id="4ed70-220">Performance guidelines for artists and designers for Unreal</span></span>](https://docs.unrealengine.com/en-US/TestingAndOptimization/PerformanceAndProfiling/Guidelines/index.html)
- [<span data-ttu-id="4ed70-221">Рекомендации по использованию VR для нереальных</span><span class="sxs-lookup"><span data-stu-id="4ed70-221">VR best practices for Unreal</span></span>](https://docs.unrealengine.com/en-US/SharingAndReleasing/XRDevelopment/VR/DevelopVR/ContentSetup/index.html)