---
title: Отрисовка
description: С помощью подготовки к просмотру приложение может нарисовать голограмму в точном месте вокруг пользователя, будь то точное помещение в физический мир или в созданную виртуальную область.
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
keywords: отрисовка, голограмма
ms.openlocfilehash: 3bc882df8ec43fc188bae521a95ff91e5a59573c
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2020
ms.locfileid: "91692053"
---
# <a name="rendering"></a>Отрисовка

С помощью подготовки к просмотру в приложении можно нарисовать голограмму в определенном месте мира по всему миру, независимо от того, размещается ли оно в физическом мире или в пределах созданной виртуальной области. [Голограммы](../../discover/hologram.md) — это объекты, состоящие из звука и освещения. Подготовка к просмотру позволяет приложению добавить источник освещения.

## <a name="device-support"></a>Поддержка устройств

<table>
    <colgroup>
    <col width="25%" />
    <col width="25%" />
    <col width="25%" />
    <col width="25%" />
    </colgroup>
    <tr>
        <td><strong>Возможность</strong></td>
        <td><a href="../../hololens-hardware-details.md"><strong>HoloLens (1-го поколения)</strong></a></td>
        <td><a href="https://docs.microsoft.com/hololens/hololens2-hardware"><strong>HoloLens 2</strong></td>
        <td><a href="../../discover/immersive-headset-hardware-details.md"><strong>Иммерсивные гарнитуры</strong></a></td>
    </tr>
     <tr>
        <td>Отрисовка</td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
</table>

## <a name="holographic-rendering"></a>Голографическая отрисовка

Ключом к более ранней отрисовке является то, что вы готовитесь к просмотру на экране (например, HoloLens), позволяющем пользователю видеть как физический мир, так и самые голограммы, или непрозрачное отображение, такое как иммерсивное гарнитура Windows Mixed Reality, которая блокирует мир.

Устройства с **видимыми экранами** , например [HoloLens](../../hololens-hardware-details.md), добавляют свет в мир. Черные пиксели полностью прозрачны, тогда как более яркие Пиксели все больше непрозрачны. Поскольку свет из экранов добавляется к источнику света из реальной жизни, белые Пиксели немного прозрачны.

Хотя отрисовка стереоскопик предоставляет одну подсказку глубины для голограмм, добавление [эффектов заземления](../../design/interaction-fundamentals.md) может помочь пользователям быстрее увидеть, на какой поверхности приближается голограмма. Один прием заземления заключается в том, чтобы добавить свечение вокруг голограммы на соседней поверхности, а затем визуализировать тень относительно этого свечения. Таким образом, тень выглядит так, чтобы вычесть освещение из среды. [Пространственный звук](../../design/spatial-sound.md) — это еще одна очень важная подсказка, позволяющая пользователям узнать о расстоянии и относительном расположении голограммы.

Устройства с **непрозрачными дисплеями** , например с помощью [впечатляющих головных телефонов Windows Mixed Reality](../../discover/immersive-headset-hardware-details.md), блокируют мир. Черные Пиксели — это сплошной черный цвет, а любой другой цвет отображается в качестве цвета для пользователя. Приложение отвечает за визуализацию всех, что видит пользователь. Это делает еще более важным поддержание постоянной частоты обновления, чтобы пользователи имели опыт работы.

## <a name="predicted-rendering-parameters"></a>Параметры прогнозируемой отрисовки

Гарнитуры смешанной реальности (HoloLens и иммерсивное гарнитуры) постоянно отправляют положение и ориентацию заголовка пользователя относительно их окружающей среды. По мере того, как приложение начинает подготовку следующего кадра, система прогнозирует, где головной компьютер будет находиться в будущем на тот момент, когда кадр отображается на экране. На основе этого прогноза система вычисляет представление и преобразования проекции для использования в этом кадре. Приложение **должно использовать эти преобразования для получения правильных результатов** ; Если передаваемые системой преобразования не используются, полученный образ не будет согласован с реальным миром, что приведет к дискомфорт пользователя.

Обратите внимание, что для точного прогнозирования того, когда на экран будет достигнут новый кадр, система постоянно измеряет эффективную сквозную задержку конвейера отрисовки приложения. Несмотря на то, что система корректирует длину конвейера отрисовки, можно повысить стабильность, сохранив этот конвейер как можно короче.

Приложения, использующие дополнительные методы для расширения системы прогнозирования, могут переопределять системные представления и преобразования проекций. Эти приложения по-прежнему должны использовать системные преобразования в качестве базиса для своих пользовательских преобразований для получения осмысленных результатов.

## <a name="other-rendering-parameters"></a>Другие параметры подготовки к просмотру

При отрисовке кадра система указывает окно просмотра заднего буфера, в котором должно рисоваться приложение. Это окно просмотра часто меньше, чем полный размер буфера кадров. Независимо от размера окна просмотра, когда кадр отображается приложением, система производит масштабирование изображения для заполнения всех экранов.

Для приложений, которые сами не удается визуализировать с требуемой частотой обновления, [параметры отрисовки системы можно настроить](https://docs.microsoft.com/uwp/api/Windows.Graphics.Holographic.HolographicViewConfiguration#Windows_Graphics_Holographic_HolographicViewConfiguration) таким же путем, чтобы снизить нагрузку на память и затраты на подготовку к просмотру за счет увеличения числа точек. Формат заднего буфера также может быть изменен, что для некоторых приложений может помочь улучшить пропускную способность и пропускную способность в пикселях.

Фрустум отрисовки, разрешение и частота кадров, в которых запрашивается отрисовка приложения, могут также изменяться от кадра к кадру и могут отличаться в пределах левого и правого глаз. Например, если активна [запись смешанной реальности](../../mixed-reality-capture.md) (нормативная реальность) и [Конфигурация просмотра фото-и видеокамер](https://docs.microsoft.com/uwp/api/Windows.Graphics.Holographic.HolographicViewConfigurationKind#Windows_Graphics_Holographic_HolographicViewConfigurationKind) не включена, то один взгляд может быть ВИЗУАЛИЗИРОВАН более крупным фов или разрешением.

Для любого конкретного кадра приложение *должно быть* отображено с использованием преобразования «представление», «преобразование проекции» и разрешения «окно просмотра», предоставляемых системой. Кроме того, приложение не должно рассчитывать, что любой параметр отрисовки или представления остается фиксированным из кадра в кадр. Такие механизмы, как Unity, обрабатывали все эти преобразования в собственных объектах камеры, чтобы физическое перемещение пользователей и состояние системы всегда соблюдались. Если приложение позволяет выполнять виртуальное перемещение пользователя по всему миру (например, с помощью аналогового стика на игровом планшете), можно добавить родительский объект-платформу над камерой, в которой он перемещается. В результате Камера будет отражать как виртуальное, так и физическое движение пользователя. Если приложение изменяет преобразование представления, преобразование проекции или размер окна просмотра, предоставляемое системой, оно должно информировать систему, вызывая соответствующий [API переопределения](https://docs.microsoft.com/uwp/api/Windows.Graphics.Holographic.HolographicCameraPose#Windows_Graphics_Holographic_HolographicCameraPose).

Чтобы повысить стабильность работы с holographic, приложение должно предоставить Windows каждый кадр буфер глубины, используемый для подготовки к просмотру. Если приложение предоставляет буфер глубины, оно должно иметь согласованные значения глубины с глубиной, выраженной в метрах от камеры. Это позволяет системе использовать данные глубины за каждый пиксель, чтобы лучше стабилизировать содержимое, если головное задолженность пользователя немного смещается из прогнозируемого расположения. Если вы не можете предоставить буфер глубины, можно предоставить точку фокусировки и ее нормальную работу, определив плоскость, которая обрезает большую часть вашего содержимого. Если предоставлены и буфер глубины, и плоскость фокусировки, система может использовать оба варианта. В частности, полезно предоставить как буфер глубины, так и точку фокусировки, которые включают вектор скорости, когда приложение отображает голограммы, которые находятся в движении.

Подробные сведения о теме см. [в статье Подготовка к просмотру в DirectX](../native/rendering-in-directx.md) .

## <a name="holographic-cameras"></a>Holographic камер

В Windows Mixed Reality представлено понятие **камеры holographic** . Holographic-камеры похожи на традиционную камеру, обнаруженную в тексте трехмерной графики. они определяют как внешние (положение и ориентацию), так и встроенные свойства камеры. (Например, поле "представление" используется для просмотра виртуальной трехмерной сцены.) В отличие от традиционных трехмерных камер, приложение не контролирует положение, ориентацию и внутренние свойства камеры. Вместо этого положение и ориентация камеры holographic неявно контролируется перемещением пользователя. Перемещение пользователя передается в приложение по покадровой основе с помощью преобразования представления. Аналогично, встроенные свойства камеры определяются с помощью калибровки устройства, а также передаются по кадрам с помощью преобразования проекции.

Как правило, приложение будет отображаться для одной стереозвуковой камеры. Однако надежный цикл визуализации будет поддерживать несколько камер и будет поддерживать как моно, так и стерео-камеры. Например, система может попросить приложение подготовиться к просмотру с альтернативной точки зрения, когда пользователь активирует такую функцию, как " [запись смешанной реальности](../../mixed-reality-capture.md) " (нормативная версия), в зависимости от формы заданной гарнитуры. Приложения, поддерживающие несколько [камер, получают их путем включения](https://docs.microsoft.com/uwp/api/Windows.Graphics.Holographic.HolographicViewConfiguration#Windows_Graphics_Holographic_HolographicViewConfiguration) в [типы](https://docs.microsoft.com/uwp/api/Windows.Graphics.Holographic.HolographicViewConfigurationKind#Windows_Graphics_Holographic_HolographicViewConfigurationKind) камер, которые они могут поддерживать.

## <a name="volume-rendering"></a>Объемная отрисовка

При отрисовке медицинских результаты МРТ или инженерных томов в трехмерном виде часто используются приемы [отрисовки тома](volume-rendering.md) . Эти методы могут быть особенно интересными в смешанной реальности, где пользователи могут естественно просматривать такой том с помощью ключевых углов, просто перемещая их головку.

## <a name="supported-resolutions-on-hololens-1st-gen"></a>Поддерживаемые разрешения в HoloLens (1-й общий)

* Максимальный размер окна просмотра — это свойство [холографикдисплай](https://docs.microsoft.com/uwp/api/windows.graphics.holographic.holographicdisplay). Для HoloLens задан максимальный размер окна просмотра, то есть 720p (1268x720) по умолчанию.
* Размер окна просмотра можно изменить, задав параметр Виевпортскалефактор на Холографиккамера. Этот коэффициент масштабирования находится в диапазоне от 0 до 1.
* Минимальный поддерживаемый размер окна просмотра в HoloLens (1-й общий) составляет 50% 720p, то есть 360p (634x360). Это Виевпортскалефактор 0,5.
* Все меньше 540p не рекомендуется из-за визуального снижения производительности, но можно использовать для выявления узких мест в скорости заполнения пикселов.

## <a name="supported-resolutions-on-hololens-2"></a>Поддерживаемые разрешения в HoloLens 2

* Текущий и максимальный поддерживаемый размер целевого объекта рендеринга — это свойства [конфигурации представления](https://docs.microsoft.com/uwp/api/Windows.Graphics.Holographic.HolographicViewConfiguration#Windows_Graphics_Holographic_HolographicViewConfiguration). HoloLens 2 задает максимальный размер целевого объекта отрисовки, который по умолчанию — 1440x936.
* Приложения могут изменять размер буферов целевого буфера прорисовки путем вызова метода Рекуестрендертаржетсизе для запроса нового размера целевого объекта прорисовки. Будет выбран новый размер целевого объекта прорисовки, который соответствует или превышает запрошенный размер целевого объекта прорисовки. Этот API изменяет размер буфера целевого объекта прорисовки, что требует перераспределения памяти на GPU. К этим последствиям относятся: размер целевого объекта прорисовки можно масштабировать, чтобы уменьшить нехватку памяти на GPU, и этот метод не должен вызываться с высокой частотой.
* Приложения по-прежнему могут изменять размер окна просмотра таким же образом, как и для HoloLens 1. Это не приводит к перераспределению памяти на GPU, поэтому его можно изменить с высокой частотой, но нельзя использовать для снижения нехватки памяти GPU.
* Наименьший поддерживаемый размер окна просмотра в HoloLens 2 — 634x412. Это Виевпортскалефактор примерно 0,44, когда размер целевого объекта рендеринга по умолчанию уже используется.
* Если указан размер целевого объекта прорисовки, который меньше наименьшего поддерживаемого размера окна просмотра, коэффициент масштабирования окна просмотра будет проигнорирован.
* Все меньше 540p не рекомендуется из-за визуального снижения производительности, но можно использовать для выявления узких мест в скорости заполнения пикселов.



## <a name="see-also"></a>См. также раздел
* [Стабильность голограммы](hologram-stability.md)
* [Отрисовка в DirectX](../native/rendering-in-directx.md)
