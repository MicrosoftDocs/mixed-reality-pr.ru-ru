---
title: Включение безопасности подключения для удаленного взаимодействия holographic
description: На этой странице объясняется, как настроить удаленное взаимодействие с помощью зашифрованных и прошедших проверку подлинности подключений между проигрывателем и удаленными приложениями.
author: markkeinz
ms.author: makei
ms.date: 10/29/2020
ms.topic: article
keywords: HoloLens, удаленное взаимодействие, holographic удаленное взаимодействие, гарнитура смешанной реальности, гарнитура Windows Mixed, гарнитура виртуальной реальности, безопасность, аутентификация, сервер-клиент
ms.openlocfilehash: 4004c7534092c73fe478130b9d957461bb34bcfa
ms.sourcegitcommit: dd13a32a5bb90bd53eeeea8214cd5384d7b9ef76
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94679593"
---
# <a name="enabling-connection-security-for-holographic-remoting"></a>Включение безопасности подключения для удаленного взаимодействия holographic

>[!IMPORTANT]
>Это руководство относится к удаленному взаимодействию с HoloLens 2.

На этой странице представлены общие сведения о сетевой безопасности для удаленного взаимодействия с Holographic. Вы найдете сведения о

* безопасность в контексте удаленного взаимодействия с holographic и причин, по которым это может потребоваться
* Рекомендуемые меры на основе различных вариантов использования
* Реализация безопасности в решении для удаленного взаимодействия с holographic

## <a name="overview"></a>Обзор

Holographic удаленное взаимодействие обменивается данными по сети. Если меры безопасности отсутствуют, злоумышленников в одной сети может нарушить целостность обмена данными или получить доступ к конфиденциальной информации.

Примеры приложений и плеера holographic в магазине Windows имеют отключенную систему безопасности. Это упрощает понимание образцов. Он также помогает быстрее начать работу с разработкой.

Однако для тестирования полей или использования в рабочей среде настоятельно рекомендуется включить безопасность в решении holographic Remoting.

Безопасность в holographic удаленное взаимодействие, если правильно настроить для вашего варианта использования, предоставляет следующие гарантии:

* **Подлинность.** и проигрыватель, и удаленное приложение могут быть уверены, что они должны быть
* **Конфиденциальность.** сторонние лица не могут читать сведения, которыми обмениваются проигрыватель и удаленное приложение.
* **Целостность.** проигрыватель и удаленный может обнаружить транзитные изменения в связи

>[!TIP]
>Чтобы иметь возможность использовать функции безопасности, необходимо реализовать как [пользовательский проигрыватель](holographic-remoting-create-player.md) , так и [настраиваемое удаленное приложение](holographic-remoting-create-host.md).

## <a name="planning-the-security-implementation"></a>Планирование реализации безопасности

При включении безопасности в holographic удаленное взаимодействие библиотека удаленного взаимодействия автоматически включит проверку шифрования и целостности для всех данных, передаваемых по сети.

Однако, чтобы обеспечить правильную проверку подлинности, необходимо выполнить некоторые дополнительные операции. То, что нужно сделать, зависит от варианта использования, а остальная часть этого раздела — об определении необходимых действий.

>[!IMPORTANT]
> Эта статья содержит только общие рекомендации. Если вы не уверены, обратитесь к эксперту по безопасности, который может предоставить вам рекомендации, относящиеся к Вашему варианту использования.

Первая терминология. при описании сетевых подключений будут использоваться условия _клиент_ и _сервер_ . Сервер — это сторона, принимающая входящие подключения по известному адресу конечной точки, а клиент — Подключение к конечной точке сервера.

>[!NOTE]
> Роли клиента и сервера не связаны с тем, работает ли приложение как проигрыватель или как удаленное. Хотя у примеров есть проигрыватель в роли сервера, можно легко поменять местами роли, если это лучше соответствует Вашему варианту использования.

### <a name="planning-the-server-to-client-authentication"></a>Планирование проверки подлинности "сервер-клиент"

Сервер использует цифровые сертификаты для подтверждения его подлинности клиенту. Клиент проверяет сертификат сервера на этапе подтверждения соединения. Если клиент не доверяет серверу, подключение будет завершено на этом этапе.

Как клиент проверяет сертификат сервера и какие типы сертификатов сервера можно использовать, зависит от варианта использования.

**Вариант использования 1:** Имя узла сервера не фиксировано, или сервер не адресован по имени узла.

В этом случае непрактично (или даже возможно) выдача сертификата для имени узла сервера. Вместо этого рекомендуется проверять отпечаток сертификата. Как и отпечаток человека, отпечаток уникально определяет сертификат.

Важно передавать отпечаток клиенту по внешнему каналу. Это означает, что вы не сможете отправить его через то же сетевое подключение, которое используется для удаленного взаимодействия. Вместо этого можно вручную ввести его в конфигурацию клиента или проверить QR-код на клиенте.

**Вариант использования 2:** Сервер может быть достигнут с помощью стабильного имени узла.

В этом варианте использования сервер имеет определенное имя узла и известно, что это имя, скорее всего, не изменится. Затем можно использовать сертификат, выданный для имени узла сервера. Доверие будет установлено на основе имени узла и цепочки доверия сертификата.

При выборе этого параметра клиенту необходимо заранее определить имя узла сервера и корневой сертификат.

### <a name="planning-the-client-to-server-authentication"></a>Планирование проверки подлинности клиента и сервера

Клиенты проходят проверку подлинности на сервере с помощью маркера свободной формы. Что должен содержать этот токен, будет снова зависеть от вашего варианта использования:

**Вариант использования 1:** Необходимо только проверить удостоверение клиентского приложения.

В этом варианте использования может быть достаточно общего секрета. Этот секрет должен быть достаточно сложным, чтобы не догадаться.

Хороший общий секрет — это случайный идентификатор GUID, который вручную указывается как в конфигурации сервера, так и на клиенте. Для создания такой команды можно использовать `New-Guid` команду в PowerShell.

Убедитесь, что этот общий секрет никогда не передается через небезопасные каналы. Библиотека удаленного взаимодействия гарантирует, что общий секрет всегда будет отправляться зашифрованным и только доверенным одноранговым узлам.

**Вариант использования 2:** Также необходимо проверить удостоверение пользователя клиентского приложения.

Общий секрет не будет достаточно для покрытия этого варианта использования. Вместо этого можно использовать маркеры, созданные поставщиком удостоверений. Рабочий процесс проверки подлинности с использованием поставщика удостоверений будет выглядеть следующим образом:

* Клиент выполняет авторизацию для поставщика удостоверений и запрашивает маркер.
* Поставщик удостоверений создает маркер и отправляет его клиенту.
* Клиент отправляет этот токен серверу с помощью удаленного взаимодействия с Holographic.
* Сервер проверяет маркер клиента на соответствие поставщику удостоверений.

Одним из примеров поставщика удостоверений является [платформа Microsoft Identity](https://docs.microsoft.com/azure/active-directory/develop/).

Как и в предыдущем варианте использования, убедитесь, что эти маркеры не отправляются через небезопасные каналы или не предоставляются иным образом.

## <a name="implementing-holographic-remoting-security"></a>Реализация безопасности удаленного взаимодействия holographic

Помните, что для обеспечения безопасности подключения необходимо реализовать пользовательские удаленные и проигрыватели приложений. Предоставленные примеры можно использовать в качестве отправных точек для собственных приложений.

Чтобы включить безопасность, вызовите `ListenSecure()` вместо `Listen()` и `ConnectSecure()` вместо, `Connect()` чтобы установить удаленное соединение.

Для этих вызовов требуется предоставить реализации определенных интерфейсов для предоставления и проверки сведений, связанных с безопасностью:

* Сервер должен реализовать поставщик сертификатов и проверяющий элемент проверки подлинности
* Клиенту необходимо реализовать поставщик проверки подлинности и проверяющий элемент управления сертификатом.

Все интерфейсы имеют функцию, запрашивающую выполнение действия, которая получает объект обратного вызова в качестве параметра. С помощью этого объекта можно легко реализовать асинхронную обработку запроса. Сохраним ссылку на этот объект и вызовите функцию завершения после завершения асинхронного действия. Функцию завершения можно вызвать из любого потока.

>[!TIP]
>Реализация интерфейсов WinRT может быть легко выполнена с помощью C++/Винрт. Подробные сведения см. в разделе [API-интерфейсы автора с C++/WinRT](https://docs.microsoft.com//windows/uwp/cpp-and-winrt-apis/author-apis) .

>[!IMPORTANT]
>В `build\native\include\HolographicAppRemoting\Microsoft.Holographic.AppRemoting.idl` пакете NuGet содержится подробная документация по API, связанному с защищенными соединениями.

### <a name="implementing-a-certificate-provider"></a>Реализация поставщика сертификатов

Поставщики сертификатов предоставляют серверное приложение с сертификатом для использования. Реализация состоит из двух частей:

1) Объект сертификата, который реализует `ICertificate` интерфейс:

    * `GetCertificatePfx()` должен возвращать двоичное содержимое `PKCS#12` хранилища сертификатов. `.pfx`Файл содержит `PKCS#12` данные, поэтому его содержимое можно использовать непосредственно здесь.
    * `GetSubjectName()` должен возвращать понятное имя, идентифицирующее используемый сертификат. Если сертификату не присвоено понятное имя, эта функция должна возвращать имя субъекта сертификата.
    * `GetPfxPassword()` должен вернуть пароль, необходимый для открытия хранилища сертификатов (или пустую строку, если пароль не требуется).

2) Поставщик сертификатов, реализующий `ICertificateProvider` интерфейс:
    * `GetCertificate()` должен создать объект сертификата и вернуть его, вызвав метод `CertificateReceived()` в объекте обратного вызова.

### <a name="implementing-an-authentication-validator"></a>Реализация средства проверки подлинности

Проверяющие элементы проверки подлинности получают маркер проверки подлинности, отправленный клиентом, и отвечают на результаты проверки.

Реализуйте `IAuthenticationReceiver` интерфейс следующим образом:

* `GetRealm()` должен возвращать имя области проверки подлинности (область HTTP, используемую во время подтверждения соединения удаленного взаимодействия).
* `ValidateToken()` должен проверять маркер проверки подлинности клиента и вызывать `ValidationCompleted()` объект обратного вызова с результатом проверки.

### <a name="implementing-an-authentication-provider"></a>Реализация поставщика проверки подлинности

Поставщики проверки подлинности создают или извлекают маркер проверки подлинности для отправки на сервер.

Реализуйте `IAuthenticationProvider` интерфейс следующим образом:

* `GetToken()` должен создать или получить токен проверки подлинности для отправки. Когда маркер будет готов, вызовите `TokenReceived()` метод для объекта обратного вызова.

### <a name="implementing-a-certificate-validator"></a>Реализация средства проверки сертификата

Средства проверки сертификатов получают цепочку сертификатов, отправленную сервером, и определяют, может ли сервер быть доверенным.

Для проверки сертификатов можно использовать логику проверки базовой системы. Эта проверка системы может либо поддерживать собственную логику проверки, либо полностью заменить ее. Если вы не передаете собственное средство проверки сертификатов при запросе безопасного подключения, проверка системы будет использоваться автоматически.

В Windows проверка системы будет проверять следующее:

* Целостность цепочки сертификатов. сертификаты формируют согласованную цепочку, которая заканчивается на доверенном корневом сертификате.
* Срок действия сертификата. сертификат сервера находится в пределах интервала времени и выдается в целях проверки подлинности сервера.
* Отзыв: сертификат не был отозван
* Совпадение имен: имя узла сервера совпадает с одним из имен узлов, для которых был выдан сертификат.

Реализуйте `ICertificateValidator` интерфейс следующим образом:

 * `PerformSystemValidation()` должен возвращать, `true` если должна быть выполнена проверка системы, как описано выше. В этом случае результат проверки системы передается в качестве входных данных для `ValidateCertificate()` метода.
* `ValidateCertificate()` должен проверять цепочку сертификатов, а затем вызывать `CertificateValidated()` переданный обратный вызов с окончательным результатом проверки. Этот метод принимает цепочку сертификатов, имя сервера, с которым устанавливается соединение, и необходимость принудительного выполнения проверки отзыва. Если цепочка сертификатов содержит несколько сертификатов, первый из них является сертификатом субъекта.

>[!NOTE]
>Если для варианта использования требуется другая форма проверки (см. вариант использования сертификата #1 выше), полностью обходить проверку системы. Вместо этого используйте любой API или библиотеку, которые могут использовать сертификаты X. 509 в кодировке DER для декодирования цепочки сертификатов и выполнения проверок, необходимых для вашего варианта использования.

## <a name="see-also"></a>См. также
* [Создание приложения с голографическим удаленным взаимодействием](holographic-remoting-create-host.md)
* [Создание пользовательского проигрывателя для голографического удаленного взаимодействия](holographic-remoting-create-player.md)
* [Устранение неполадок и ограничения удаленного взаимодействия с holographic](holographic-remoting-troubleshooting.md)
* [Условия лицензии на использование ПО для голографического удаленного взаимодействия](https://docs.microsoft.com//legal/mixed-reality/microsoft-holographic-remoting-software-license-terms)
* [Заявление о конфиденциальности Майкрософт](https://go.microsoft.com/fwlink/?LinkId=521839)
