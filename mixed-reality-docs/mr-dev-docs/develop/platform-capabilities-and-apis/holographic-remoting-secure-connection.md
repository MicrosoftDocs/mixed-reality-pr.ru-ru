---
title: Включение безопасности подключения для удаленного взаимодействия holographic
description: На этой странице объясняется, как настроить удаленное взаимодействие с помощью зашифрованных и прошедших проверку подлинности подключений между проигрывателем и удаленными приложениями.
author: florianbagarmicrosoft
ms.author: flbagar
ms.date: 12/01/2020
ms.topic: article
keywords: HoloLens, удаленное взаимодействие, удаленное взаимодействие, гарнитура смешанной реальности, гарнитура windows mixed reality, гарнитура виртуальной реальности, безопасность, аутентификация, сервер-клиент
ms.openlocfilehash: 1639634356f9f2d8e1353f2cf3c6c71203f6af24
ms.sourcegitcommit: 018a6edbab5011dd3b44ebf1dca017a731fcfca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2021
ms.locfileid: "129745055"
---
# <a name="enabling-connection-security-for-holographic-remoting-c"></a>Включение безопасности подключений для удаленного взаимодействия с holographic (C++)

> [!NOTE]
> это руководство относится к удаленному взаимодействию с HoloLens 2 и Windows пк под управлением [Windows Mixed Reality](../../discover/navigating-the-windows-mixed-reality-home.md).

На этой странице представлены общие сведения о сетевой безопасности для удаленного взаимодействия с Holographic. Вы найдете сведения о

* безопасность в контексте удаленного взаимодействия с holographic и причин, по которым это может потребоваться
* Рекомендуемые меры на основе различных вариантов использования
* Реализация безопасности в решении для удаленного взаимодействия с holographic

## <a name="holographic-remoting-security"></a>Безопасность удаленного взаимодействия holographic

Holographic удаленное взаимодействие обменивается данными по сети. Если меры безопасности отсутствуют, злоумышленников в одной сети может нарушить целостность обмена данными или получить доступ к конфиденциальной информации.

примеры приложений и плеера holographic в магазине Windows имеют отключенные средства безопасности. Это упрощает понимание образцов. Он также помогает быстрее начать работу с разработкой.

Для тестирования или производства полей настоятельно рекомендуется включить безопасность в решении holographic Remoting.

Безопасность в holographic удаленное взаимодействие, если правильно настроить для вашего варианта использования, предоставляет следующие гарантии:

* **Подлинность.** и проигрыватель, и удаленное приложение могут быть уверены, что они должны быть
* **Конфиденциальность.** сторонние лица не могут читать сведения, которыми обмениваются проигрыватель и удаленное приложение.
* **Целостность.** проигрыватель и удаленный может обнаружить транзитные изменения в связи

> [!IMPORTANT]
> чтобы иметь возможность использовать функции безопасности, необходимо реализовать как [пользовательский проигрыватель](holographic-remoting-create-player.md) , так и настраиваемое удаленное приложение с помощью [Windows Mixed Reality](holographic-remoting-create-remote-wmr.md) или интерфейсов api [опенкср](holographic-remoting-create-remote-openxr.md) .

> [!NOTE]
> Начиная с версии [2.4.0](holographic-remoting-version-history.md#v2.4.0) удаленные приложения можно создавать с помощью [API опенкср](../native/openxr.md) . Общие сведения о том, как установить безопасное подключение в среде Опенкср, можно найти [ниже](#secure-connection-using-the-openxr-api).

## <a name="planning-the-security-implementation"></a>Планирование реализации безопасности

При включении безопасности в holographic удаленное взаимодействие библиотека удаленного взаимодействия автоматически включит проверку шифрования и целостности для всех данных, передаваемых по сети.

Однако, чтобы обеспечить правильную проверку подлинности, необходимо выполнить некоторые дополнительные операции. То, что нужно сделать, зависит от варианта использования, а остальная часть этого раздела — об определении необходимых действий.

> [!IMPORTANT]
> Эта статья содержит только общие рекомендации. Если вы не уверены, обратитесь к эксперту по безопасности, который может предоставить вам рекомендации, относящиеся к Вашему варианту использования.

Первая терминология. при описании сетевых подключений будут использоваться условия _клиент_ и _сервер_ . Сервер — это сторона, принимающая входящие подключения по известному адресу конечной точки, а клиент — Подключение к конечной точке сервера.

> [!NOTE]
> Роли клиента и сервера не связаны с тем, работает ли приложение как проигрыватель или как удаленное. Хотя у примеров есть проигрыватель в роли сервера, можно легко поменять местами роли, если это лучше соответствует Вашему варианту использования.

### <a name="planning-the-server-to-client-authentication"></a>Планирование проверки подлинности "сервер-клиент"

Сервер использует цифровые сертификаты для подтверждения его подлинности клиенту. Клиент проверяет сертификат сервера на этапе подтверждения соединения. Если клиент не доверяет серверу, подключение будет завершено на этом этапе.

Как клиент проверяет сертификат сервера и какие типы сертификатов сервера можно использовать, зависит от варианта использования.

**Вариант использования 1:** Имя узла сервера не фиксировано, или сервер не адресован по имени узла.

В этом случае непрактично (или даже возможно) выдача сертификата для имени узла сервера. Мы рекомендуем проверить отпечаток сертификата. Как и отпечаток человека, отпечаток уникально определяет сертификат.

Важно передавать отпечаток клиенту по внешнему каналу. Это означает, что вы не сможете отправить его через то же сетевое подключение, которое используется для удаленного взаимодействия. Вместо этого можно вручную ввести его в конфигурацию клиента или проверить QR-код на клиенте.

**Вариант использования 2:** Сервер может быть достигнут с помощью стабильного имени узла.

В этом варианте использования сервер имеет определенное имя узла и известно, что это имя, скорее всего, не изменится. Затем можно использовать сертификат, выданный для имени узла сервера. Доверие будет установлено на основе имени узла и цепочки доверия сертификата.

При выборе этого параметра клиенту необходимо заранее определить имя узла сервера и корневой сертификат.

### <a name="planning-the-client-to-server-authentication"></a>Планирование проверки подлинности клиента и сервера

Клиенты проходят проверку подлинности на сервере с помощью маркера свободной формы. Что должен содержать этот токен, будет снова зависеть от вашего варианта использования:

**Вариант использования 1:** Необходимо только проверить удостоверение клиентского приложения.

В этом варианте использования может быть достаточно общего секрета. Этот секрет должен быть достаточно сложным, чтобы не догадаться.

Хороший общий секрет — это случайный идентификатор GUID, который вручную указывается как в конфигурации сервера, так и на клиенте. Для создания такой команды можно использовать `New-Guid` команду в PowerShell.

Убедитесь, что этот общий секрет никогда не передается через небезопасные каналы. Библиотека удаленного взаимодействия гарантирует, что общий секрет всегда будет отправляться зашифрованным и только доверенным одноранговым узлам.

**Вариант использования 2:** Также необходимо проверить удостоверение пользователя клиентского приложения.

Общий секрет не будет достаточно для покрытия этого варианта использования. Вместо этого можно использовать маркеры, созданные поставщиком удостоверений. Рабочий процесс проверки подлинности с использованием поставщика удостоверений будет выглядеть следующим образом:

* Клиент выполняет авторизацию для поставщика удостоверений и запрашивает маркер.
* Поставщик удостоверений создает маркер и отправляет его клиенту.
* Клиент отправляет этот токен серверу с помощью удаленного взаимодействия с Holographic.
* Сервер проверяет маркер клиента на соответствие поставщику удостоверений.

одним из примеров поставщика удостоверений является [платформа удостоверений Майкрософт](/azure/active-directory/develop/).

Как и в предыдущем варианте использования, убедитесь, что эти маркеры не отправляются через небезопасные каналы или не предоставляются иным образом.

## <a name="implementing-holographic-remoting-security"></a>Реализация безопасности удаленного взаимодействия holographic

Помните, что для обеспечения безопасности подключения необходимо реализовать пользовательские удаленные и проигрыватели приложений. Предоставленные примеры можно использовать в качестве отправных точек для собственных приложений.

Чтобы включить безопасность, вызовите `ListenSecure()` вместо `Listen()` и `ConnectSecure()` вместо, `Connect()` чтобы установить удаленное соединение.

Для этих вызовов требуется предоставить реализации определенных интерфейсов для предоставления и проверки сведений, связанных с безопасностью:

* Сервер должен реализовать поставщик сертификатов и проверяющий элемент проверки подлинности
* Клиенту необходимо реализовать поставщик проверки подлинности и проверяющий элемент управления сертификатом.

Все интерфейсы имеют функцию, запрашивающую выполнение действия, которая получает объект обратного вызова в качестве параметра. С помощью этого объекта можно легко реализовать асинхронную обработку запроса. Сохраним ссылку на этот объект и вызовите функцию завершения после завершения асинхронного действия. Функцию завершения можно вызвать из любого потока.

> [!TIP]
> Реализация интерфейсов WinRT может быть легко выполнена с помощью C++/Винрт. Подробные сведения см. в разделе [API-интерфейсы автора с C++/WinRT](/windows/uwp/cpp-and-winrt-apis/author-apis) .

> [!IMPORTANT]
> `build\native\include\HolographicAppRemoting\Microsoft.Holographic.AppRemoting.idl`внутри пакета NuGet содержит подробную документацию по API, связанному с защищенными соединениями.

### <a name="implementing-a-certificate-provider"></a>Реализация поставщика сертификатов

Поставщики сертификатов предоставляют серверное приложение с сертификатом для использования. Реализация состоит из двух частей:

1) Объект сертификата, который реализует `ICertificate` интерфейс:

    * `GetCertificatePfx()` должен возвращать двоичное содержимое `PKCS#12` хранилища сертификатов. `.pfx`Файл содержит `PKCS#12` данные, поэтому его содержимое можно использовать непосредственно здесь.
    * `GetSubjectName()` должен возвращать понятное имя, идентифицирующее используемый сертификат. Если сертификату не присвоено понятное имя, эта функция должна возвращать имя субъекта сертификата.
    * `GetPfxPassword()` должен вернуть пароль, необходимый для открытия хранилища сертификатов (или пустую строку, если пароль не требуется).

2) Поставщик сертификатов, реализующий `ICertificateProvider` интерфейс:
    * `GetCertificate()` должен создать объект сертификата и вернуть его, вызвав метод `CertificateReceived()` в объекте обратного вызова.

### <a name="implementing-an-authentication-validator"></a>Реализация средства проверки подлинности

Проверяющие элементы проверки подлинности получают маркер проверки подлинности, отправленный клиентом, и отвечают на результаты проверки.

Реализуйте `IAuthenticationReceiver` интерфейс следующим образом:

* `GetRealm()` должен возвращать имя области проверки подлинности (область HTTP, используемую во время подтверждения соединения удаленного взаимодействия).
* `ValidateToken()` должен проверять маркер проверки подлинности клиента и вызывать `ValidationCompleted()` объект обратного вызова с результатом проверки.

### <a name="implementing-an-authentication-provider"></a>Реализация поставщика проверки подлинности

Поставщики проверки подлинности создают или извлекают маркер проверки подлинности для отправки на сервер.

Реализуйте `IAuthenticationProvider` интерфейс следующим образом:

* `GetToken()` должен создать или получить токен проверки подлинности для отправки. Когда маркер будет готов, вызовите `TokenReceived()` метод для объекта обратного вызова.

### <a name="implementing-a-certificate-validator"></a>Реализация средства проверки сертификата

Средства проверки сертификатов получают цепочку сертификатов, отправленную сервером, и определяют, может ли сервер быть доверенным.

Для проверки сертификатов можно использовать логику проверки базовой системы. Эта проверка системы может либо поддерживать собственную логику проверки, либо полностью заменить ее. Если вы не передаете собственное средство проверки сертификатов при запросе безопасного подключения, проверка системы будет использоваться автоматически.

на Windows проверка системы будет проверять следующее:

* Целостность цепочки сертификатов. сертификаты формируют согласованную цепочку, которая заканчивается на доверенном корневом сертификате.
* Срок действия сертификата: сертификат сервера находится в пределах интервала времени и выдается для проверки подлинности сервера.
* Отзыв: сертификат не был отозван
* Совпадение имен: имя узла сервера совпадает с одним из имен узлов, для которых был выдан сертификат.

Реализуйте `ICertificateValidator` интерфейс следующим образом:

 * `PerformSystemValidation()` должен возвращать, `true` если должна быть выполнена проверка системы, как описано выше. В этом случае результат проверки системы передается в качестве входных данных для `ValidateCertificate()` метода.
* `ValidateCertificate()` должен проверять цепочку сертификатов, а затем вызывать `CertificateValidated()` переданный обратный вызов с окончательным результатом проверки. Этот метод принимает цепочку сертификатов, имя сервера, с которым устанавливается соединение, и необходимость принудительного выполнения проверки отзыва. Если цепочка сертификатов содержит несколько сертификатов, первый из них является сертификатом субъекта.

> [!NOTE]
> Если для варианта использования требуется другая форма проверки (см. вариант использования сертификата #1 выше), полностью обходить проверку системы. Вместо этого используйте любой API или библиотеку, которые могут использовать сертификаты X. 509 в кодировке DER для декодирования цепочки сертификатов и выполнения проверок, необходимых для вашего варианта использования.

## <a name="secure-connection-using-the-openxr-api"></a>Безопасное подключение с помощью API Опенкср

При использовании [API опенкср](../native/openxr.md)все безопасные API-интерфейсы, связанные с подключением, доступны как часть `XR_MSFT_holographic_remoting` расширения опенкср.

> [!IMPORTANT]
> Чтобы узнать об API расширения Опенкср для удаленного взаимодействия с holographic, ознакомьтесь со [спецификацией](https://htmlpreview.github.io/?https://github.com/microsoft/MixedReality-HolographicRemoting-Samples/blob/main/remote_openxr/specification.html) , которую можно найти в [репозитории GitHub с примерами удаленного взаимодействия](https://github.com/microsoft/MixedReality-HolographicRemoting-Samples).

Ключевыми элементами для безопасного подключения с помощью `XR_MSFT_holographic_remoting` расширения опенкср являются следующие обратные вызовы.
- `xrRemotingRequestAuthenticationTokenCallbackMSFT`, создает или получает токен проверки подлинности для отправки.
- `xrRemotingValidateServerCertificateCallbackMSFT`, проверяет цепочку сертификатов.
- `xrRemotingValidateAuthenticationTokenCallbackMSFT`, проверяет маркер проверки подлинности клиента.
- `xrRemotingRequestServerCertificateCallbackMSFT`, укажите серверное приложение с используемым сертификатом.

Эти обратные вызовы могут быть предоставлены среде выполнения Опенкср для удаленного взаимодействия через `xrRemotingSetSecureConnectionClientCallbacksMSFT` и `xrRemotingSetSecureConnectionServerCallbacksMSFT` . Кроме того, безопасное подключение необходимо включить с помощью параметра Секуреконнектион `XrRemotingConnectInfoMSFT` структуры или `XrRemotingListenInfoMSFT` структуры в зависимости от того, используется ли `xrRemotingConnectMSFT` или `xrRemotingListenMSFT` .

Этот API похож на API на основе IDL, описанный в статье [Реализация безопасности удаленного взаимодействия holographic](#implementing-holographic-remoting-security). Однако вместо реализации интерфейсов вы должны предоставлять реализации обратного вызова. Подробный пример можно найти в [примере приложения опенкср](https://github.com/microsoft/MixedReality-HolographicRemoting-Samples).

## <a name="see-also"></a>См. также:
* [Обзор удаленного взаимодействия с holographic](holographic-remoting-overview.md)
* [создание удаленного приложения holographic с удаленным взаимодействием с помощью Windows Mixed Reality api](holographic-remoting-create-remote-wmr.md)
* [Создание удаленного приложения holographic с удаленным взаимодействием с помощью API-интерфейсов Опенкср](holographic-remoting-create-remote-openxr.md)
* [Создание пользовательского проигрывателя для голографического удаленного взаимодействия](holographic-remoting-create-player.md)
* [Устранение неполадок и ограничения удаленного взаимодействия с holographic](holographic-remoting-troubleshooting.md)
* [Условия лицензии на использование ПО для голографического удаленного взаимодействия](/legal/mixed-reality/microsoft-holographic-remoting-software-license-terms)
* [Заявление Майкрософт о конфиденциальности](https://go.microsoft.com/fwlink/?LinkId=521839)
