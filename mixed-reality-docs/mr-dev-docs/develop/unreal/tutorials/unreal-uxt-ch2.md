---
title: 2. Инициализация проекта и первое приложение
description: Часть 2 (из 6) серии руководств по созданию приложения для игры в шахматы с помощью Unreal Engine 4 и подключаемого модуля Mixed Reality UX Tools
author: hferrone
ms.author: v-hferrone
ms.date: 06/10/2020
ms.topic: article
ms.localizationpriority: high
keywords: Unreal, Unreal Engine 4, UE4, HoloLens, HoloLens 2, смешанная реальность, учебник, начало работы, MRTK, UXT, UX Tools, документация, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности
ms.openlocfilehash: 464df846d0fc6e1bd22ee3862adcdf110c377728
ms.sourcegitcommit: 32cb81eee976e73cd661c2b347691c37865a60bc
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2020
ms.locfileid: "96609655"
---
# <a name="2-initializing-your-project-and-first-application"></a>2. Инициализация проекта и первое приложение

С помощью инструкций из первого руководства вы создадите проект Unreal, включите подключаемый модуль HoloLens, создадите уровень, зададите для него освещение и добавите шахматные фигуры. Для этого мы воспользуемся готовыми ресурсами для трехмерных объектов и материалов. Создавать модели с нуля не придется. Когда вы выполните все описанное в руководстве, у вас будет шаблон для работы со смешанной реальностью.

> [!IMPORTANT]
> Убедитесь, что у вас есть все необходимое из списка на странице [Начало работы](https://docs.microsoft.com/windows/mixed-reality/unreal-uxt-ch1).

## <a name="objectives"></a>Задачи

* Настройка проекта Unreal с целью разработки для HoloLens.
* Импорт ресурсов и настройка сцены.
* Создание субъектов и событий уровня скрипта.

## <a name="creating-a-new-unreal-project"></a>Создание проекта Unreal.

Первое, что вам понадобится для работы — это проект. Если вы только начинаете разработку на Unreal, [скачайте вспомогательные файлы](https://docs.microsoft.com/windows/mixed-reality/develop/unreal/tutorials/unreal-uxt-ch6#packaging-and-deploying-the-app-via-device-portal) из Epic Launcher.

1. Запуск Unreal Engine

2. В разделе **New Project Categories** (Категории для нового проекта) выберите **Games** (Игры) и щелкните **Next** (Далее). 

![Выбор шаблона проекта Games (Игры)](images/unreal-uxt/2-gamestemplate.png)

3. Выберите пустой (**Blank**) шаблон и нажмите кнопку **Next** (Далее). 

![Выбор пустого шаблона](images/unreal-uxt/2-template.PNG)

4. Выберите **C++** , **Scalable 3D or 2D, Mobile/Tablet** (Масштабируемый трехмерный или двухмерный, мобильное устройство или планшет) и **No Starter Content** (Без начального содержимого) в разделе **Project Settings** (Параметры проекта), а затем выберите расположение сохранения и нажмите **Create Project** (Создать проект). 

> [!NOTE]
> Выберите проект C++, а не проект шаблона, чтобы создать подключаемый модуль средств UX, который вы настроите позже (в разделе 4).

![Начальные параметры проекта](images/unreal-uxt/2-project-settings.PNG)

Проект должен автоматически открыться в редакторе Unreal, и тогда можно перейти к следующему этапу.

## <a name="enabling-required-plugins"></a>Включение необходимых подключаемых модулей

Вам потребуется активировать два подключаемых модуля, прежде чем вы сможете добавлять объекты в сцену.

1. Выберите **Edit > Plugins** (Правка > Подключаемые модули) и выберите вариант **Augmented Reality** (Дополненная реальность) в списке встроенных категорий. 
    * Прокрутите список до пункта **HoloLens** и установите флажок **Enabled** (Включено). 

![Включение подключаемых модулей HoloLens](images/unreal-uxt/2-plugins.PNG)

2. Выберите вариант **Virtual Reality** (Виртуальная реальность) в списке встроенных категорий. 
    * Прокрутите список до пункта **Microsoft Windows Mixed Reality**, установите для него флажок **Enabled** (Включено) и перезапустите редактор. 

![Включение подключаемого модуля Windows Mixed Reality](images/unreal-uxt/2-virtual-reality-plugin.PNG)

> [!NOTE]
> Оба подключаемых модуля обязательны при разработке для HoloLens 2.

Теперь, после включения подключаемых модулей, у вас есть пустой уровень, который можно чем-нибудь заполнить.

## <a name="creating-a-level"></a>Создание уровня
Следующая задача — создать игровую обстановку с начальной точкой и кубом, задающим начало отсчета и масштаб.

1. Выберите **File > New Level** (Файл > Создать уровень), а затем **Empty Level** (Пустой уровень). В окне просмотра должна отображаться пустая сцена по умолчанию.

2. На вкладке **Modes** (Режимы) выберите **Basic** (Основные) и перетащите в сцену элемент **PlayerStart**. 
    * Установите для параметра **Location** (Расположение) значения **X = 0**, **Y = 0** и **Z = 0** на вкладке **Details** (Сведения), чтобы расположить пользователя в центре сцены при запуске приложения.

![Окно просмотра с элементом PlayerStart](images/unreal-uxt/2-playerstart.PNG)

3. Перетащите в сцену элемент **Cube** (Куб) с вкладки **Basic** (Основные). 
    * Установите для параметра **Location** (Расположение) значения **X = 50**, **Y = 0** и **Z = 0**, чтобы в начале игры куб располагался в 50 см от игрока. 
    * Установите для параметра **Scale** (Масштаб) значения **X = 0,2**, **Y = 0,2** и **Z = 0,2**, чтобы уменьшить размеры куба. 

Куб не будет виден, пока в сцену не добавлен источник света. Это и будет нашей последней задачей перед тем, как протестировать сцену.

4. Перейдите на вкладку **Lights** (Свет) на панели **Modes** (Режимы) и перетащите в сцену элемент **Directional Light** (Направленный свет), разместив его над элементом **PlayerStart**, чтобы он был виден.

![Окно просмотра после добавления света](images/unreal-uxt/2-light.PNG)

5. Выберите элементы **File > Save Current** (Файл > Сохранить текущий), присвойте уровню имя **Main** (Главный) и нажмите кнопку **Save** (Сохранить). 

Сцена готова. Чтобы увидеть куб в действии, нажмите кнопку **Play** (Воспроизвести) на панели инструментов. Когда будете готовы действовать дальше, нажмите клавишу **ESC**, чтобы остановить приложение.

![Куб в окне просмотра](images/unreal-uxt/2-cube.PNG)

Теперь в настроенную сцену можно добавить шахматную доску и фигуру, чтобы получить готовую пространственную среду приложения.

## <a name="importing-assets"></a>Импорт ресурсов
Пустая сцена выглядит скучновато, но мы сейчас это исправим, импортировав в проект готовые ресурсы.

1. Скачайте файл с папкой активов с сайта [GitHub](https://github.com/microsoft/MixedReality-Unreal-Samples/blob/master/ChessApp/ChessAssets.7z) и распакуйте его с помощью [7-zip](https://www.7-zip.org/).

2. В обозревателе содержимого (**Content Browser**) выберите элементы **Add New > New Folder** (Добавить > Папка) и присвойте новой папке имя **ChessAssets**. 
    * Дважды щелкните только что созданную папку. В нее мы будем импортировать трехмерные ресурсы.

![Отображение и скрытие панели источников](images/unreal-uxt/2-showhidesources.PNG)

3. В обозревателе содержимого (**Content Browser**) нажмите кнопку **Import** (Импорт), выберите все элементы из папки с распакованными ресурсами и нажмите кнопку **Open** (Открыть). 
    * Ресурсы содержат сетки трехмерных объектов для шахматной доски и фигур в формате FBX, а также файлы текстурных карт в формате TGA, на основе которых мы создадим материалы для доски и фигур.  

4. Когда откроется всплывающее окно FBX Import Options (Параметры импорта FBX-файлов), разверните раздел **Material** (Материал) и смените значение параметра **Material Import Method** (Метод импорта материала) на **Do Not Create Material** (Не создавать материал).
    * Нажмите кнопку **Import All** (Импортировать все).

![Параметры импорта FBX-файлов](images/unreal-uxt/2-nocreatemat.PNG)

Это все, что нужно для импорта ресурсов. Следующая группа задач — создать элементарные блоки, из которых будет строиться приложение, с использованием схем.

## <a name="adding-blueprints"></a>Добавление схем

1. В обозревателе содержимого (**Content Browser**) выберите элементы **Add New > New Folder** (Добавить > Папка) и присвойте новой папке имя **Blueprints**. 

> [!NOTE]
> [Схемы](https://docs.unrealengine.com/en-US/Engine/Blueprints/index.html) — это специальные ресурсы, позволяющие создавать новые типы субъектов и события уровня скрипта с помощью интерфейса на основе узлов. 

2. Дважды щелкните папку **Blueprints**, затем щелкните правой кнопкой мыши и выберите **Blueprint Class** (Класс схемы).         
    * Выберите **Actor** (Субъект) и присвойте новой схеме имя **Board**. 

![Выбор родительского класса для новой схемы](images/unreal-uxt/2-bpparent.PNG)

Новая схема **Board** появится в папке **Blueprints**, как можно видеть на следующем снимке экрана. 

![Новая схема для шахматной доски](images/unreal-uxt/2-bpboard.PNG)

Теперь можно добавлять материалы к созданным объектам.

## <a name="working-with-materials"></a>Работа с материалами
По умолчанию созданные объекты имеют серый цвет, а хотелось бы чего-то повеселее. Последняя группа задач в этом руководстве — добавление материалов и сеток к объектам.

1. Дважды щелкните схему **Board**, чтобы открыть редактор схем. 

2. На панели **Components** (Компоненты) выберите элементы **Add Component > Scene** (Добавить компонент > Сцена) и присвойте новой сцене имя **Root**. Обратите внимание, что **Root** отобразится как дочерний объект элемента **DefaultSceneRoot** (см. снимок экрана ниже).

![Замена корня в схеме](images/unreal-uxt/2-root-blueprint.PNG)


3. Перетащите элемент **Root** на **DefaultSceneRoot**, чтобы заменить последний и избавиться от шара в окне просмотра. 

![Замена главного элемента](images/unreal-uxt/2-root.PNG)


4. На панели **Components** (Компоненты) выберите элементы **Add Component > Static Mesh** (Добавить компонент > Статическая сетка) и присвойте новой сетке имя **SM_Board**. Она отобразится как дочерний объект элемента **Root**.

![Добавление статической сетки](images/unreal-uxt/2-sm-board.PNG)

4. Выберите элемент **SM_Board**, прокрутите панель **Details** (Сведения) до раздела **Static Mesh** (Статическая сетка) и выберите в раскрывающемся списке вариант **ChessBoard**. 

![Сетка шахматной доски в окне просмотра](images/unreal-uxt/2-sm-board-view.PNG)

5.  На той же панели **Details** (Сведения) разверните раздел **Materials** (Материалы) и выберите в раскрывающемся списке элементы **Create New Asset > Material** (Создать ресурс > Материал). 
    * Присвойте новому материалу имя **M_ChessBoard** и сохраните его в папке **ChessAssets**. 

![Создание нового материала](images/unreal-uxt/2-newmat.PNG)

6.  Дважды щелкните материал **M_ChessBoard**, чтобы открыть редактор материалов. 

![Открытие редактора материалов](images/unreal-uxt/2-material-editor.PNG)

7. В окне Material Editor (Редактор материалов) щелкните правой кнопкой мыши и найдите узел **Texture Sample** (Пример текстуры). 
    * На панели **Details** (Сведения) разверните раздел **Material Expression Texture Base** (Основа текстуры для выражения материала) и установите для параметра **Texture** (Текстура) значение **ChessBoard_Albedo**. 
    * Перетащите маркер вывода **RGB** на маркер Base Color (Основной цвет) элемента **M_ChessBoard**. 

![Установка основного цвета](images/unreal-uxt/2-boardalbedomat.PNG)

8.  Повторите предыдущий шаг еще четыре раза и создайте четыре новых узла **Texture Sample** (Пример текстуры), настроив их следующим образом:
    * Установите для параметра **Texture** (Текстура) значение **ChessBoard_AO** и свяжите закрепление **RGB** с закреплением **Ambient Occlusion** (Рассеянное затенение).
    * Установите для параметра **Texture** (Текстура) значение **ChessBoard_Metal** и свяжите закрепление **RGB** с закреплением **Metallic** (Металлик). 
    * Установите для параметра **Texture** (Текстура) значение **ChessBoard_Normal** и свяжите закрепление **RGB** с закреплением **Normal** (Обычный).
    * Установите для параметра **Texture** (Текстура) значение **ChessBoard_Rough** и свяжите закрепление **RGB** с закреплением **Roughness** (Шероховатость). 
    * Нажмите кнопку **Сохранить**. 

![Подключение оставшихся текстур](images/unreal-uxt/2-boardmat.PNG)

Прежде чем продолжать, убедитесь, что материал настроен так, как показано на снимке экрана выше.

## <a name="populating-the-scene"></a>Заполнение сцены
Если вы вернетесь к схеме **Board**, то увидите, что к ней уже применен созданный только что материал. Осталось только настроить сцену. Сначала изменим свойства, как описано ниже, чтобы придать доске разумные размеры и расположить ее под правильным углом в сцене:
1.  Установите для параметра **Scale** (Масштаб) значение **(0,05, 0,05, 0,05)** , а для параметра **Z Rotation** (Поворот по оси Z) — значение **90**. 
    * Нажмите кнопку **Compile** (Компилировать) в верхней панели инструментов, а затем кнопку **Save** (Сохранить), после чего вернитесь в главное окно. 

![Шахматная доска после применения материалов](images/unreal-uxt/2-chessboard.PNG)

2.  Щелкните правой кнопкой мыши **Cube > Edit > Delete** (Куб > Изменить > Удалить) и перетащите элемент **Board** из обозревателя контента (**Content Browser**) в окно просмотра. 
    * Установите для параметра **Location** (Расположение) значения **X = 80**, **Y = 0** и **Z = -20**. 

3.  Нажмите кнопку **Play** (Воспроизвести), чтобы просмотреть созданную доску на уровне. Нажмите клавишу **ESC**, чтобы вернуться в редактор. 

Теперь по тому же алгоритму, что и с доской, создадим шахматную фигуру:

1. Дважды щелкните папку **Blueprints**, щелкните правой кнопкой мыши и выберите элемент **Blueprint Class** (Класс схемы), а затем — элемент **Actor** (Субъект). Присвойте субъекту имя **WhiteKing**.

2. Дважды щелкните элемент **WhiteKing**, чтобы открыть его в редакторе схем, выберите элементы **Add Component > Scene** (Добавить компонент > Сцена) и присвойте сцене имя **Root**. 
    * Замените элемент **DefaultSceneRoot**, перетащив на него элемент **Root**. 

3. Выберите **Add Component > Static Mesh** (Добавить компонент > Статическая сетка) и присвойте компоненту имя **SM_King**. 
    * На панели Details (Сведения) установите для параметра **Static Mesh** (Статическая сетка) значение **Chess_King**, а для параметра **Material** (Материал) — значение **M_ChessWhite**, соответствующее новому материалу. 

4. Откройте материал **M_ChessWhite** в редакторе материалов и подключите узлы **Texture Sample** (Пример текстуры) следующим образом:
   * Установите для параметра **Texture** (Текстура) значение **ChessWhite_Albedo** и свяжите закрепление **RGB** с закреплением **Base Color** (Основной цвет).
    * Установите для параметра **Texture** (Текстура) значение **ChessWhite_AO** и свяжите закрепление **RGB** с закреплением **Ambient Occlusion** (Рассеянное затенение).
    * Установите для параметра **Texture** (Текстура) значение **ChessWhite_Metal** и свяжите закрепление **RGB** с закреплением **Metallic** (Металлик). 
    * Установите для параметра **Texture** (Текстура) значение **ChessWhite_Normal** и свяжите закрепление **RGB** с закреплением **Normal** (Обычный).
    * Установите для параметра **Texture** (Текстура) значение **ChessWhite_Rough** и свяжите закрепление **RGB** с закреплением **Roughness** (Шероховатость). 
    * Нажмите кнопку **Сохранить**. 

Прежде чем продолжать, убедитесь, что материал **M_ChessKing** настроен, как показано на рисунке ниже.

![Создание материала для шахматного короля](images/unreal-uxt/2-chesskingmat.PNG)

Все почти готово, осталось лишь добавить новую шахматную фигуру в сцену: 

1. Откройте схему **WhiteKing** и установите для параметра **Scale** (Масштаб) значение **(0,05, 0,05, 0,05)** , а для параметра **Z Rotation** (Поворот по оси Z) — значение **90**.
    * Скомпилируйте схему и сохраните ее, а затем вернитесь в главное окно. 

2.  Перетащите элемент **WhiteKing** в окно просмотра, переключитесь на панель **World Outliner** (Структура мира) и перетащите элемент **WhiteKing** на элемент **Board** в качестве дочернего объекта.

![Структура мира](images/unreal-uxt/2-child.PNG)

3.  На панели **Details** (Сведения) в разделе **Transform** (Преобразование) установите для параметра **Location** (Расположение) элемента **WhiteKing** значения **X = -26**, **Y = 4** и **Z = 0**.

Готово! Нажмите кнопку **Play** (Воспроизвести), чтобы увидеть уровень с объектами в действии, а когда захотите выполнить выход, нажмите клавишу **ESC**. Вы ознакомились со множеством возможностей при создании простого проекта. Теперь вы можете перейти к следующей части серии — настройке проекта для смешанной реальности. 

[Следующий раздел: 3. Настройка проекта для смешанной реальности](unreal-uxt-ch3.md)
