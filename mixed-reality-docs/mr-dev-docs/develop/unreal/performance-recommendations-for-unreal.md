---
title: Рекомендации по производительности для Unreal
description: Рекомендации по оптимизации производительности для приложений смешанной реальности в Unreal
author: hferrone
ms.author: v-hferrone
ms.date: 5/5/2020
ms.topic: article
ms.localizationpriority: high
keywords: Unreal, Unreal Engine 4, UE4, HoloLens, HoloLens 2, смешанная реальность, производительность, оптимизация, параметры, документация
ms.openlocfilehash: 21bd3ee9fb7db23eab9365e41adfd0033aa0046e
ms.sourcegitcommit: 520c69eb761ad6083b36f448bbcfab89e343e40d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2020
ms.locfileid: "94549132"
---
# <a name="performance-recommendations-for-unreal"></a>Рекомендации по производительности для Unreal

## <a name="overview"></a>Обзор

Эта статья служит продолжением обсуждения, начатого в [рекомендациях по оптимизации производительности для смешанной реальности](../platform-capabilities-and-apis/understanding-performance-for-mixed-reality.md), но посвящена функциям, специфичным для Unreal Engine. Прежде чем продолжать, рекомендуется прочесть о факторах, ограничивающих производительность приложения, анализе и профилировании приложений смешанной реальности, а также общих настройках, повышающих производительность.

## <a name="recommended-unreal-project-settings"></a>Рекомендуемые параметры для проекта Unreal
Каждый из параметров, о которых идет речь ниже, можно найти в разделе **Edit > Project Settings** (Правка > Параметры проекта).

1. При использовании мобильного отрисовщика виртуальной реальности:
    * Прокрутите до раздела **Project** (Проект), выберите **Target Hardware** (Целевое оборудование) и выберите целевую платформу **Mobile/Tablet** (Мобильное устройство или планшет).

![Выбор мобильного устройства в качестве целевого](images/unreal/performance-recommendations-img-01.png)

2. При использовании стандартного отрисовщика (forward renderer): 
    * Эта функция намного больше подходит для смешанной реальности, чем конвейер отложенной отрисовки (deferred rendering) по умолчанию. В основном это обусловлено тем, что некоторые функции можно по отдельности отключить. 
    * Дополнительные сведения см. в [документации по Unreal](https://docs.unrealengine.com/Platforms/VR/DevelopVR/VRPerformance/index.html).

![Стандартная отрисовка (forward rendering)](images/unreal/performance-recommendations-img-04.png)

3. Использование нескольких представлений для мобильных устройств:
    * Прокрутите до раздела **Engine** (Подсистема), выберите пункт **Rendering** (Отрисовка), разверните раздел **VR** (Виртуальная реальность) и установите флажки **Instanced Stereo** (Параллельное стерео) и **Mobile Multi-View** (Мобильная мультиотрисовка). Необходимо снять флажок Mobile HDR (HDR для мобильных устройств).

![Параметры отрисовки виртуальной реальности](images/unreal/performance-recommendations-img-03.png)

4. При использовании OpenXR убедитесь, что выбран вариант **По умолчанию** или **D3D12** для параметра **RHI по умолчанию**.
    * Вариант **D3D11** приведет к ухудшению производительности, так как платформе придется выполнять дополнительный проход отрисовки. **D3D12** улучшает производительность отрисовки (и не требует дополнительного прохода).

![RHI по умолчанию](images/unreal/performance-recommendations-img-09.png)

5. Отключение затуманивания вершин (vertex fogging): 
    * Затуманивание вершин применяет расчеты тумана к каждой вершине в многоугольнике, а затем интерполирует результаты на поверхность многоугольника. Если в игре не используется туман, выберите этот параметр, чтобы отключить туман и повысить производительность шейдеров.

![Параметры затуманивания вершин](images/unreal/performance-recommendations-img-05.png)

6. Отключение отбрасывания загораживаемых объектов:
    * Прокрутите до раздела **Engine** (Подсистема), выберите **Rendering** (Отрисовка), разверните раздел **Culling** (Отбрасывание объектов) и снимите флажок **Occlusion Culling** (Отбрасывание загораживаемых объектов).
        + Если вам требуется удаление скрытых объектов для подробной отрисовки сцены, рекомендуется установить флажок **Support Software Occlusion Culling** (Поддержка программного удаления скрытых объектов) в разделе **Engine > Rendering** (Движок > Отрисовка). Это позволит Unreal выполнять соответствующую обработку на центральном процессоре, избегая запросов для этой цели к GPU, которые выполняются неэффективно на HoloLens 2.
    * GPU мобильных устройств медленно выполняют отбрасывание загораживаемых объектов. Как правило, в основном GPU должен выполнять отрисовку. Если вы считаете, что такое отбрасывание увеличит производительность, попробуйте включить программное отбрасывание. Обратите внимание, что включение программного отбрасывания может ухудшить производительность, если на ЦП уже выполняется большое число вызовов отрисовки.

![Отключение отбрасывания загораживаемых объектов](images/unreal/performance-recommendations-img-02.png)

7. Отключение настраиваемого прохода трафарета глубины:
    * Эта функция требует дополнительного прохода, то есть она выполняется медленно. Применение прозрачности также выполняется медленно в Unreal. Дополнительные сведения см. в [документации по Unreal](https://docs.unrealengine.com/Engine/Performance/Guidelines/index.html).

![Трафарет глубины](images/unreal/performance-recommendations-img-06.png)

8. Сокращение числа каскадных карт теней: 
    * Сокращение числа карт теней улучшит производительность. Как правило, для этого параметра нужно задать значение 1 (если это не приводит к заметному ухудшению качества). 

![Каскадные карты теней](images/unreal/performance-recommendations-img-07.png)

## <a name="optional-settings"></a>Необязательные параметры

> [!NOTE]
> Следующие параметры могут улучшить производительность, но за счет отключения некоторых функций. Используйте их, только если вы уверены, что эти функции вам не потребуются.

1. Сокращение числа преобразований шейдеров на мобильных устройствах
    * Если ваши источники света не двигаются независимо от камеры, вы можете задать для этого параметра значение 0. Его основное преимущество — он позволяет Unreal не выполнять некоторые преобразования шейдеров и ускорить их компиляцию.

![Сокращение числа преобразований шейдеров на мобильных устройствах](images/unreal/performance-recommendations-img-08.png)

## <a name="see-also"></a>См. также раздел
* [Рекомендации по повышению производительности для Unreal Engine на мобильных устройствах]( https://docs.unrealengine.com/Platforms/Mobile/Performance/index.html)