---
title: Создание первого приложения для HoloLens в Unreal
description: Сведения о том, как правильно настроить проект Unreal с объектами сцены и взаимодействиями ввода для разработки в среде смешанной реальности для HoloLens.
author: hferrone
ms.author: safarooq
ms.date: 01/19/2021
ms.topic: article
ms.localizationpriority: high
keywords: Unreal, Unreal Engine 4, редактор Unreal, UE4, HoloLens, HoloLens 2, смешанная реальность, разработка, документация, руководства, функции, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности, перенос, обновление
ms.openlocfilehash: 467987f69b50c0ec635c99899d6bcecab5a62af0
ms.sourcegitcommit: 59c91f8c70d1ad30995fba6cf862615e25e78d10
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99421433"
---
# <a name="creating-your-first-hololens-unreal-application"></a>Создание первого приложения для HoloLens в Unreal

С помощью этого руководства вы создадите и запустите свое первое приложение смешанной реальности для HoloLens в Unreal Engine. Как это заведено, вы создадите простое приложение Hello World, а именно такое, которое отображает куб на экране. Чтобы сделать его более наглядным, вы также создадите первый жест для поворота куба и выхода из приложения. 

## <a name="objectives"></a>Задачи

* Создание проекта HoloLens.
* Активация нужных подключаемых модулей.
* Создание актива данных ARSessionConfig.
* Настройка возможностей ввода с помощью жестов.
* Создание базового уровня.
* Реализация жеста сжатия.

## <a name="creating-a-new-project"></a>Создание нового проекта

Первое, что вам понадобится для работы — это проект. Если вы только начинаете разработку на Unreal, [скачайте вспомогательные файлы](tutorials/unreal-uxt-ch6.md#packaging-and-deploying-the-app-via-device-portal) из Epic Launcher.

1. Запуск Unreal Engine
2. В разделе **New Project Categories** (Категории для нового проекта) выберите **Games** (Игры) и щелкните **Next** (Далее):

![Открытое окно "Недавние проекты" с выделенным элементом "Games" (Игры)](images/unreal-quickstart-img-01.png)

3. Выберите шаблон **Blank** (Пустой) и щелкните **Next** (Далее):

![Окно обозревателя проектов Unreal с выделенным шаблоном Blank](images/unreal-quickstart-img-02.png)

4. В разделе **Project Settings** (Параметры проекта) установите значения **C++, Scalable 3D or 2D, Mobile/Tablet** (C++, масштабируемый трехмерный или двухмерный, мобильное устройство или планшет) и **No Starter Content** (Без начального содержимого), затем выберите расположение для сохранения и щелкните **Create Project** (Создать проект).

> [!NOTE] 
> Вам нужно выбрать C++ вместо проекта схемы, чтобы позднее добавить подключаемый модуль OpenXR. В этом кратком руководстве используется подключаемый модуль OpenXR, по умолчанию входящий в состав Unreal Engine. Но мы рекомендуем скачать и использовать официальный подключаемый модуль OpenXR корпорации Майкрософт. Для этого необходимо использовать проект C++.

![Окно параметров проекта, где выделены поля для выбора проекта, производительности, целевой платформы и начального содержимого](images/unreal-quickstart-img-03.png)

Новый проект должен автоматически открыться в редакторе Unreal, и тогда можно перейти к следующему этапу.

## <a name="enabling-required-plugins"></a>Включение необходимых подключаемых модулей

Вам потребуется активировать два подключаемых модуля, прежде чем вы сможете добавлять объекты в сцену.

1. Выберите **Edit > Plugins** (Правка > Подключаемые модули) и выберите вариант **Augmented Reality** (Дополненная реальность) в списке встроенных категорий.
* Прокрутите список до пункта **HoloLens** и установите флажок **Enabled** (Включено).

![Окно подключаемых модулей, где открыт раздел дополненной реальности и выделен элемент HoloLens](images/unreal-quickstart-img-04.png)

2. Введите **OpenXR** в поле поиска, расположенном в правом верхнем углу, затем включите подключаемые модули **OpenXR** и **OpenXRMsftHandInteraction**:

![Окно подключаемых модулей, где включен OpenXR](images/unreal-quickstart-img-05.jpg)

![Окно подключаемых модулей, где включено взаимодействие с руками Open XR Msft](images/unreal-quickstart-img-06.jpg)

3. Перезапустите редактор

> [!NOTE]
> В этом руководстве используется OpenXR, но два установленных ранее подключаемых модуля в настоящее время не предоставляют полный набор возможностей для разработки решений для HoloLens. Подключаемый модуль HandInteraction обеспечит поддержку для жеста "сжатия", который вы примените далее, но для более сложного взаимодействия потребуется [скачать подключаемый модуль OpenXR](https://github.com/microsoft/Microsoft-OpenXR-Unreal).

Завершив настройку подключаемых модулей, переходите к созданию содержимого.

## <a name="creating-a-level"></a>Создание уровня

Следующая задача — создать игровую обстановку с начальной точкой и кубом, задающим начало отсчета и масштаб.

1. Выберите **File > New Level** (Файл > Создать уровень), а затем **Empty Level** (Пустой уровень). В окне просмотра должна отображаться пустая сцена по умолчанию.
2. На вкладке **Modes** (Режимы) выберите **Basic** (Основные) и перетащите в сцену элемент **PlayerStart**.
* На вкладке **Details** (Сведения) установите для параметра **Location** (Расположение) значения **X = 0, Y = 0** и **Z = 0**, чтобы размещать пользователя в центре сцены при запуске приложения.

![Сцена редактора Unreal, где добавлены расположение и начальная позиция игрока](images/unreal-quickstart-img-07.png)

3. С вкладки **Basic** (Основные) перетащите в сцену элемент **Cube** (Куб).
* Задайте для параметра **Location** (Расположение) этого куба значения **X = 50, Y = 0** и **Z = 0**, чтобы при запуске размещать куб на расстоянии 50 см от игрока.
* Измените параметр **Scale** (Масштаб) для этого куба на значение **X = 0,2, Y = 0,2** и **Z = 0,2** 

Куб не будет виден, пока в сцену не добавлен источник света. Это и будет нашей последней задачей перед тем, как протестировать сцену.

4. На панели **Modes** (Режимы) перейдите на вкладку **Lights** (Освещение) и перетащите с нее в сцену элемент **Directional Light** (Направленное освещение),
* разместив его над элементом **PlayerStart** так, чтобы он был виден.

![Сцена редактора Unreal, где добавлены куб и источник направленного освещения](images/unreal-quickstart-img-08.png)

5. Выберите элементы **File > Save Current** (Файл > Сохранить текущий), присвойте уровню имя **Main** (Главный) и щелкните **Save** (Сохранить).

Сцена готова. Чтобы увидеть куб в действии, нажмите кнопку **Play** (Воспроизвести) на панели инструментов. Когда будете готовы действовать дальше, нажмите клавишу ESC, чтобы остановить приложение.

![Сцена в режиме воспроизведения, на которой в середине экрана размещен куб](images/unreal-quickstart-img-09.png)

Итак, настройка сцены завершена, и мы можем подготовить ее к простым взаимодействиям в режиме дополненной реальности (AR). Сначала вам нужно создать сеанс AR и добавить схемы, чтобы обеспечить взаимодействие с руками.

## <a name="adding-a-session-asset"></a>Добавление актива для сеанса

Сеансы дополненной реальности в Unreal не возникают сами по себе. Для работы с сеансом требуется ресурс данных ARSessionConfig, который мы сейчас и добавим:

1. В **обозревателе содержимого** выберите **Add New > Miscellaneous > Data Asset** (Добавить > Прочее > Актив данных) и перейдите в корень папки Content.
2. Выберите **ARSessionConfig**, щелкните **Select** (Выбрать) и присвойте активу имя **ARSessionConfig**:

![Открытое окно выбора класса для актива данных, где выделен актив конфигурации сеанса дополненной реальности](images/unreal-quickstart-img-10.png)

2. Дважды щелкните **ARSessionConfig**, чтобы открыть этот актив, а затем **сохраните** его со значениями по умолчанию. Это действие вернет вас в основное окно:

![Окно сведений об активе конфигурации для сеанса дополненной реальности](images/unreal-quickstart-img-11.png)

Следующий шаг — настроить сеанс дополненной реальности таким образом, чтобы он запускался при загрузке уровня и останавливался при его завершении. К счастью, для этого в Unreal есть специальная схема **Level Blueprint** (Схема уровня), которая работает как глобальный граф событий, относящихся к уровню. Если подключить ресурс ARSessionConfig на схеме Level Blueprint (Схема уровня), сеанс дополненной реальности будет гарантированно стартовать в момент начала игры.

3. На панели инструментов редактора выберите **Blueprints > Open Level Blueprint** (Схемы > Открыть схему уровня):

![Открытое меню Blueprints (Схемы), где выделен параметр Open Level Blueprint (Открыть схему уровня)](images/unreal-quickstart-img-12.png)

4. Перетащите узел выполнения (значок с направленной вправо стрелкой) из узла **Event BeginPlay** и отпустите его.
* Найдите узел **Start AR Session** (Запуск сеанса дополненной реальности) и нажмите клавишу ВВОД.
* В разделе **Session Config** (Параметры сеанса) щелкните стрелку раскрывающегося списка **Select Asset** (Выбор актива) и выберите актив **ARSessionConfig**.

![Граф схемы, на котором начало воспроизведения события подключено к функции запуска сеанса дополненной реальности](images/unreal-quickstart-img-13.png)

5. Щелкните правой кнопкой мыши в EventGraph и создайте новый узел **Event EndPlay** (Завершение воспроизведения события). 
* Перетащите закрепление выполнения и отпустите его, а затем введите **Stop AR Session** (Завершить сеанс дополненной реальности) для поиска и нажмите клавишу ВВОД. 
* Нажмите кнопку **Compile** (Компилировать), а затем **Save** (Сохранить). Это действие вернет вас в главное окно.

> [!IMPORTANT]
> Если сеанс дополненной реальности не останавливается по окончании уровня, некоторые функции могут не работать после перезапуска приложения при потоковой передаче данных на гарнитуру.

![Конечный узел события, присоединенный к функции "stop ar session" (Прекратить выполнение сеанса)](images/unreal-quickstart-img-14.png)

## <a name="setting-up-inputs"></a>Настройка входных данных

1. Щелкните **Edit > Project Settings** (Правка > Параметры проекта) и найдите раздел **Engine > Input** (Движок > Вход).
2. Щелкните значок **+** рядом с элементом **Action Mappings** (Сопоставления действий) и создайте действия **RightPinch** и **LeftPinch**:

![Привязка входных параметров, где выделены сопоставления действий сжатия слева и справа](images/unreal-quickstart-img-15.jpg)

3. Сопоставьте действия **RightPinch** и **LeftPinch** с соответствующими действиями **взаимодействия с руками OpenXR Msft**:

![Область сопоставления действий, где выделены параметры взаимодействия с руками OpenXR Msft](images/unreal-quickstart-img-16.jpg)

## <a name="setting-up-gestures"></a>Настройка жестов

Теперь, когда мы настроили возможности ввода, мы можем приступить к интересной части. А именно, к добавлению жестов. Мы настроим вращение куба при сжатии справа и выход из приложения при сжатии слева.

1. Откройте схему уровня (**Level Blueprint**) и добавьте действия **InputAction RightPinch** и **InputAction LeftPinch**.
* Подключите действие сжатия справа к действию **AddActorLocalRotation**, у которого целевым объектом является созданный ранее **куб**, а параметр **Delta Rotation** имеет значения **X = 0, Y = 0** и **Z = 20**. Теперь куб будет вращаться на 20 градусов при каждой активации сжатия
* Подключите событие сжатия слева к действию **Quit Game** (Выход из игры).

![Открытое окно схемы уровня, где настроены действия ввода для событий сжатия справа и слева](images/unreal-quickstart-img-17.jpg)

2. В параметрах **Transform** (Преобразование) для этого куба задайте параметру **Mobility** (Мобильность) значение **Movable** (Перемещаемый), чтобы объект мог динамически перемещаться:

![Параметры преобразования, где выделено свойство перемещаемости](images/unreal-quickstart-img-18.jpg)

Теперь вы готовы к развертыванию и тестированию приложения!