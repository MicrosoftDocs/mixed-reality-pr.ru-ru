---
title: Пространственные аудио учебники — 5. Использование реверберации для добавления эффекта расстояния пространственному звуку
description: Добавьте переглаголные эффекты, чтобы улучшить смысл варианта расстояния до пространственного звука.
author: kegodin
ms.author: v-hferrone
ms.date: 02/05/2021
ms.topic: article
keywords: Смешанная реальность, Unity, учебник, hololens2, Пространственный звук, МРТК, набор средств для смешанной реальности, UWP, Windows 10, ХРТФ, функция передачи, связанная с головным управлением, переглагол, Microsoft Спатиализер, аудио микшер, переглаголы SFX
ms.openlocfilehash: 6f41fe904c21591915e0ef13b61dc6bff04527fe
ms.sourcegitcommit: 4a6c26615d52776bdc4faab70391592092a471fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2021
ms.locfileid: "110712691"
---
# <a name="5-using-reverb-to-add-distance-to-spatial-audio"></a>5. Использование реверберации для добавления эффекта расстояния пространственному звуку

## <a name="overview"></a>Обзор

В предыдущем учебном курсе вы добавили пространственность для звуков, чтобы дать им представление о направлении в этом учебнике, чтобы дать звуковому расприятию силы.

## <a name="objectives"></a>Задачи

* Улучшение наблюдаемого расстояния источников звука путем добавления переглагола.
* Управление воспринимаемым расстоянием звука с помощью расстояния прослушивателя к голограмме.

## <a name="add-a-mixer-group-and-a-reverb-effect"></a>Добавление группы микшера и действия по передействию

В [учебнике звуки взаимодействия с кнопкой спатиализинг](unity-spatial-audio-ch2.md)мы добавили микшер. Микшер включает одну **группу** по умолчанию — **master**. Так как мы хотим применить к некоторым звукам только переглаголные эффекты, добавим вторую группу для этих звуков. Чтобы добавить группу, щелкните правой кнопкой мыши главную группу в окне " **аудио-микшер** ", выберите **Добавить дочернюю группу** и укажите подходящее имя, например " _действие комнаты_":

![Добавить дочернюю группу](images/spatial-audio/spatial-audio-05-section1-step1-1.PNG)

Каждая **Группа** имеет собственный набор эффектов. Чтобы добавить действие в новую группу, нажмите кнопку **Добавить...** в новой группе и выберите пункт **перекоманда SFX**:

![Добавление переглагола SFX](images/spatial-audio/spatial-audio-05-section1-step1-2.PNG)

В терминологии «звук» оригинал, унревербератедный звук называется « _сухой_», а звук после фильтрации с помощью фильтра перезапуска называется «защелка _»._ Оба пути отправляются в выходные данные, и их относительные сильные стороны в этом сочетании называются набором задолженности _/сухой_. Завлажный или сухой набор сильно влияет на смысл расстояния.

В результате **переглагола SFX** включены элементы управления для корректировки затронутого или сухой набора. Так как подключаемый модуль **Microsoft спатиализер** обрабатывает сухой путь, мы будем использовать переработку **SFX** только для пути с осторожностью. На панели инспектора **переглагола SFX**:

* Задайте для свойства **уровень сухой** (-10000 МБ) значение наименьшее.
* Задайте для **Свойства комнаты** наибольшее значение (0 МБ).

![Свойства переглагола SFX](images/spatial-audio/spatial-audio-05-section1-step1-3.PNG)

Другие параметры управляют имитацией комнаты. В частности, **время Decay** связано с наблюдаемым размером комнаты.

## <a name="enable-reverb-on-the-video-playback"></a>Включение переглагола при воспроизведении видео

Для включения переглагола в источнике звука необходимо выполнить два действия.

* Маршрутизация **источника звука** в соответствующую **группу**
* Настройка подключаемого модуля **Microsoft спатиализер** для передачи звука в **группу** для обработки

На следующих шагах вы настроите сценарий для управления маршрутизацией аудио и подключайте сценарий управления, предоставляемый с подключаемым модулем **Microsoft спатиализер** , для передачи данных в переглагол.

Выбрав « **четыре** » в иерархии, щелкните **Добавить компонент** в окне инспектора и добавьте **уровень отправки эффектов комнаты (сценарий)**:

![Добавить скрипт уровня отправки](images/spatial-audio/spatial-audio-05-section2-step1-1.PNG)

> [!NOTE]
> Если вы не включите **уровень отправки "воздействие на комнату** " в подключаемом модуле **Microsoft спатиализер** , он не отправляет звук обратно в подсистему аудиозаписи Unity для обработки эффектов.

Компонент **уровня отправки "эффекты комнаты** " включает элемент управления "график", который задает уровень звука, отправляемого в подсистему аудиозаписи Unity для обработки в виде переглагола. Чтобы открыть элемент управления графа, щелкните **уровень отправки эффектов комнаты**.  Щелкните и перетащите зеленую кривую вниз, чтобы установить уровень около-30dB:

![Настройка кривой реглагола](images/spatial-audio/spatial-audio-05-section2-step1-2.PNG)

Затем раскомментируйте 4 строки с комментариями в сценарии **спатиализеонофф** . Теперь сценарий будет выглядеть следующим образом:

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Audio;

[RequireComponent(typeof(AudioSource))]
public class SpatializeOnOff : MonoBehaviour
{
    public GameObject ButtonTextObject;
    public AudioMixerGroup RoomEffectGroup;
    public AudioMixerGroup MasterGroup;

    private AudioSource m_SourceObject;
    private bool m_IsSpatialized;
    private TMPro.TextMeshPro m_TextMeshPro;

    public void Start()
    {
        m_SourceObject = gameObject.GetComponent<AudioSource>();
        m_TextMeshPro = ButtonTextObject.GetComponent<TMPro.TextMeshPro>();
        SetSpatialized();
    }

    public void SwapSpatialization()
    {
        if (m_IsSpatialized)
        {
            SetStereo();
        }
        else
        {
            SetSpatialized();
        }
    }

    private void SetSpatialized()
    {
        m_IsSpatialized = true;
        m_SourceObject.spatialBlend = 1;
        m_TextMeshPro.SetText("Set Stereo");
        m_SourceObject.outputAudioMixerGroup = RoomEffectGroup;
    }

    private void SetStereo()
    {
        m_IsSpatialized = false;
        m_SourceObject.spatialBlend = 0;
        m_TextMeshPro.SetText("Set Spatialized");
        m_SourceObject.outputAudioMixerGroup = MasterGroup;
    }

}
```

После раскомментирования этих строк в инспекторе **сценария спатиализеонофф** добавляются два свойства. назначьте их в окне инспектора компонента **спатиализеонофф** из **четырех**.

Если объект Quad по-прежнему выбран в иерархии, в окне инспектора выберите компонент **скрипта спатиализеонофф** и:

* Установка свойства **группы эффектов комнаты** в новую группу микшеров эффектов комнаты
* Задание свойства **главной группы** для главной группы микшера

![Спатиализе On Off](images/spatial-audio/spatial-audio-05-section2-step1-3.PNG)

## <a name="congratulations"></a>Поздравляем!

Вы завершили учебники по пространственному звуку HoloLens 2 для Unity. Попробуйте приложение в HoloLens 2 или Unity. При нажатии кнопки в приложении для активации пространственной связи сценарий перенаправит звук видео в группу эффектов комнаты, чтобы добавить переглагол. При переключении на стерео вы направите звук в главную группу и не добавите команду.

> [!TIP]
> Сведения о том, как правильно скомпилировать проект Unity и развернуть его в HoloLens 2, см. в разделе [Создание приложения для HoloLens 2](mr-learning-base-02.md#building-your-application-to-your-hololens-2).
