---
title: Создание динамического содержимого с помощью решателей
description: Из этого курса вы узнаете, как с помощью решателей Mixed Reality Toolkit (MRTK) создавать динамическое содержимое.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/05/2021
ms.topic: article
keywords: смешанная реальность, Unity, учебник, HoloLens, MRTK, Mixed Reality Toolkit, UWP, решатели
ms.localizationpriority: high
ms.openlocfilehash: 3060e6f6b1e04f356f2b9d7466c0f8f3481c53ba090f6d8a62405a4da3dc21a4
ms.sourcegitcommit: a1c086aa83d381129e62f9d8942f0fc889ffcab0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "115221246"
---
# <a name="5-creating-dynamic-content-using-solvers"></a>5. Создание динамического содержимого с помощью решателей

В этом учебнике мы рассмотрим способы динамического помещения голограмм с помощью доступных инструментов размещения MRTK, известных как "решатели" и предназначенных для сложных сценариев пространственного размещения. В MRTK решатели — это система сценариев и поведений, которые мы используем, чтобы разрешить объектам следовать за вами, пользователем или другими игровыми объектами на сцене. С их помощью также можно выполнить прикрепление к определенной позиции, что делает приложение интуитивно понятным.

## <a name="objectives"></a>Задачи

* Знакомство с решателями MRTK.
* Узнайте, как использовать решатели для направления пользователя к объектам.
* Узнайте, как использовать решатели для изменения расположения объектов.

## <a name="location-of-solvers-in-the-mrtk"></a>Расположение решателей в MRTK

 Решатели MRTK размещаются в папке пакета SDK MRTK. Чтобы просмотреть доступные в проекте решатели, в окне Project (Проект) перейдите к папке **Packages** > **Mixed Reality Toolkit Foundation** > **SDK** > **Features** > **Utilities** > **Solvers**:

![Окно проекта Unity с выбранной папкой решателей](images/mr-learning-base/base-05-section1-step1-1.png)

В этом учебнике мы рассмотрим реализацию решателя указателей направлений и решателя размещения касанием. Чтобы получить дополнительную информацию о полном наборе решателей, доступных в MRTK, просмотрите раздел [Solvers](/windows/mixed-reality/mrtk-unity/features/ux-building-blocks/solvers/solver) (Решатели) на [портале документации по MRTK](/windows/mixed-reality/mrtk-unity).

> [!NOTE]
> Решатель указателей направлений не расположен в папках решателей, указанных выше. Он расположен в папках Packages > Mixed Reality Toolkit Foundation > SDK > Experimental > Features > Utilities, так как это экспериментальная функция.

## <a name="using-the-directional-indicator-solver-to-direct-the-user-to-objects"></a>Использование решателя указателей направлений для направления пользователя к объектам

В окне проекта перейдите к папке **Assets** > **MRTK.Tutorials.GettingStarted** > **Prefabs**, щелкните и перетащите заготовку **Chevron** в окно иерархии и задайте для него преобразование **положения**, X = 0, Y = 0, Z = 2, чтобы разместить его рядом с объектом RoverExplorer:

![Unity с выбранной созданной заготовкой Chevron](images/mr-learning-base/base-05-section2-step1-1.png)

> [!TIP]
> Если вы обнаружите, что камера или другие значки в сцене скрывают объекты или отвлекают от них внимание, их можно скрыть, <a href="https://docs.unity3d.com/2019.1/Documentation/Manual/GizmosMenu.html" target="_blank">переведя манипуляторы</a> в отключенное положение, как показано на рисунке выше. Дополнительные сведения о меню Gizmos (Манипуляторы) и его применении для оптимизации представления сцены вы можете найти в <a href="https://docs.unity3d.com/Manual/GizmosMenu.html" target="_blank">этом разделе</a> документации.

Переименуйте добавленный объект Chevron на **Indicator**, а затем в окне Inspector (Инспектор) нажмите кнопку **Add Component** (Добавить компонент), чтобы добавить **DirectionalIndicator**.

![Unity с добавленным компонентом решателя DirectionalIndicator](images/mr-learning-base/base-05-section2-step1-2.png)

> [!NOTE]
> При добавлении решателя (в нашем примере — DirectionalIndicator) автоматически добавляется еще компонент SolverHandler, который является обязательным для решателя.

Настройте компоненты DirectionalIndicator и SolverHandler следующим образом:

* Убедитесь, что для параметра **Tracked Target Type** (Тип отслеживаемой цели) компонента **SolverHandler** указано значение **Head** (Головной).
* Назначьте параметру **DirectionalIndicator** компонента **Directional Target** (Целевое направление) значение **RoverExplorer**, перетащив его из окна иерархии в поле **None (Transform)** (Нет (преобразование)).
* Измените значение параметра **View Offset** (Смещение вида) на 0,2.

![Unity с настроенным компонентом решателя DirectionalIndicator](images/mr-learning-base/base-05-section2-step1-3.png)

Нажмите кнопку Play (Воспроизведение), чтобы перейти в игровой режим, затем нажмите и удерживайте правую кнопку мыши, перемещая указатель мыши влево или вправо, чтобы повернуть направление взгляда и проверить следующее поведение.

* Когда вы выйдете из объекта RoverExplorer, появится объект Indicator и будет указывать на объект RoverExplorer.

![Разделенное представление Unity в режиме воспроизведения с используемым решателем DirectionalIndicator](images/mr-learning-base/base-05-section2-step1-4.png)

> [!NOTE]
> Если вы не видите в окне Scene (Сцена) луч направления камеры, проверьте, включено ли меню Gizmos (Манипуляторы), как показано на изображении выше.

> [!TIP]
> Сведения о том, как можно использовать встроенный имитатор ввода, см. в руководстве [по использованию имитации ввода с помощью рук в редакторе для тестирования сцены](/windows/mixed-reality/mrtk-unity/features/input-simulation/input-simulation-service), размещенному на [портале документации MRTK](/windows/mixed-reality/mrtk-unity).

> [!TIP]
> Если на компьютере установлен микрофон, можно легко переключить активное состояние панели Diagnostics (Диагностика), отображаемой в окне Game (Игра), с помощью голосовой команды toggle diagnostics (переключить диагностику). Кроме того, ее можно отключить в разделе MRTK Configuration Profile (Профиль конфигурации MRTK) > Diagnostics (Диагностика) > Enable Diagnostics System (Включить систему диагностики). Обычно рекомендуется оставлять систему диагностики активной во время разработки.

## <a name="using-the-tap-to-place-solver-to-reposition-objects"></a>Использование решателя размещения касанием, чтобы изменить расположение объектов

В окне Hierarchy (Иерархия) выберите объект RoverExplorer > **RoverAssembly**, затем в окне Inspector (Инспектор) нажмите кнопку **Add Component** (Добавить компонент), чтобы добавить компонент **Tap To Place (Script)** (Размещение касанием — скрипт), и настройте его следующим образом:

* Убедитесь, что для параметра **Tracked Target Type** (Тип отслеживаемой цели) компонента **SolverHandler** указано значение **Head** (Головной).
* Снимите флажок **Use Default Surface Normal Offset** (Использовать стандартное смещение поверхности) и убедитесь, что для параметра **Surface Normal Offset** (Стандартное смещение нормали) установлено значение 0.
* Установите флажок **Keep Orientation Vertical** (Оставить вертикальную ориентацию).
* В выпадающем списке **Magnetic Surfaces** > **Element 0** (Магнитные поверхности > Элемент 0) снимите флажки всех параметров, кроме **Spatial Awareness** (Отслеживание пространственного положения).

![Unity с добавленным и настроенным компонентом решателя TapToPlace](images/mr-learning-base/base-05-section3-step1-1.png)

> [!NOTE]
> Параметр Magnetic Surfaces (Магнитные поверхности) определяет, какие объекты может обнаружить компонент Tap To Place (Script) (Размещение касанием — скрипт) при размещении объекта. Если изменить параметр на Spatial Awareness (Отслеживание пространственного положения), компонент Tap To Place (Script) (Размещение касанием — скрипт) сможет поместить луноход на объекты в слое Unity с именем Spatial Awareness (Отслеживание пространственного положения), который по умолчанию является сеткой отслеживания пространственного положения, созданной HoloLens.
>
> Чтобы получить дополнительные сведения о слоях, воспользуйтесь <a href="https://docs.unity3d.com/Manual/Layers.html" target="_blank">этим разделом</a> из документации по Unity.

> [!TIP]
> Если необходимо просмотреть сетку отслеживания пространственного положения при тестировании функций размещения касанием в HoloLens, можно временно установить для параметра отображения наблюдателя виртуальной сетки значение Visible (Видимый). Чтобы вспомнить, как изменить параметр отображения, просмотрите инструкции в разделе [Изменение параметров отображения наблюдателя виртуальной сетки](mr-learning-base-03.md#changing-the-spatial-awareness-display-option).

Если в окне Hierarchy (Иерархия) все еще выбран объект RoverAssembly, в окне инспектора перейдите к событию **On Placing Started ()** и щелкните значок **+** , чтобы добавить новое событие.

![Unity с добавленным событием OnPlacingStarted для скрипта TapToPlace](images/mr-learning-base/base-05-section3-step1-2.png)

Настройте событие следующим образом:

* Назначьте объект **RoverAssembly** в качестве прослушивателя для события On Placing Started (), перетащив его из окна Hierarchy (Иерархия) в поле **None (Object)** (Отсутствует (объект)).
* В раскрывающемся списке **No Function** (Нет функции) выберите **TapToPlace** > **float SurfaceNormalOffset**, чтобы обновить значение свойства SurfaceNormalOffset при срабатывании события.
* Убедитесь, что для аргумента задано значение **0**.

![Unity с настроенным событием OnPlacingStarted для скрипта TapToPlace](images/mr-learning-base/base-05-section3-step1-3.png)

В окне Hierarchy (Иерархия) щелкните правой кнопкой мыши пустое место и выберите **3D Object** (Трехмерный объект) > **Cube (Куб)** , чтобы создать временный объект, представляющий землю, и настройте компонент **Transform** (Преобразование) следующим образом:

* **Position** (Положение): X = 0, Y = –1,65, Z = 6.
* **Rotation** (Поворот): X = 0, Y = 0, Z = 0.
* **Scale** (Масштаб): X = 10, Y = 0,2, Z = 10.

![Unity с добавленным и расположенным объектом временного куба на поверхности](images/mr-learning-base/base-05-section3-step1-4.png)

Не отменяя выбор временного куба в окне Hierarchy (Иерархия), в окне Inspector (Инспектор) выберите в раскрывающимся списке **Layers** (Слои) значение, чтобы параметр слоя куба содержал только слой **Spatial Awareness** (Отслеживание пространственного положения).

![Unity с объектом временного куба на поверхности, для слоя которого задано значение Spatial Awareness (Отслеживание пространственного положения)](images/mr-learning-base/base-05-section3-step1-5.png)

Нажмите кнопку Play (Воспроизведение), чтобы перейти в игровой режим, а затем нажмите и удерживайте правую кнопку мыши, пока взгляд не будет направлен на объект RoverAssembly:

![Разделенное представление Unity в режиме воспроизведения с объектом RoverAssembly, на который падает взгляд](images/mr-learning-base/base-05-section3-step1-6.png)

Нажмите левую кнопку мыши, чтобы запустить процесс размещения касанием:

![Разделенное представление Unity в режиме воспроизведения с начатым размещением TapToPlace](images/mr-learning-base/base-05-section3-step1-7.png)

Нажмите и удерживайте правую кнопку мыши, перемещая указатель мыши влево или вправо для поворота направления взгляда. Если размещение вас устраивает, нажмите левую кнопку мыши:

![Разделенное представление Unity в режиме воспроизведения с завершенным размещением TapToPlace](images/mr-learning-base/base-05-section3-step1-8.png)

После завершения тестирования функции в игровом режиме щелкните правой кнопкой мыши объект Cube (Куб) и нажмите кнопку **Delete** (Удалить), чтобы удалить его со сцены:

![Unity с выбранным объектом временного куба на поверхности с вариантом Delete (Удалить) в контекстном меню](images/mr-learning-base/base-05-section3-step1-9.png)

## <a name="congratulations"></a>Поздравляем!

Из этого учебника вы узнали, как использовать решатель указателя направления MRTK, чтобы элемент пользовательского интерфейса интуитивно направлял пользователя к объектам. Вы также узнали, как использовать решатель размещения касанием, чтобы без проблем изменять расположение объектов.

Чтобы получить дополнительные сведения об этих и других решателях в составе MRTK, ознакомьтесь с руководством [Решатели](/windows/mixed-reality/mrtk-unity/features/ux-building-blocks/solvers/solver) на [портале документации по MRTK](/windows/mixed-reality/mrtk-unity/).

> [!div class="nextstepaction"]
> [Следующее руководство: 6. Создание пользовательских интерфейсов](mr-learning-base-06.md)
