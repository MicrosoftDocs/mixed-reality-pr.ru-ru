---
title: Интеграция Пространственных привязок Azure
description: Пройдите этот курс и узнайте, как реализовать Пространственные привязки Azure в приложении HoloLens 2.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/05/2021
ms.topic: article
keywords: смешанная реальность, Unity, учебник, HoloLens, HoloLens 2, Пространственные привязки Azure, облачные службы Azure, Пользовательское визуальное распознавание Azure, Windows 10
ms.localizationpriority: high
ms.openlocfilehash: 7f85efae0ee24e4785d862873b8b1723460791d2d6a00406a3fd81f465c6faa7
ms.sourcegitcommit: a1c086aa83d381129e62f9d8942f0fc889ffcab0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "115218570"
---
# <a name="4-integrating-azure-spatial-anchors"></a>4. Интеграция Пространственных привязок Azure

Из этого руководства вы узнаете, как использовать **Пространственные привязки Azure**. Вы сохраните данные расположения **отслеживаемого объекта** в виде пространственной привязки Azure. После отправки запроса к привязке появится стрелка, указывающая на расположение.

## <a name="objectives"></a>Задачи

* Изучите основные сведения о Пространственных привязках Azure.
* Узнайте, как настроить сцену для использования Пространственных привязок Azure в этом проекте.
* Узнайте, как выполнить интеграцию для хранения и запрашивания данных расположения.

## <a name="understanding-azure-spatial-anchors"></a>Основные сведения о Пространственных привязках Azure

 **Пространственные привязки Azure** — это часть семейства облачных служб Azure. Решение позволяет сохранять данные расположения привязок. Сохраненные данные расположений привязок можно получить из облака на основе *идентификатора привязки*. К этим данным расположения привязок можно предоставить доступ многоплатформенным устройствам, таким как HoloLens, iOS и Android.

Ознакомьтесь с дополнительными сведениями о [Пространственных привязках Azure](/azure/spatial-anchors/overview).

## <a name="preparing-azure-spatial-anchors"></a>Подготовка Пространственных привязок Azure

Перед началом работы создайте ресурс пространственной привязки на портале Azure.
Узнайте, как создать [ресурс пространственной привязки](/azure/spatial-anchors/quickstarts/get-started-hololens#create-a-spatial-anchors-resource).

## <a name="preparing-the-scene"></a>Подготовка сцены

Из этого раздела вы узнаете, как настроить сцену и внести необходимые изменения.

Выберите объект **MixedRealityToolkit** в окне Hierarchy (Иерархия) и нажмите кнопку **Add Component** (Добавить компонент) в окне Inspector (Инспектор), чтобы добавить **AR Anchor Manager (скрипт)**

![Объект MixedRealityToolkit в Unity с добавленным компонентом AR Anchor Manager ](images/mr-learning-azure/tutorial4-section1-step1-1.png)

> [!NOTE]
> При добавлении компонента диспетчера привязок AR Anchor Manager (скрипт) автоматически добавляется компонент источника сеанса AR Session Origin (скрипт), так как он необходим компоненту диспетчера привязок AR (скрипт).

В окне Project (Проект) последовательно выберите **Assets > MRTK.Tutorials.AzureCloudServices > Prefabs > Manager** (Активы > MRTK.Tutorials.AzureCloudServices > Заготовки > Диспетчер).

![Unity с выбранной заготовкой AnchorManager](images/mr-learning-azure/tutorial4-section1-step1-2.png)

В папке **Manager** (Диспетчер) перетащите заготовку **Anchor Manager** (Диспетчер привязок) в иерархию сцены.

В окне Hierarchy (Иерархия) выберите объект GameObject **Anchor Manager** (Диспетчер привязок). В разделе Inspector (Инспектор) найдите элемент **Spatial Anchor Manager (Script)** (Диспетчер пространственных привязок (скрипт)). Найдите поля идентификатора и ключа учетной записи. Добавьте учетные данные, созданные ранее в рамках выполнения предварительных требований.

![Unity со все еще выбранной добавленной заготовкой AnchorManager](images/mr-learning-azure/tutorial4-section1-step2-1.png)

В иерархии сцены найдите объект **Scene Controller** (Контроллер сцены) и выберите его. Отобразится окно инспектора **Scene Controller** (Контроллер сцены).

![Unity с настроенным компонентом скрипта SceneController](images/mr-learning-azure/tutorial4-section1-step3-1.png)

Вы увидите, что поле **Anchor Manager** (Диспетчер привязок) в компоненте **Scene Controller** (Контроллер сцены) не заполнено. Перетащите **диспетчер привязок** из окна Hierarchy (Иерархия) в сцене в это поле и сохраните сцену.

## <a name="build-and-deploy-the-app-to-your-hololens-2"></a>Создание и развертывание приложения на устройстве HoloLens 2

Пространственные привязки Azure не могут работать в Unity. Поэтому для проверки функциональных возможностей этой службы вам придется развернуть проект на устройстве.

> [!TIP]
> Сведения о том, как правильно скомпилировать проект Unity и развернуть его на HoloLens 2, см. в разделе [Создание приложения для HoloLens 2]((mr-learning-base-02.md#building-and-deploying-to-your-hololens-2).

## <a name="run-the-app-on-your-hololens-2-and-follow-the-in-app-instructions"></a>Запустите приложение на HoloLens 2 и следуйте предоставленным инструкциям

### <a name="create-an-anchor-to-store-a-location"></a>Создание привязки для хранения данных расположения

Из этого раздела вы узнаете, как сохранить данные расположения объекта.

Запустите приложение и щелкните элемент **Set Object** (Задать объект) в главном меню интерфейса.

Присвойте **имя** объекту, который нужно сохранить, и щелкните элемент **Set Object** (Задать объект), чтобы продолжить. Чтобы добавить дополнительные сведения об объекте, выберите **изображение** и опишите объект.

Чтобы сохранить данные расположения, щелкните **Save Location** (Сохранить данные расположения).

Отобразится **указатель привязки**, который можно переместить и установить в расположение, данные которого вам нужно сохранить. После этого отобразится всплывающее окно с подтверждением. Если вы хотите подтвердить и сохранить данные расположения, щелкните **Yes** (Да). Если нет, вы можете изменить расположение, щелкнув **No** (Нет) и выбрав расположение повторно.

Когда вы подтвердите расположение, щелкнув **Yes** (Да), данные расположения и идентификатор привязки будут сохранены в облачном хранилище Azure. После их сохранения в привязке отобразится **тег объекта** с его именем.

Теперь данные расположения объекта успешно сохранены.

### <a name="query-for-finding-an-anchor-location"></a>Запрашивание данных расположения привязки

После успешного сохранения данных расположения привязки вы можете узнать это расположение, выбрав **Search Object** (Поиск объекта) в главном меню.

После щелчка элемента **Search Object** (Поиск объекта) откроется новое всплывающее окно, в котором нужно указать имя искомого объекта.

Введите имя объекта и щелкните **Search Object** (Поиск объекта). Если объект предварительно сохранен и был обнаружен в базе данных, вы получите карту объекта со всеми сведениями о нем, которые вы сохранили ранее.

Теперь щелкните элемент **Show Location** (Показать расположение), чтобы найти объект. Когда вы щелкнете **Show Location** (Показать расположение), система подаст запрос на местоположение объекта в облачном хранилище.

После успешного получения данных расположения **стрелка** направит вас к расположению объекта. Следуйте за знаком стрелки, пока не найдете расположение объекта.

Когда вы найдете объект, сверху отобразится его имя и знак стрелки исчезнет. Теперь можно щелкнуть **тег объекта**, чтобы просмотреть сведения о нем.

## <a name="congratulations"></a>Поздравляем!

Из этого руководства вы узнали, как в Пространственных привязках Azure можно сохранять и извлекать данные расположения объектов на устройстве Hololense 2.

С помощью заключительного руководства вы научитесь добавлять естественный язык как новый метод взаимодействия для своего приложения с помощью **Службы Azure Bot**.

> [!div class="nextstepaction"]
> [Следующее руководство: 5. Интеграция Службы Azure Bot c LUIS](mr-learning-azure-05.md)