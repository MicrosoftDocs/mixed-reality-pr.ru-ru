---
title: 210. Ввод в смешанной реальности — взгляд
description: Выполните приведенное ниже пошаговое руководство по программированию с помощью Unity, Visual Studio и HoloLens, чтобы узнать о концепциях взгляда.
author: keveleigh
ms.author: kurtie
ms.date: 10/22/2019
ms.topic: article
keywords: холотулкит, микседреалититулкит, микседреалититулкит-Unity, Academy, учебник, взгляд, HoloLens, Academy Mixed Reality, Unity, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности, Windows 10
ms.openlocfilehash: 2cbbdba0a74ab94c6a291cbe6af1cd1ae9020fe4
ms.sourcegitcommit: dd13a32a5bb90bd53eeeea8214cd5384d7b9ef76
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94677253"
---
# <a name="mr-input-210-gaze"></a>210. Ввод в смешанной реальности: Взгляд

>[!NOTE]
>Руководства Mixed Reality Academy были разработаны для иммерсивных гарнитур HoloLens (1-го поколения) и иммерсивных гарнитур Mixed Reality.  Поэтому мы считаем, что важно оставить эти руководства для разработчиков, которые ищут рекомендации по разработке для этих устройств.  Данные руководства **_не_** будут обновляться с учетом последних наборов инструментов или возможностей взаимодействия для HoloLens 2.  Они будут сохранены для работы на поддерживаемых устройствах. Опубликован [новый цикл руководств](../../../mr-learning-base-01.md) для HoloLens 2.

[Взгляните](../../../design/gaze-and-commit.md) на первую форму входных данных и раскрывает намерение и осведомленность пользователя. MR-вход 210 (то есть обозреватель проектов) — это глубокое углубление концепций Windows Mixed Reality, связанных с взглядом. Мы будем добавлять в курсор и голограммы сведения о контексте, используя все преимущества вашего приложения о взгляде пользователя.

>[!VIDEO https://www.youtube.com/embed/yKAttGduVp0]

У нас есть удобный-космонавтам, который поможет вам изучить концепции взгляда. В статьях « [Основные сведения 101](../../../develop/unity/tutorials/holograms-101.md)» мы имели простой курсор, который только что проделал взгляд. Сейчас мы перемещая шаг за пределы простого курсора:

* Мы создаем курсор и наши самые голограммы: обе будут изменены в зависимости от того, где пользователь смотрит, или где пользователь *не* смотрит. Это делает их контекстно-зависимым.
* Мы добавим отзыв к нашим курсору и голограммам, чтобы дать пользователю больше контекста на то, что целевое. Отзывы могут быть звуковыми и визуальными элементами.
* Мы покажем, что вы научитесь использовать методы, чтобы помочь пользователям достичь меньшего объема целевых объектов.
* Мы покажем, как привлечь внимание пользователя к голограммам с помощью индикатора направления.
* Мы обсудим методы, с помощью которых пользователь перемещает свои голограммы по всему миру.

>[!IMPORTANT]
>Видеоматериалы, внедренные в каждую из приведенных ниже глав, были записаны с использованием более старой версии Unity и набора средств Mixed Reality. Хотя пошаговые инструкции являются точными и актуальными, в соответствующих видеоматериалах могут отображаться сценарии и визуальные элементы, которые являются неактуальными. Видеоматериалы по-прежнему включены в постерити, так как эти концепции все еще применимы.

## <a name="device-support"></a>Поддержка устройств

<table>
<tr>
<th>Курс</th><th style="width:150px"> <a href="../../../hololens-hardware-details.md">HoloLens</a></th><th style="width:150px"> <a href="../../../discover/immersive-headset-hardware-details.md">Иммерсивные гарнитуры</a></th>
</tr><tr>
<td>210. Ввод в смешанной реальности: Взгляд</td><td style="text-align: center;"> ✔️</td><td style="text-align: center;"> ✔️</td>
</tr>
</table>

## <a name="before-you-start"></a>Перед началом работы

### <a name="prerequisites"></a>Предварительные требования

* КОМПЬЮТЕР с Windows 10, на котором [установлены правильные средства](../../../develop/install-the-tools.md).
* Некоторые основные возможности программирования на C#.
* Вы должны были выполнить [Основные сведения о MR 101](../../../develop/unity/tutorials/holograms-101.md).
* Устройство HoloLens, [настроенное для разработки](../../../develop/platform-capabilities-and-apis/using-visual-studio.md#enabling-developer-mode).

### <a name="project-files"></a>Файлы проекта

* Скачайте [файлы](https://github.com/Microsoft/HolographicAcademy/archive/Holograms-210-Gaze.zip) , необходимые для проекта. Требуется Unity 2017,2 или более поздней версии.
* Отмена архивации файлов на Рабочий стол или другого места для удобства доступа.

>[!NOTE]
>Если вы хотите просмотреть исходный код перед загрузкой, он [доступен на сайте GitHub](https://github.com/Microsoft/HolographicAcademy/tree/Holograms-210-Gaze).

### <a name="errata-and-notes"></a>Ошибки и примечания

* В Visual Studio параметр "Только мой код" должен быть отключен (снят) в разделе Сервис->параметры — >Отладка для попадания в код точек останова в коде.

## <a name="chapter-1---unity-setup"></a>Глава 1. Установка Unity

>[!VIDEO https://www.youtube.com/embed/_Ccn6riQ6vU]

### <a name="objectives"></a>Цели

* Оптимизация Unity для разработки решений для HoloLens.
* Импорт ресурсов и настройка сцены.
* Просмотрите-космонавтам в HoloLens.

### <a name="instructions"></a>Инструкции

1. Запустите Unity.
2. Выберите **Создать проект**.
3. Назовите проект **моделексплорер**.
4. Введите расположение, в котором была отменена Архивация папки " **Взгляните** ".
5. Задайте для проекта значение **3D**.
6. Нажмите кнопку **создать проект**.

### <a name="unity-settings-for-hololens"></a>Параметры Unity для HoloLens

Необходимо разрешить Unity знать, что приложение, которое мы пытаемся экспортировать, должно создать [иммерсивное представление](../../../design/app-views.md) вместо 2D-представления. Это можно сделать, добавив HoloLens в качестве устройства виртуальной реальности.

1. Выберите **изменить > параметры проекта > Player**.
2. На **панели инспектора** для параметров проигрывателя выберите значок **Магазин Windows** .
3. Разверните группу **XR Settings** (Параметры XR).
4. В разделе **Отрисовка** установите флажок **Virtual Reality Supported** (Поддержка виртуальной реальности), чтобы добавить новый список **Virtual Reality SDKs** (SDK виртуальной реальности).
5. Убедитесь, что **Windows Mixed Reality** отображается в списке. В противном случае нажмите **+** кнопку в нижней части списка и выберите **Windows holographic**.

Далее необходимо задать для нашей серверной части скрипта .NET.

1. Перейдите в раздел **изменить > параметры проекта > проигрывателе** (возможно, это можно будет выполнить на предыдущем шаге).
2. На **панели инспектора** для параметров проигрывателя выберите значок **Магазин Windows** .
3. В разделе Настройка **других параметров** убедитесь, что для **серверной части скрипта** задано значение **.NET** .

Наконец, мы будем обновлять наши параметры качества, чтобы добиться высокой производительности HoloLens.

1. Выберите **изменить > параметры проекта > качество**.
2. Щелкните стрелку вниз в строке **по умолчанию** под значком магазина Windows.
3. Выберите **очень низкое** для **приложений Магазина Windows**.

### <a name="import-project-assets"></a>Импорт ресурсов проекта

1. Щелкните правой кнопкой мыши папку **активы** на панели **проект** .
2. Щелкните **Импорт пакета > настраиваемый пакет**.
3. Перейдите к скачанным файлам проекта и щелкните **моделексплорер. пакет unitypackage**.
4. Нажмите кнопку **Открыть**.
5. После загрузки пакета нажмите кнопку " **Импорт** ".

### <a name="setup-the-scene"></a>Настройка сцены

1. В иерархии удалите **основную камеру**.
2. В папке **холотулкит** откройте **входную** папку, а затем откройте папку **Prefabs** .
3. Перетащите **микседреалитикамерапарент** prefab из папки **Prefabs** в **иерархию**.
4. Щелкните правой кнопкой мыши **направленный источник** в иерархии и выберите **Удалить**.
5. В папке **голограмм** перетащите следующие ресурсы в корень **иерархии**:
    * **астроман**
    * **Освещение**
    * **спацеаудиосаурце**
    * **спацебаккграунд**
6. Запустите **режим воспроизведения** ▶, чтобы просмотреть-космонавтам.
7. Щелкните **режим воспроизведения** ▶ еще раз, чтобы **приостанавливаться**.
8. В папке **голограмм** найдите ресурс **фитбокс** и перетащите его в корень **иерархии**.
9. Выберите **фитбокс** на панели **Иерархия** .
10. Перетащите коллекцию **астроман** из **иерархии** в свойство **коллекции голограммы** фитбокс на панели **инспектора** .

### <a name="save-the-project"></a>Сохранение проекта

1. Сохраните новую сцену: **файл > сохранить сцену как**.
2. Щелкните **создать папку** и присвойте имя папке **сцены**.
3. Назовите файл «**моделексплорер**» и сохраните его в папке « **сцены** ».

### <a name="build-the-project"></a>Сборка проекта

1. В Unity выберите **файл > параметры сборки**.
2. Щелкните **Добавить открытые сцены** , чтобы добавить сцену.
3. Выберите **универсальная платформа Windows** в списке **платформа** и щелкните **параметр платформа**.
4. Если вы специально разрабатываете для HoloLens, задайте для параметра **целевое устройство** значение **HoloLens**. В противном случае оставьте его на **любом устройстве**.
5. Убедитесь, что для **типа сборки** задано значение **D3D** и **пакет SDK** установлен в значение " **Последняя установленная версия** " (это должен быть пакет SDK 16299 или более поздней версии).
6. Щелкните **Построить**.
7. Создайте **новую папку** с именем App.
8. Щелкните папку **приложения** одним щелчком мыши.
9. Нажмите кнопку **выбрать папку**.

После завершения Unity появится окно проводника.

1. Откройте папку **приложения** .
2. Откройте **решение Моделексплорер Visual Studio**.

При развертывании в HoloLens:

1. С помощью верхней панели инструментов в Visual Studio измените целевой объект с отладка на **выпуск** и с ARM на **x86**.
2. Щелкните стрелку раскрывающегося списка рядом с кнопкой локальный компьютер и выберите **Удаленный компьютер**.
3. Введите **IP-адрес устройства HoloLens** и задайте для режима проверки подлинности значение **универсальный (незашифрованный протокол)**. Нажмите кнопку **Выбрать**. Если вы не узнаете IP-адрес устройства, проверьте **параметры > сеть & интернет > дополнительные параметры**.
4. В верхней строке меню щелкните **Отладка-> начать без отладки** или нажмите клавиши **CTRL + F5**. Если вы впервые развертываете на устройстве, вам потребуется [связать его с Visual Studio](../../../develop/platform-capabilities-and-apis/using-visual-studio.md#pairing-your-device).
5. После развертывания приложения закройте **фитбокс** с помощью **жеста выбора**.

При развертывании на иммерсивное головной телефон:

1. С помощью верхней панели инструментов в Visual Studio измените целевой объект с отладка на **выпуск** и с ARM на **x64**.
2. Убедитесь, что для целевого объекта развертывания задано значение **локальный компьютер**.
3. В верхней строке меню щелкните **Отладка-> начать без отладки** или нажмите клавиши **CTRL + F5**.
4. После развертывания приложения закройте **фитбокс** , изменив триггер на контроллере движения.

## <a name="chapter-2---cursor-and-target-feedback"></a>Глава 2 — Обратная связь курсора и целевого объекта

>[!VIDEO https://www.youtube.com/embed/S24u0V_T7ZI]

### <a name="objectives"></a>Цели

* Визуальное проектирование и поведение курсора.
* Обратная связь курсора на основе взгляда.
* Отзывы о голограммах на основе взгляда.

Мы собираемся основывать наши усилия на некоторых принципах проектирования курсоров, а именно:

* Курсор всегда находится в наличии.
* Не дайте курсору быть слишком маленьким или большим.
* Избегайте неблизкого содержимого.

### <a name="instructions"></a>Инструкции

1. В папке **холотулкит\инпут\префабс** найдите ресурс **InputManager** .
2. Перетащите **InputManager** в **иерархию**.
3. В папке **холотулкит\инпут\префабс** найдите ресурс **cursor** .
4. Перетащите **курсор** на **иерархию**.
5. Выберите объект **InputManager** в **иерархии**.
6. Перетащите объект **cursor** из **иерархии** в поле **курсора** InputManager **симплесинглепоинтерселектор** в нижней части **инспектора**.

![Настройка простого единичного селектора указателя](images/holograms210-ssps.png)

### <a name="build-and-deploy"></a>Построение и Развертывание

1. Перестройте приложение из **файла > параметры сборки**.
2. Откройте **папку приложения**.
3. Откройте **решение Моделексплорер Visual Studio**.
4. Щелкните **Отладка-> начать без отладки** или нажмите клавиши **CTRL + F5**.
5. Обратите внимание на прорисовку курсора и на то, как он изменяет внешний вид, если он касается голограммы.

### <a name="instructions"></a>Инструкции

1. На панели **Иерархия** разверните объект **астроман** -> **GEO_G** -> **Back_Center** .
2. Дважды щелкните **Interactible.CS** , чтобы открыть его в Visual Studio.
3. Раскомментируйте строки в обратных вызовах **ифокусабле. онфокусентер ()** и **ифокусабле. онфокусексит ()** в **Interactible.CS**. Они вызываются InputManager набора средств Mixed Reality, когда фокус (либо с помощью указателя мыши, либо с помощью контроллера) вводит и выходит из GameObjectа.

```cs
/* TODO: DEVELOPER CODING EXERCISE 2.d */

void IFocusable.OnFocusEnter()
{
    for (int i = 0; i < defaultMaterials.Length; i++)
    {
        // 2.d: Uncomment the below line to highlight the material when gaze enters.
        defaultMaterials[i].EnableKeyword("_ENVIRONMENT_COLORING");
    }
}

void IFocusable.OnFocusExit()
{
    for (int i = 0; i < defaultMaterials.Length; i++)
    {
        // 2.d: Uncomment the below line to remove highlight on material when gaze exits.
        defaultMaterials[i].DisableKeyword("_ENVIRONMENT_COLORING");
    }
}
```

>[!NOTE]
>Мы используем `EnableKeyword` и `DisableKeyword` выше. Чтобы использовать их в своем приложении с помощью стандартного шейдера набора средств, необходимо следовать [правилам Unity для доступа к материалам с помощью сценария](https://docs.unity3d.com/Manual/MaterialsAccessingViaScript.html). В этом случае мы уже включили [три варианта выделенного материала](https://github.com/Microsoft/HolographicAcademy/tree/Holograms-210-Gaze/Completed/ModelExplorer/Assets/Resources/Models/AstroMan/Materials) , который требуется в папке ресурсов (Найдите три материала с выделенным именем).

### <a name="build-and-deploy"></a>Построение и Развертывание

1. Как и ранее, выполните сборку проекта и разверните его в HoloLens.
2. Обратите внимание на то, что происходит, когда наблюдатель предназначен для объекта, а когда нет.

## <a name="chapter-3---targeting-techniques"></a>Глава 3-методы нацеливания

>[!VIDEO https://www.youtube.com/embed/TFnuLva4VJ0]

### <a name="objectives"></a>Цели

* Упростить целевую голограмму.
* Стабилизация естественных перемещений головок.

### <a name="instructions"></a>Инструкции

1. На панели **Иерархия** выберите объект **InputManager** .
2. На панели **инспектора** найдите скрипт **стабилизер** . Щелкните его, чтобы открыть в Visual Studio, если вы хотите просмотреть его.
    * Этот сценарий выполняет перебор образцов данных Райкаст и помогает стабилизировать пользовательское определение точности для целевой платформы.
3. В **инспекторе** можно изменить значение **сохраненных выборок стабильности** . Это значение представляет число выборок, по которым стабилизер выполняет итерацию, чтобы вычислить значение "стабилизация".

## <a name="chapter-4---directional-indicator"></a>Глава 4-направленный индикатор

>[!VIDEO https://www.youtube.com/embed/htVbJCMlj64]

### <a name="objectives"></a>Цели

* Добавьте к курсору индикатор направления, чтобы помочь найти голограммы.

### <a name="instructions"></a>Инструкции

Мы будем использовать файл **DirectionIndicator.CS** , который будет выполнять следующие действия:

1. Показывать индикатор направления, если пользователь не облаками на голограммах.
2. Скрыть индикатор направления, если пользователь облаками на голограммах.
3. Обновите индикатор направления, чтобы он указывал на голограммы.

Давайте начнем.

1. Щелкните объект **астроман** на панели **Иерархия** и **щелкните стрелку** , чтобы развернуть его.
2. На панели **Иерархия** выберите объект **Директионалиндикатор** в разделе **астроман**.
3. На панели **инспектора** нажмите кнопку **Добавить компонент** .
4. В меню введите **индикатор направления** поля поиска. Выберите результат поиска.
5. На панели **Иерархия** перетащите объект **курсора** на свойство **cursor** в **инспекторе**.
6. На панели **«проект** » в папке « **голограммы** » перетащите ресурс **Директионалиндикатор** в свойство « **указатель направления** » в **инспекторе**.
7. Выполните сборку и развертывание приложения.
8. Посмотрите, как объект «указатель направления» помогает найти-космонавтам.

## <a name="chapter-5---billboarding"></a>Глава 5 — Реклама

>[!VIDEO https://www.youtube.com/embed/qFiLr_LUACE]

### <a name="objectives"></a>Цели

* Используйте рекламу, чтобы всегда иметь на себя голограммы.

Мы будем использовать файл **Billboard.CS** , чтобы поддерживать GameObject, чтобы он всегда был ориентирован на пользователя.

1. На панели **Иерархия** выберите объект **астроман** .
2. На панели **инспектора** нажмите кнопку **Добавить компонент** .
3. В меню введите в поле поиска **объявление**. Выберите результат поиска.
4. В **инспекторе** установите для **оси сводной таблицы** значение **Y**.
5. Тестирование Выполните сборку и развертывание приложения, как и прежде.
6. Ознакомьтесь с тем, как объект объявления не зависит от того, как вы изменяете точку зрения.
7. Удалите скрипт из **астроман** .

## <a name="chapter-6---tag-along"></a>Глава 6-Tag-Along

>[!VIDEO https://www.youtube.com/embed/Ct8ORZAX5JU]

### <a name="objectives"></a>Цели

* Используйте Tag-Along, чтобы наши голограммы соблюдались вокруг комнаты.

По мере того как мы работаем над этой проблемой, мы будем использовать следующие ограничения проектирования:

* Содержимое всегда должно быть кратким.
* Содержимое не должно быть таким образом.
* Содержимое с блокировкой в головном офисе неудобно.

Решение, используемое здесь, заключается в использовании подхода "Tag-by".

Объект с тегами не полностью оставляет представление пользователя. Можно представить себе тег, а как объект, прикрепленный к заголовку пользователя с помощью резиновых полос. По мере того, как пользователь перемещается, содержимое будет оставаться в удобном для вас направлении, не выходя за границы представления. Когда пользователь рассматривает объект на основе тега, он становится более полным.

Мы будем использовать файл **SimpleTagalong.CS** , который будет выполнять следующие действия:

1. Определите, находится ли объект Tag-Along в границах камеры.
2. Если это не в представлении фрустум, разместите Tag-Along частично в представлении фрустум.
3. В противном случае установите Tag-Along на расстояние по умолчанию от пользователя.

Для этого сначала необходимо изменить сценарий **Interactible.CS** для вызова **тагалонгактион**.

1. Измените **Interactible.CS** , выполнив кодирование упражнения 6. a (Раскомментируйте строки с 84 по 87).

```cs
/* TODO: DEVELOPER CODING EXERCISE 6.a */
// 6.a: Uncomment the lines below to perform a Tagalong action.
if (interactibleAction != null)
{
    interactibleAction.PerformAction();
}
```

Сценарий **InteractibleAction.CS** , состоящий из **Interactible.CS** , выполняет пользовательские действия при касании голограмм. В этом случае мы будем использовать один из них специально для тега.

* В папке **Scripts** щелкните ресурс **TagalongAction.CS** , чтобы открыть его в Visual Studio.
* Завершите упражнение по написанию кода или измените его на следующее:
  * В верхней части **иерархии** в строке поиска введите **ChestButton_Center** и выберите результат.
  * На панели **инспектора** нажмите кнопку **Добавить компонент** .
  * В меню введите в поле поиска **Тагалонг действие**. Выберите результат поиска.
  * В папке **голограмм** найдите ресурс **тагалонг** .
  * Выберите объект **ChestButton_Center** в **иерархии**. Перетащите объект **тагалонг** с панели **проект** на **инспектор** в **объект в свойство тагалонг** .
  * Перетащите объект **действия тагалонг** из **инспектора** в поле **действия интерактибле** в скрипте **интерактибле** .
* Дважды щелкните скрипт **тагалонгактион** , чтобы открыть его в Visual Studio.

![Настройка интерактибле](images/holograms210-interactible.png)

Необходимо добавить следующее:

* Добавьте функциональные возможности в функцию Перформактион в скрипте Тагалонгактион (наследуется от Интерактиблеактион).
* Добавьте объявление в объект газед-on и установите для оси сводной диаграммы значение XY.
* Затем добавьте в объект простой Tag-Along.

Вот наше решение, от **TagalongAction.CS**:

```cs
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.

using HoloToolkit.Unity;
using UnityEngine;

public class TagalongAction : InteractibleAction
{
    [SerializeField]
    [Tooltip("Drag the Tagalong prefab asset you want to display.")]
    private GameObject objectToTagalong;

    private void Awake()
    {
        if (objectToTagalong != null)
        {
            objectToTagalong = Instantiate(objectToTagalong);
            objectToTagalong.SetActive(false);

            /* TODO: DEVELOPER CODING EXERCISE 6.b */

            // 6.b: AddComponent Billboard to objectToTagAlong,
            // so it's always facing the user as they move.
            Billboard billboard = objectToTagalong.AddComponent<Billboard>();

            // 6.b: AddComponent SimpleTagalong to objectToTagAlong,
            // so it's always following the user as they move.
            objectToTagalong.AddComponent<SimpleTagalong>();

            // 6.b: Set any public properties you wish to experiment with.
            billboard.PivotAxis = PivotAxis.XY; // Already the default, but provided in case you want to edit
        }
    }

    public override void PerformAction()
    {
        // Recommend having only one tagalong.
        if (objectToTagalong == null || objectToTagalong.activeSelf)
        {
            return;
        }

        objectToTagalong.SetActive(true);
    }
}
```

* Тестирование Выполните сборку и развертывание приложения.
* Посмотрите, как содержимое соответствует центру точки взгляда, но не постоянно и не блокирует его.