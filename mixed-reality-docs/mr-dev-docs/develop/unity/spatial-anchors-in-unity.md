---
title: Блокировка мира и пространственные привязки в Unity
description: Узнайте, как использовать средства блокировки мира и пространственные привязки в приложениях Unity Mixed Reality.
author: hferrone
ms.author: v-hferrone
ms.date: 04/7/2021
ms.topic: article
keywords: Unity, пространственные привязки, хранилище привязок, HoloLens, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности, средства блокировки мира, голограммы
ms.openlocfilehash: 4fc982244a766bb34f15b356d608f2aad18f7a88
ms.sourcegitcommit: 3e36b2fbbcc250c49aaf8ca1b6133cf0e9db69fa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2021
ms.locfileid: "107528753"
---
# <a name="world-locking-and-spatial-anchors-in-unity"></a><span data-ttu-id="8d61d-104">Блокировка мира и пространственные привязки в Unity</span><span class="sxs-lookup"><span data-stu-id="8d61d-104">World locking and spatial anchors in Unity</span></span>

![Изображение Hero средств блокировки мира](images/wlt-img-01.jpeg)

<span data-ttu-id="8d61d-106">Получив свои голограммы, перемещайтесь вместе с вами или в некоторых случаях их положение относительно других голограмм — это большая часть создания приложений смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="8d61d-106">Getting your holograms to stay in place, move with you, or in some cases position themselves relative to other holograms is a big part of creating Mixed Reality applications.</span></span> <span data-ttu-id="8d61d-107">В этой статье мы предоставим вам рекомендуемое решение с помощью средств блокировки мира, но мы также рассмотрим настройку пространственных привязок вручную в проектах Unity.</span><span class="sxs-lookup"><span data-stu-id="8d61d-107">This article will take you through our recommended solution using World Locking Tools, but we'll also cover manually setting up spatial anchors in your Unity projects.</span></span> <span data-ttu-id="8d61d-108">Прежде чем перейти к какому-либо коду, важно понимать, как Unity обрабатывает пространство координат и привязки в своем собственном механизме.</span><span class="sxs-lookup"><span data-stu-id="8d61d-108">Before we jump into any code, it's important to understand how Unity handles coordinate space and anchors in its own engine.</span></span>

## <a name="world-scale-coordinate-systems"></a><span data-ttu-id="8d61d-109">Мировые системы координат</span><span class="sxs-lookup"><span data-stu-id="8d61d-109">World-scale coordinate systems</span></span>

<span data-ttu-id="8d61d-110">Сегодня при написании игр, приложений для визуализации данных или приложений виртуальной реальности типичным подходом является установка одной абсолютной **системы координат** , которую все другие координаты могут надежно сопоставляться обратно.</span><span class="sxs-lookup"><span data-stu-id="8d61d-110">Today, when writing games, data visualization apps, or virtual reality apps, the typical approach is to establish one absolute **world coordinate system** that all other coordinates can reliably map back to.</span></span> <span data-ttu-id="8d61d-111">В этой среде всегда можно найти стабильное преобразование, определяющее связь между любыми двумя объектами в этом мире.</span><span class="sxs-lookup"><span data-stu-id="8d61d-111">In that environment, you can always find a stable transform that defines a relationship between any two objects in that world.</span></span> <span data-ttu-id="8d61d-112">Если вы не перемещаете эти объекты, их относительные преобразования всегда останутся прежними.</span><span class="sxs-lookup"><span data-stu-id="8d61d-112">If you didn't move those objects, their relative transforms would always remain the same.</span></span> <span data-ttu-id="8d61d-113">Этот тип глобальной системы координат легко получить при подготовке чистого виртуального мира, где вы полностью знакомы с геометрией.</span><span class="sxs-lookup"><span data-stu-id="8d61d-113">This kind of global coordinate system is easy to get right when rendering a purely virtual world where you know all of the geometry in advance.</span></span> <span data-ttu-id="8d61d-114">На сегодняшний день для приложений в помещении в рабочее пространство обычно устанавливается такой тип абсолютной системы координат на уровне места.</span><span class="sxs-lookup"><span data-stu-id="8d61d-114">Room-scale VR apps today typically establish this kind of absolute room-scale coordinate system with its origin on the floor.</span></span>

<span data-ttu-id="8d61d-115">Напротив, немодемное устройство смешанной реальности, такое как HoloLens, имеет представление о мире с использованием динамического датчика, постоянно изменяя свои знания во времени окружающей среды пользователя, так как они просматривает много метров во всем этаже здания.</span><span class="sxs-lookup"><span data-stu-id="8d61d-115">In contrast, an untethered mixed reality device such as HoloLens has a dynamic sensor-driven understanding of the world, continuously adjusting its knowledge over time of the user's surroundings as they walk many meters across an entire floor of a building.</span></span> <span data-ttu-id="8d61d-116">Если вы поместили все голограммы в упрощенную жесткую систему координат, то эти голограммы могли бы отменяться со временем на основе мира или относительно друг друга.</span><span class="sxs-lookup"><span data-stu-id="8d61d-116">In a world-scale experience, if you placed all your holograms in a naive rigid coordinate system, those holograms would end up drifting over time, either based on the world or relative to each other.</span></span>

<span data-ttu-id="8d61d-117">Например, гарнитура в настоящее время может считать, что два расположения в мире не соблюдаются на 4 метрах, а затем повышены, чтобы понять, что расположения на самом деле 3,9 метров друг от друга.</span><span class="sxs-lookup"><span data-stu-id="8d61d-117">For example, the headset may currently believe two locations in the world to be 4 meters apart, and then later refine that understanding, learning that the locations are in fact 3.9 meters apart.</span></span> <span data-ttu-id="8d61d-118">Если эти голограммы изначально были размещены на 4 метрах друг за друга в одной жесткой системе координат, один из них бы затем всегда отображался 0,1 метров из реального мира.</span><span class="sxs-lookup"><span data-stu-id="8d61d-118">If those holograms had initially been placed 4 meters apart in a single rigid coordinate system, one of them would then always appear 0.1 meters off from the real world.</span></span>

<span data-ttu-id="8d61d-119">Вы можете вручную разместить **Пространственные привязки** в Unity, чтобы поддерживать позицию голограммы в физическом мире, когда пользователь находится на мобильном устройстве, но это пожертвует самостоятельной согласованности в пределах виртуального мира.</span><span class="sxs-lookup"><span data-stu-id="8d61d-119">You can manually place **spatial anchors** in Unity to maintain a hologram's position in the physical world when the user is mobile - however, this sacrifices the self-consistency within the virtual world.</span></span> <span data-ttu-id="8d61d-120">Разные привязки постоянно перемещаются по отношению друг к другу и также перемещаются через глобальное пространство координат.</span><span class="sxs-lookup"><span data-stu-id="8d61d-120">Different anchors are constantly moving in relation to one another, and are also moving through the global coordinate space.</span></span> <span data-ttu-id="8d61d-121">В этом сценарии простые задачи вроде макета становятся трудным и проблематичным моделированием.</span><span class="sxs-lookup"><span data-stu-id="8d61d-121">In this scenario, simple tasks like layout become difficult and physics simulation problematic.</span></span>

<span data-ttu-id="8d61d-122">**Средства блокировки по всему миру** позволяют достичь лучших из обоих миров, стабилизации отдельной жесткой системы координат с помощью внутреннего предоставления пространственных привязок, распределенных по всей виртуальной сцене по мере движения пользователя.</span><span class="sxs-lookup"><span data-stu-id="8d61d-122">**World Locking Tools** gets you the best of both worlds, stabilizing a single rigid coordinate system using an internal supply of spatial anchors spread throughout the virtual scene as the user moves around.</span></span> <span data-ttu-id="8d61d-123">Средства анализируют координаты камеры и эти пространственные привязки каждый кадр.</span><span class="sxs-lookup"><span data-stu-id="8d61d-123">The tools analyze the coordinates of the camera and those spatial anchors every frame.</span></span> <span data-ttu-id="8d61d-124">Вместо того чтобы изменять координаты всего мира, чтобы компенсировать исправления в координатах заголовка пользователя, средства просто устраняют координаты Head.</span><span class="sxs-lookup"><span data-stu-id="8d61d-124">Instead of changing the coordinates of everything in the world to compensate for the corrections in the coordinates of the user's head, the tools just fix the head's coordinates instead.</span></span>

## <a name="choosing-your-world-locking-approach"></a><span data-ttu-id="8d61d-125">Выбор подхода для блокировки в мире</span><span class="sxs-lookup"><span data-stu-id="8d61d-125">Choosing your world locking approach</span></span>

* <span data-ttu-id="8d61d-126">**Наша рекомендация** заключается в использовании **средств блокировки мира** для всех потребностей в размещении с голограммами.</span><span class="sxs-lookup"><span data-stu-id="8d61d-126">**Our recommendation** is to use **World Locking Tools** for all your hologram positioning needs.</span></span> 
    * <span data-ttu-id="8d61d-127">Средства блокировки мира предоставляют стабильную систему координат, которая позволяет сокращать видимые несоответствия между виртуальными и реальными маркерами.</span><span class="sxs-lookup"><span data-stu-id="8d61d-127">World Locking Tools provides a stable coordinate system that minimizes the visible inconsistencies between virtual and real world markers.</span></span> <span data-ttu-id="8d61d-128">Говоря другим способом, ИТ-мир блокирует всю сцену с помощью общего пула привязок вместо того, чтобы блокировать каждую группу объектов с помощью отдельной привязки группы.</span><span class="sxs-lookup"><span data-stu-id="8d61d-128">Put another way, it world-locks the entire scene with a shared pool of anchors, rather than locking each group of objects with the group's own individual anchor.</span></span>
* <span data-ttu-id="8d61d-129">**Для Unity 2019/2020 с использованием опенкср или подключаемого модуля XR Windows** необходимо использовать **аранчорманажер**</span><span class="sxs-lookup"><span data-stu-id="8d61d-129">**For Unity 2019/2020 using OpenXR or the Windows XR Plugin**, you need to use **ARAnchorManager**</span></span>
* <span data-ttu-id="8d61d-130">**Для более старых версий Unity или проектов WSA** необходимо использовать **ворлданчор**</span><span class="sxs-lookup"><span data-stu-id="8d61d-130">**For older Unity versions or WSA** projects, you need to use **WorldAnchor**</span></span>

## <a name="setting-up-world-locking"></a><span data-ttu-id="8d61d-131">Настройка блокировки мира</span><span class="sxs-lookup"><span data-stu-id="8d61d-131">Setting up world locking</span></span> 

[!INCLUDE[](includes/world-locking/world-locking-setup.md)]

## <a name="persistent-world-locking"></a><span data-ttu-id="8d61d-132">Постоянная блокировка мира</span><span class="sxs-lookup"><span data-stu-id="8d61d-132">Persistent world locking</span></span>

<span data-ttu-id="8d61d-133">Пространственные привязки сохраняют голограммы в реальных пространствах между сеансами приложения.</span><span class="sxs-lookup"><span data-stu-id="8d61d-133">Spatial anchors save holograms in real-world space between application sessions.</span></span> <span data-ttu-id="8d61d-134">После сохранения в хранилище привязки HoloLens они могут быть найдены и загружены в разные сеансы и являются идеальным вариантом отката при отсутствии подключения к Интернету.</span><span class="sxs-lookup"><span data-stu-id="8d61d-134">Once saved in the HoloLens' anchor store, they can be found and loaded in different sessions and are an ideal fallback when there's no internet connectivity.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8d61d-135">Локальные привязки хранятся на устройстве, а пространственные привязки Azure сохраняются в облаке.</span><span class="sxs-lookup"><span data-stu-id="8d61d-135">Local anchors are stored on device, while Azure Spatial Anchors are stored in the cloud.</span></span> <span data-ttu-id="8d61d-136">Если вы хотите использовать облачные службы Azure для хранения привязок, мы предоставляем документ, который поможем вам в интеграции [Пространственных привязок Azure](../mixed-reality-cloud-services.md#azure-spatial-anchors).</span><span class="sxs-lookup"><span data-stu-id="8d61d-136">If you're looking to use Azure cloud services to store your anchors, we have a document that can walk you through integrating [Azure Spatial Anchors](../mixed-reality-cloud-services.md#azure-spatial-anchors).</span></span> <span data-ttu-id="8d61d-137">Обратите внимание, что вы можете использовать локальные привязки и привязки Azure в одном проекте без каких-либо конфликтов.</span><span class="sxs-lookup"><span data-stu-id="8d61d-137">Note that you can have local and Azure anchors in the same project without conflict.</span></span>

[!INCLUDE[](includes/world-locking/world-locking-persistence.md)]

## <a name="sharing-coordinate-spaces"></a><span data-ttu-id="8d61d-138">Совместное использование пространств координат</span><span class="sxs-lookup"><span data-stu-id="8d61d-138">Sharing coordinate spaces</span></span> 

<span data-ttu-id="8d61d-139">Если вы хотите поделиться глобально заблокированным пространством координат, ознакомьтесь с нашей полной [документацией по совместному использованию](shared-experiences-in-unity.md).</span><span class="sxs-lookup"><span data-stu-id="8d61d-139">If you want to share a world locked coordinate space, check out our comprehensive [shared experience documentation](shared-experiences-in-unity.md).</span></span>

<span data-ttu-id="8d61d-140">Обратите внимание, что пространственные привязки Azure пока не поддерживаются непосредственно в средствах блокировки мира, поэтому для общих возможностей потребуется вручную создать пространственные привязки.</span><span class="sxs-lookup"><span data-stu-id="8d61d-140">Note that Azure Spatial Anchors is not yet supported directly within World Locking Tools, and so shared experiences will require you to manually create spatial anchors.</span></span>

## <a name="next-development-checkpoint"></a><span data-ttu-id="8d61d-141">Следующий этап разработки</span><span class="sxs-lookup"><span data-stu-id="8d61d-141">Next Development Checkpoint</span></span>

<span data-ttu-id="8d61d-142">Если вы используете точку контрольной точки разработки Unity, которую мы собрали, то можете изучить стандартные блоки в смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="8d61d-142">If you're following the Unity development checkpoint journey we've laid out, you're in the midst of exploring the Mixed Reality core building blocks.</span></span> <span data-ttu-id="8d61d-143">Отсюда вы можете перейти к следующему стандартному блоку:</span><span class="sxs-lookup"><span data-stu-id="8d61d-143">From here, you can continue to the next building block:</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="8d61d-144">Пространственное сопоставление</span><span class="sxs-lookup"><span data-stu-id="8d61d-144">Spatial mapping</span></span>](spatial-mapping-in-unity.md)

<span data-ttu-id="8d61d-145">Или перейдите к возможностям и API платформы смешанной реальности:</span><span class="sxs-lookup"><span data-stu-id="8d61d-145">Or jump to Mixed Reality platform capabilities and APIs:</span></span>

> [!div class="nextstepaction"]
> <span data-ttu-id="8d61d-146">[общие возможности](shared-experiences-in-unity.md);</span><span class="sxs-lookup"><span data-stu-id="8d61d-146">[Shared experiences](shared-experiences-in-unity.md)</span></span>

<span data-ttu-id="8d61d-147">Вы можете в любой момент вернуться к [этапам разработки для Unity](unity-development-overview.md#2-core-building-blocks).</span><span class="sxs-lookup"><span data-stu-id="8d61d-147">You can always go back to the [Unity development checkpoints](unity-development-overview.md#2-core-building-blocks) at any time.</span></span>

## <a name="see-also"></a><span data-ttu-id="8d61d-148">См. также</span><span class="sxs-lookup"><span data-stu-id="8d61d-148">See Also</span></span>
* [<span data-ttu-id="8d61d-149">Общие сведения о средствах блокировки мира</span><span class="sxs-lookup"><span data-stu-id="8d61d-149">World Locking Tools introduction</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/IntroFAQ.html)
* [<span data-ttu-id="8d61d-150">Краткие руководства</span><span class="sxs-lookup"><span data-stu-id="8d61d-150">Quickstart guides</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/HowTos/QuickStart.html)
* [<span data-ttu-id="8d61d-151">Руководства</span><span class="sxs-lookup"><span data-stu-id="8d61d-151">Tutorials</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Samples/Tutorial/01_Minimal/01_Minimal.html)
* [<span data-ttu-id="8d61d-152">Примеры</span><span class="sxs-lookup"><span data-stu-id="8d61d-152">Samples</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/HowTos/SampleApplications.html)
* [<span data-ttu-id="8d61d-153">Сохраняемость пространственной привязки</span><span class="sxs-lookup"><span data-stu-id="8d61d-153">Spatial anchor persistence</span></span>](../../design/coordinate-systems.md#spatial-anchor-persistence)
* <span data-ttu-id="8d61d-154"><a href="/azure/spatial-anchors" target="_blank">Пространственные привязки Azure.</a></span><span class="sxs-lookup"><span data-stu-id="8d61d-154"><a href="/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a></span></span>
* <span data-ttu-id="8d61d-155"><a href="/dotnet/api/Microsoft.Azure.SpatialAnchors" target="_blank">Пакет SDK для пространственных привязок Azure для Unity</a></span><span class="sxs-lookup"><span data-stu-id="8d61d-155"><a href="/dotnet/api/Microsoft.Azure.SpatialAnchors" target="_blank">Azure Spatial Anchors SDK for Unity</a></span></span>
* [<span data-ttu-id="8d61d-156">Масштабирование работы</span><span class="sxs-lookup"><span data-stu-id="8d61d-156">Experience scales</span></span>](../../design/coordinate-systems.md#mixed-reality-experience-scales)
* [<span data-ttu-id="8d61d-157">Пространственный этап</span><span class="sxs-lookup"><span data-stu-id="8d61d-157">Spatial stage</span></span>](../../design/coordinate-systems.md#stage-frame-of-reference)
* [<span data-ttu-id="8d61d-158">Потеря слежения в Unity</span><span class="sxs-lookup"><span data-stu-id="8d61d-158">Tracking loss in Unity</span></span>](tracking-loss-in-unity.md)
* [<span data-ttu-id="8d61d-159">Пространственные привязки</span><span class="sxs-lookup"><span data-stu-id="8d61d-159">Spatial anchors</span></span>](../../design/spatial-anchors.md)
* [<span data-ttu-id="8d61d-160">Общий доступ в Unity</span><span class="sxs-lookup"><span data-stu-id="8d61d-160">Shared experiences in Unity</span></span>](shared-experiences-in-unity.md)
