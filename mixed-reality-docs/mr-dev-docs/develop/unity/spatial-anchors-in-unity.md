---
title: Блокировка мира и пространственные привязки в Unity
description: Узнайте, как использовать средства блокировки мира и пространственные привязки в приложениях Unity Mixed Reality.
author: hferrone
ms.author: v-hferrone
ms.date: 04/7/2021
ms.topic: article
keywords: Unity, пространственные привязки, хранилище привязок, HoloLens, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности, средства блокировки мира, голограммы
ms.openlocfilehash: 4fc982244a766bb34f15b356d608f2aad18f7a88
ms.sourcegitcommit: 3e36b2fbbcc250c49aaf8ca1b6133cf0e9db69fa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2021
ms.locfileid: "107528753"
---
# <a name="world-locking-and-spatial-anchors-in-unity"></a>Блокировка мира и пространственные привязки в Unity

![Изображение Hero средств блокировки мира](images/wlt-img-01.jpeg)

Получив свои голограммы, перемещайтесь вместе с вами или в некоторых случаях их положение относительно других голограмм — это большая часть создания приложений смешанной реальности. В этой статье мы предоставим вам рекомендуемое решение с помощью средств блокировки мира, но мы также рассмотрим настройку пространственных привязок вручную в проектах Unity. Прежде чем перейти к какому-либо коду, важно понимать, как Unity обрабатывает пространство координат и привязки в своем собственном механизме.

## <a name="world-scale-coordinate-systems"></a>Мировые системы координат

Сегодня при написании игр, приложений для визуализации данных или приложений виртуальной реальности типичным подходом является установка одной абсолютной **системы координат** , которую все другие координаты могут надежно сопоставляться обратно. В этой среде всегда можно найти стабильное преобразование, определяющее связь между любыми двумя объектами в этом мире. Если вы не перемещаете эти объекты, их относительные преобразования всегда останутся прежними. Этот тип глобальной системы координат легко получить при подготовке чистого виртуального мира, где вы полностью знакомы с геометрией. На сегодняшний день для приложений в помещении в рабочее пространство обычно устанавливается такой тип абсолютной системы координат на уровне места.

Напротив, немодемное устройство смешанной реальности, такое как HoloLens, имеет представление о мире с использованием динамического датчика, постоянно изменяя свои знания во времени окружающей среды пользователя, так как они просматривает много метров во всем этаже здания. Если вы поместили все голограммы в упрощенную жесткую систему координат, то эти голограммы могли бы отменяться со временем на основе мира или относительно друг друга.

Например, гарнитура в настоящее время может считать, что два расположения в мире не соблюдаются на 4 метрах, а затем повышены, чтобы понять, что расположения на самом деле 3,9 метров друг от друга. Если эти голограммы изначально были размещены на 4 метрах друг за друга в одной жесткой системе координат, один из них бы затем всегда отображался 0,1 метров из реального мира.

Вы можете вручную разместить **Пространственные привязки** в Unity, чтобы поддерживать позицию голограммы в физическом мире, когда пользователь находится на мобильном устройстве, но это пожертвует самостоятельной согласованности в пределах виртуального мира. Разные привязки постоянно перемещаются по отношению друг к другу и также перемещаются через глобальное пространство координат. В этом сценарии простые задачи вроде макета становятся трудным и проблематичным моделированием.

**Средства блокировки по всему миру** позволяют достичь лучших из обоих миров, стабилизации отдельной жесткой системы координат с помощью внутреннего предоставления пространственных привязок, распределенных по всей виртуальной сцене по мере движения пользователя. Средства анализируют координаты камеры и эти пространственные привязки каждый кадр. Вместо того чтобы изменять координаты всего мира, чтобы компенсировать исправления в координатах заголовка пользователя, средства просто устраняют координаты Head.

## <a name="choosing-your-world-locking-approach"></a>Выбор подхода для блокировки в мире

* **Наша рекомендация** заключается в использовании **средств блокировки мира** для всех потребностей в размещении с голограммами. 
    * Средства блокировки мира предоставляют стабильную систему координат, которая позволяет сокращать видимые несоответствия между виртуальными и реальными маркерами. Говоря другим способом, ИТ-мир блокирует всю сцену с помощью общего пула привязок вместо того, чтобы блокировать каждую группу объектов с помощью отдельной привязки группы.
* **Для Unity 2019/2020 с использованием опенкср или подключаемого модуля XR Windows** необходимо использовать **аранчорманажер**
* **Для более старых версий Unity или проектов WSA** необходимо использовать **ворлданчор**

## <a name="setting-up-world-locking"></a>Настройка блокировки мира 

[!INCLUDE[](includes/world-locking/world-locking-setup.md)]

## <a name="persistent-world-locking"></a>Постоянная блокировка мира

Пространственные привязки сохраняют голограммы в реальных пространствах между сеансами приложения. После сохранения в хранилище привязки HoloLens они могут быть найдены и загружены в разные сеансы и являются идеальным вариантом отката при отсутствии подключения к Интернету.

> [!IMPORTANT]
> Локальные привязки хранятся на устройстве, а пространственные привязки Azure сохраняются в облаке. Если вы хотите использовать облачные службы Azure для хранения привязок, мы предоставляем документ, который поможем вам в интеграции [Пространственных привязок Azure](../mixed-reality-cloud-services.md#azure-spatial-anchors). Обратите внимание, что вы можете использовать локальные привязки и привязки Azure в одном проекте без каких-либо конфликтов.

[!INCLUDE[](includes/world-locking/world-locking-persistence.md)]

## <a name="sharing-coordinate-spaces"></a>Совместное использование пространств координат 

Если вы хотите поделиться глобально заблокированным пространством координат, ознакомьтесь с нашей полной [документацией по совместному использованию](shared-experiences-in-unity.md).

Обратите внимание, что пространственные привязки Azure пока не поддерживаются непосредственно в средствах блокировки мира, поэтому для общих возможностей потребуется вручную создать пространственные привязки.

## <a name="next-development-checkpoint"></a>Следующий этап разработки

Если вы используете точку контрольной точки разработки Unity, которую мы собрали, то можете изучить стандартные блоки в смешанной реальности. Отсюда вы можете перейти к следующему стандартному блоку:

> [!div class="nextstepaction"]
> [Пространственное сопоставление](spatial-mapping-in-unity.md)

Или перейдите к возможностям и API платформы смешанной реальности:

> [!div class="nextstepaction"]
> [общие возможности](shared-experiences-in-unity.md);

Вы можете в любой момент вернуться к [этапам разработки для Unity](unity-development-overview.md#2-core-building-blocks).

## <a name="see-also"></a>См. также
* [Общие сведения о средствах блокировки мира](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/IntroFAQ.html)
* [Краткие руководства](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/HowTos/QuickStart.html)
* [Руководства](https://microsoft.github.io/MixedReality-WorldLockingTools-Samples/Tutorial/01_Minimal/01_Minimal.html)
* [Примеры](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/HowTos/SampleApplications.html)
* [Сохраняемость пространственной привязки](../../design/coordinate-systems.md#spatial-anchor-persistence)
* <a href="/azure/spatial-anchors" target="_blank">Пространственные привязки Azure.</a>
* <a href="/dotnet/api/Microsoft.Azure.SpatialAnchors" target="_blank">Пакет SDK для пространственных привязок Azure для Unity</a>
* [Масштабирование работы](../../design/coordinate-systems.md#mixed-reality-experience-scales)
* [Пространственный этап](../../design/coordinate-systems.md#stage-frame-of-reference)
* [Потеря слежения в Unity](tracking-loss-in-unity.md)
* [Пространственные привязки](../../design/spatial-anchors.md)
* [Общий доступ в Unity](shared-experiences-in-unity.md)
