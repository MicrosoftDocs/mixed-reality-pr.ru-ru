---
title: Рекомендуемые параметры для Unity
description: Сведения о производительности Unity и публикации, характерные для приложений смешанной реальности, которые можно переключать с помощью параметров проекта.
author: hferrone
ms.author: v-hferrone
ms.date: 07/29/2020
ms.topic: article
keywords: Unity, параметры, Смешанная реальность, HoloLens, гарнитура смешанной реальности, гарнитура Windows Mixed Reality, гарнитура виртуальной реальности, производительность, параметры качества, параметры освещения, буфер глубины, XR, отслеживание потерь
ms.openlocfilehash: cc1d2692a172c84274299580a0ce580264f65fcf
ms.sourcegitcommit: 97815006c09be0a43b3d9b33c1674150cdfecf2b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101759700"
---
# <a name="recommended-settings-for-unity"></a>Рекомендуемые параметры для Unity

Unity предоставляет набор параметров по умолчанию, которые обычно являются средним регистром для всех платформ. Однако Unity предлагает некоторые виды поведения, характерные для смешанной реальности, которые можно переключать с помощью параметров проекта.

## <a name="performant-environment-set-up"></a>Настройка выполняемой среды

### <a name="low-quality-settings"></a>Параметры низкого качества

Важно изменить **Параметры качества Unity** на **очень низкое** , чтобы приложение выполнялось и хорошо выполнялось на соответствующей частоте кадров, особенно для разработки HoloLens. Для разработки на впечатляющих гарнитурах, в зависимости от характеристик настольных ПК, которые работают в режиме VR, по-прежнему можно получить частоту кадров без наименьших параметров качества.

В Unity 2019 LTS + можно задать уровень качества проекта, выбрав пункт **изменить**  >  **качество параметров проекта**  >   и установив значение **по умолчанию** , щелкнув стрелку вниз на уровень * * очень низкого качества.

### <a name="lighting-settings"></a>Параметры освещения

Как и параметры сцены качества, важно установить оптимальные параметры освещения для приложения смешанной реальности. В Unity параметр освещения, который обычно имеет наибольшее воздействие на производительность сцены, является **глобальным освещения в режиме реального времени**. Вы можете отключить глобальные освещения, перейдя в **окно**  >    >  **параметры освещения** в режиме  >  **реального времени глобальные освещения**.

Существует еще одно значение параметра освещения, **помогут Global освещения**. Этот параметр позволяет обеспечить выполнение и визуальное представление результатов на впечатляющих гарнитурах, но не применимо для разработки HoloLens. **Помогут Global освещения** вычисляется только для статических объекты gameobject, которые не обнаруживаются в сценах HoloLens из-за природы неизвестной и измененной среды.

Дополнительные сведения см. [в статье Global освещения from Unity](https://docs.unity3d.com/Manual/GIIntro.html) . 

>[!NOTE]
> **Глобальные освещения в реальном времени** задаются **на сцене** , и поэтому разработчики должны сохранить это свойство для каждой сцены Unity в своем проекте.

### <a name="single-pass-instancing-rendering-path"></a>Путь отрисовки экземпляра с одним проходом

В приложениях со смешанной реальности сцена отображается дважды, один раз для каждого взгляда на пользователя. По сравнению с традиционной трехмерной разработкой, это эффективно удваивает объем работы, которую необходимо вычислить. Важно выбрать наиболее эффективный путь отрисовки в Unity, чтобы сэкономить время ЦП и GPU. Однопроходная Визуализация с одним экземпляром оптимизирует конвейер отрисовки Unity для приложений смешанной реальности, поэтому рекомендуется включить этот параметр по умолчанию для каждого проекта.

Включение этой функции в проекте Unity

1)  Откройте **Player XR Settings** (Параметры XR проигрывателя), выбрав элементы **Edit** > **Project Settings** > **Player** > **XR Settings** (Редактирование > Параметры проекта > Проигрыватель > Параметры XR)
2) Выберите **Single Pass Instanced** (Однопроходный с экземпляром) в раскрывающемся меню **Stereo Rendering Method** (Метод стереоскопической отрисовки), установив также флажок **Virtual Reality Supported** (Поддержка виртуальной реальности)

Дополнительные сведения об этом подходе к отрисовке см. в следующих статьях в Unity.

- [Максимизация производительности дополненной реальности и виртуальной реальности с помощью расширенной стереоскопической отрисовки](https://blogs.unity3d.com/2017/11/21/how-to-maximize-ar-and-vr-performance-with-advanced-stereo-rendering/)
- [Однопроходная отрисовка экземпляра](https://docs.unity3d.com/Manual/SinglePassInstancing.html)

>[!NOTE]
> Одна из распространенных проблем при однопроходной отрисовке с использованием экземпляра возникает в тех случаях, если уже существующие пользовательские шейдеры не поддерживают создание экземпляра. После включения этой возможности разработчики заметят, что некоторые игровые объекты отрисовываются только для одного глаза. Это связано с тем, что соответствующие пользовательские шейдеры не имеют нужных свойств для создания экземпляров.
>
> Действия для решения этой проблемы описаны в документе Unity [об однопроходной стереоскопической отрисовке для HoloLens](https://docs.unity3d.com/Manual/SinglePassStereoRenderingHoloLens.html).

### <a name="enable-depth-buffer-sharing"></a>Включить общий доступ к буферу глубины

Для достижения лучшей стабильной стабильности от восприятия пользователя рекомендуется включить свойство **общего доступа к буферу глубины** в Unity. Если включить этот параметр, Unity будет совместно использовать карту глубины, созданную приложением с платформой Windows Mixed Reality. После этого платформа может оптимизировать стабильность, специально предназначенную для сцены, для каждого кадра, отображаемого приложением.

Включение этой функции в проекте Unity

1) Откройте **Player XR Settings** (Параметры XR проигрывателя), выбрав элементы **Edit** > **Project Settings** > **Player** > **XR Settings** (Редактирование > Параметры проекта > Проигрыватель > Параметры XR)
2) Установите флажок **включить общий доступ к буферу глубины** в разделе **пакеты SDK для Virtual Reality**  >  расширение **Windows Mixed Reality** (флажок **поддерживается в виртуальной реальности** должен быть установлен).

Кроме того, рекомендуется выбрать **16-разрядную глубину** в параметре **Формат глубины** на этой панели, особенно для разработки HoloLens. Если выбрать 16-битное сравнение с 24-битным, это позволит значительно снизить требования к пропускной способности, так как меньше данных потребуется переместить или обработать.

Чтобы платформа Windows Mixed Reality оптимизировать стабильность, она полагается на буфер глубины, чтобы обеспечить точность и соответствие всем отображаемым голограммам на экране. Таким же, при совместном использовании буфера глубины важно, что при отрисовке цвета для отображения глубины. В Unity большинство непрозрачных или Транспаренткутаутных материалов будут отображать глубину по умолчанию, но прозрачные и текстовые объекты не будут отображать глубину, хотя это зависит от шейдера и т. д.

Если используется [стандартный шейдер набора средств Mixed Reality](https://docs.microsoft.com/windows/mixed-reality/mrtk-docs/configuration/mrtk-standard-shader.md), для визуализации глубины прозрачных объектов:

1) Выберите прозрачный материал, использующий стандартный шейдер МРТК, и откройте окно редактора инспектора.
2) Нажмите кнопку **исправить сейчас** в предупреждении об общем доступе к буферу глубины. Это также можно выполнить вручную, задав для **режима рендеринга** значение **Custom**; затем задайте для **режима** значение **прозрачный** и установите для параметра **глубина записи глубины** значение **вкл** .

> [!IMPORTANT]
> При изменении этих значений вместе с настройками вблизи и дальней работы камеры разработчикам следует осторожно отвестись от Z-борьбы. Отборьба от Z происходит, когда два объекты gameobject пытаются выполнить визуализацию на одном и том же пикселе и из-за ограничений в точности буфера глубины (т. е. z Depth), Unity не может различить, какой объект находится впереди другого. Разработчики зазаметим мерцание между двумя игровыми объектами, так как они будут *бороться* с одним и тем же значением глубины z. Это можно решить, переключившись на 24-разрядный формат глубины, так как для каждого объекта будет вычисляться больший диапазон значений по z-глубине от камеры.
>
> Однако рекомендуется, особенно для разработки HoloLens, изменить близкие и дальнее плоскости камеры на меньший диапазон и хранить 16-разрядный формат глубины. Z-глубина нелинейно сопоставлена с диапазоном значений вдоль ближайших и дальней плоскости камеры. Это можно изменить, выбрав *основную камеру* в сцене и **инспекторе**, изменить значения **вблизи & дальней плоскости** , чтобы уменьшить их диапазон (т. е. из 1000m в 100 млн или другое значение x и т. д.)

>[!IMPORTANT]
> [Unity не создает буфер шаблона](https://docs.unity3d.com/ScriptReference/RenderTexture-depth.html) при использовании 16-разрядного формата глубины. Таким словами, некоторые эффекты пользовательского интерфейса Unity и другие эффекты, требуемые для набора элементов, не будут работать, если не выбран 24-разрядный формат глубины, который создаст [8-разрядный буфер элементов](https://docs.unity3d.com/Manual/SL-Stencil.html).

### <a name="building-for-il2cpp"></a>Сборка для IL2CPP

Unity имеет устаревшую поддержку серверной части сценариев .NET и, таким же, рекомендует разработчикам использовать **IL2CPP** для сборок UWP Visual Studio. Хотя это дает различные преимущества, создание решения Visual Studio из Unity для **IL2CPP** может выполняться медленнее, чем старый метод .NET. Поэтому настоятельно рекомендуется следовать рекомендациям по созданию **IL2CPP** , чтобы сэкономить время итерации разработки.

1) Используйте добавочное построение, создав проект в один каталог каждый раз, повторно используя предварительно созданные файлы
2) Отключить сканирование антивредоносного по для проекта & папок сборки
   - Откройте **Антивирусную & защиту от угроз** в приложении "Параметры Windows 10"
   - Выберите **Управление параметрами** в разделе **Параметры защиты от угроз & вирусов** .
   - Выберите **Добавить или удалить исключения** в разделе **исключения** .
   - Выберите **Добавить исключение** и выберите папку, содержащую код проекта Unity и выходные данные сборки.
3) Использование SSD для создания

Дополнительные сведения см. в статье [Оптимизация времени сборки для IL2CPP](https://docs.unity3d.com/Manual/IL2CPP-OptimizingBuildTimes.html) .

> [!NOTE]
> Кроме того, может быть полезно настроить [сервер кэширования](https://docs.unity3d.com/Manual/CacheServer.html), особенно для проектов Unity с большим объемом ресурсов (за исключением файлов сценариев) либо постоянно меняющимися сценами или ресурсами. Когда открывается проект, Unity сохраняет соответствующие ресурсы в формате для внутреннего кэша на компьютере разработчика. Измененные элементы нужно повторно импортировать и еще раз обработать. Этот процесс можно выполнить один раз и сохранить на сервере кэширования, а значит, и совместно использовать с другими разработчиками для экономии времени. При этом каждому разработчику не придется обрабатывать повторно импортированные измененные элементы локально.

## <a name="publishing-properties"></a>Свойства публикации

### <a name="holographic-splash-screen"></a>Поставка holographic

HoloLens имеет ЦП и GPU мобильного класса, что означает, что загрузка приложений может занять немного больше времени. Во время загрузки приложения пользователи будут видеть только черный, и поэтому они могут спросить, что происходит. Чтобы убедиться в их загрузке, можно добавить экран-заставку Holographic.

Чтобы переключить экран-заставку holographic, сделайте следующее:

1) Перейдите к странице " **изменение**  >  **параметров проекта**"  >  **проигрывателя**
2) Перейдите на вкладку **Магазин Windows** и откройте раздел **изображение-заставка** .
3) Примените образ к свойству **изображения Windows holographic > holographic** .
    - При включении параметра " **Показывать заставку Unity** " включится или отключается экран-заставка Unity. Если у вас нет лицензии Unity Pro, будет отображаться экран-заставка Unity.
    - Если применяется **изображение с голограммой holographic** , оно всегда будет отображаться, если флажок Показать экран-заставку Unity включен или отключен. Указание пользовательского образа с помощью-заставки доступно только для разработчиков с лицензией Unity Pro.

|  Отображение экрана-заставки Unity  |  Изображение с голограммой holographic  |  Поведение |
|----------|----------|----------|
|  С  |  Нет  |  Показывать экран-заставку Unity по умолчанию в течение 5 секунд или до загрузки приложения, в зависимости от того, какое из этих значений больше. |
|  С  |  Особые настройки  |  Отображение пользовательского экрана-заставки в течение 5 секунд или до загрузки приложения, в зависимости от того, что больше. |
|  Выкл.  |  Нет  |  Показывать прозрачный черный (Nothing) до загрузки приложения. |
|  Выкл.  |  Особые настройки  |  Отображение пользовательского экрана-заставки в течение 5 секунд или до загрузки приложения, в зависимости от того, что больше. |

Дополнительные сведения см. в [документации по экрану-заставке Unity](https://docs.unity3d.com/Manual/class-PlayerSettingsSplashScreen.html) .

### <a name="tracking-loss"></a>потеря слежения;

Гарнитура смешанной реальности зависит от того, насколько окружена она для создания [систем координат, заблокированных в мире](coordinate-systems-in-unity.md), что позволяет оставить голограммы на месте. Если гарнитура не может располагаться в мире, то говорят, что у головного телефона *потеряно отслеживание*. В таких случаях функциональные возможности, зависящие от системы координат, заблокированной в мире, такие как пространственные этапы, пространственные привязки и пространственное сопоставление, не работают.

В случае потери отслеживания поведение Unity по умолчанию заключается в остановке отображения голограмм, приостановке [игрового цикла](https://docs.unity3d.com/Manual/ExecutionOrder.html)и отображении уведомления о потере отслеживания, которое следует за пользователями. Настраиваемые уведомления также могут быть предоставлены в виде образа потери отслеживания. Для приложений, зависящих от отслеживания для всей работы, достаточно позволить Unity полностью обменять его до тех пор, пока отслеживание не будет восстановлено. Разработчики могут предоставить пользовательский образ, который будет отображаться во время отслеживания потерь.

Чтобы настроить отслеживание потерянных изображений, выполните следующие действия.

1) Перейдите к странице " **изменение**  >  **параметров проекта**"  >  **проигрывателя**
2) Выберите на вкладке " **Магазин Windows** " и откройте раздел " **изображение-заставка** ".
3) Примените образ к свойству **образа потери данных Windows holographic >** .

#### <a name="opt-out-of-automatic-pause"></a>Отказ от автоматической паузы

Для некоторых приложений может не требоваться отслеживание (например, такие [приложения](coordinate-systems-in-unity.md) , как, например, с видеороликами 360), или же может потребоваться продолжить обработку без прерывания, пока отслеживание теряется. Можно отказаться от потери поведения по умолчанию, но вы несете ответственность за скрытие и отключение любых объектов, которые не будут правильно отображаться в сценарии с отслеживанием потерь. В большинстве случаев единственным содержимым, которое рекомендуется визуализировать в этом случае, является содержимое с блокировкой текста, Центрированное вокруг основной камеры.

Чтобы отказаться от автоматического поведения приостановки:

1) Переход на страницу **редактирования**  >  **параметров проекта**  >  
2) Перейдите на вкладку **Магазин Windows** и откройте раздел **изображение-заставка** .
3) Измените флажок **Windows holographic > On Track потерь Pause и показывать изображение** .

#### <a name="tracking-loss-events"></a>Отслеживание событий потери

Чтобы определить пользовательское поведение при потере отслеживания, обработайте [события глобального отслеживания потерь](tracking-loss-in-unity.md).

### <a name="capabilities"></a>Возможности

Чтобы приложение было использовать преимущества определенных функций, оно должно объявлять соответствующие возможности в своем манифесте. Объявления манифеста можно вносить в Unity, чтобы они включались во все будущие экспорты проекта.

Возможности для приложения смешанной реальности можно включить следующим образом.

1) Перейдите к странице " **изменение**  >  **параметров проекта**"  >  **проигрывателя**
2) Перейдите на вкладку **Магазин Windows** , откройте раздел **Параметры публикации** и найдите список **возможностей** .

Ниже перечислены применимые возможности для включения часто используемых API-интерфейсов для holographic приложений.
<br>

|  Функция  |  API, которым требуются возможности |
|----------|----------|
|  SpatialPerception;  |  сурфацеобсервер |
|  Бесед  |  Фотозапись и Видеокаптуре |
|  Пиктуреслибрари/Видеослибрари  |  Фотозахват или Видеокаптуре, соответственно (при сохранении захваченного содержимого); |
|  микрофон  |  Видеокаптуре (при записи звука), Диктатионрекогнизер, Граммаррекогнизер и Кэйвордрекогнизер |
|  InternetClient  |  Диктатионрекогнизер (и использование профилировщика Unity) |

## <a name="see-also"></a>См. также раздел

* [Обзор разработки в Unity](unity-development-overview.md)
* [Understanding performance for Mixed Reality](../platform-capabilities-and-apis/understanding-performance-for-mixed-reality.md) (Основные сведения о производительности для Смешанной реальности)
* [Рекомендации по производительности для Unity](performance-recommendations-for-unity.md)
