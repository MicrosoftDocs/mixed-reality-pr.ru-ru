---
title: Рекомендуемые параметры для Unity
description: Сведения о производительности Unity и публикации, характерные для приложений смешанной реальности, которые можно переключать с помощью параметров проекта.
author: hferrone
ms.author: v-vtieto
ms.date: 07/29/2020
ms.topic: article
keywords: unity, параметры, смешанная реальность, HoloLens, гарнитура смешанной реальности, гарнитура windows mixed reality, гарнитура виртуальной реальности, производительность, параметры качества, параметры освещения, буфер глубины, xr, отслеживание потерь
ms.openlocfilehash: d3ab078a77ba54df60b17d95b2abd198c3d447fb
ms.sourcegitcommit: bea83261bf9ce7a27a618e5bc54dc4d7711f5435
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2021
ms.locfileid: "130155749"
---
# <a name="recommended-settings-for-unity"></a>Рекомендуемые параметры для Unity

Unity предоставляет набор параметров по умолчанию, которые обычно являются средним регистром для всех платформ. Однако Unity предлагает некоторые виды поведения, характерные для смешанной реальности, которые можно переключать с помощью параметров проекта.

## <a name="performant-environment-set-up"></a>Настройка выполняемой среды

### <a name="low-quality-settings"></a>Параметры низкого качества

важно изменить **параметры качества Unity** на **очень низкое** , чтобы приложение выполнялось и хорошо выполнялось на соответствующей частоте кадров, особенно для HoloLens разработки. Для разработки на впечатляющих гарнитурах, в зависимости от характеристик настольных ПК, которые работают в режиме VR, по-прежнему можно получить частоту кадров без наименьших параметров качества.

в Unity 2019 LTS + можно задать уровень качества проекта, перейдя в меню **правка**  >  **Project Параметры**  >  **качество** и установив значение **по умолчанию** , щелкнув стрелку вниз до уровня «* * очень низкий».

### <a name="lighting-settings"></a>Параметры освещения

Как и параметры сцены качества, важно установить оптимальные параметры освещения для приложения смешанной реальности. В Unity параметр освещения, который обычно имеет наибольшее воздействие на производительность сцены, является **глобальным освещения в режиме реального времени**. вы можете отключить глобальные освещения, перейдя в **окно**"освещение" для  >  **отображения** окон  >  **Параметры**  >  **глобальном освещения реального времени**.

Существует еще одно значение параметра освещения, **помогут Global освещения**. этот параметр позволяет обеспечить выполнение и визуальное представление результатов на впечатляющих гарнитурах, но не применимо для HoloLens разработки. **помогут Global освещения** вычисляется только для статических объекты gameobject, которые не обнаруживаются в HoloLens сцены из-за природы неизвестной и измененной среды.

Дополнительные сведения см. [в статье Global освещения from Unity](https://docs.unity3d.com/Manual/GIIntro.html) . 

>[!NOTE]
> **Глобальные освещения в реальном времени** задаются **на сцене** , и поэтому разработчики должны сохранить это свойство для каждой сцены Unity в своем проекте.

### <a name="single-pass-instancing-rendering-path"></a>Путь отрисовки экземпляра с одним проходом

В приложениях со смешанной реальности сцена отображается дважды, один раз для каждого взгляда на пользователя. По сравнению с традиционной трехмерной разработкой, это эффективно удваивает объем работы, которую необходимо вычислить. Важно выбрать наиболее эффективный путь отрисовки в Unity, чтобы сэкономить время ЦП и GPU. Однопроходная Визуализация с одним экземпляром оптимизирует конвейер отрисовки Unity для приложений смешанной реальности, поэтому рекомендуется включить этот параметр по умолчанию для каждого проекта.

Включение этой функции в проекте Unity

1)  Откройте **Player XR Settings** (Параметры XR проигрывателя), выбрав элементы **Edit** > **Project Settings** > **Player** > **XR Settings** (Редактирование > Параметры проекта > Проигрыватель > Параметры XR)
2) Выберите **Single Pass Instanced** (Однопроходный с экземпляром) в раскрывающемся меню **Stereo Rendering Method** (Метод стереоскопической отрисовки), установив также флажок **Virtual Reality Supported** (Поддержка виртуальной реальности)

Дополнительные сведения об этом подходе к отрисовке см. в следующих статьях в Unity.

- [Максимизация производительности дополненной реальности и виртуальной реальности с помощью расширенной стереоскопической отрисовки](https://blogs.unity3d.com/2017/11/21/how-to-maximize-ar-and-vr-performance-with-advanced-stereo-rendering/)
- [Однопроходная отрисовка экземпляра](https://docs.unity3d.com/Manual/SinglePassInstancing.html)

>[!NOTE]
> Одна из распространенных проблем при однопроходной отрисовке с использованием экземпляра возникает в тех случаях, если уже существующие пользовательские шейдеры не поддерживают создание экземпляра. После включения этой возможности разработчики заметят, что некоторые игровые объекты отрисовываются только для одного глаза. Это связано с тем, что соответствующие пользовательские шейдеры не имеют нужных свойств для создания экземпляров.
>
> Действия для решения этой проблемы описаны в документе Unity [об однопроходной стереоскопической отрисовке для HoloLens](https://docs.unity3d.com/Manual/SinglePassStereoRenderingHoloLens.html).

### <a name="enable-depth-buffer-sharing"></a>Включить общий доступ к буферу глубины

Для достижения лучшей стабильной стабильности от восприятия пользователя рекомендуется включить свойство **общего доступа к буферу глубины** в Unity. если включить этот параметр, Unity будет совместно использовать карту глубины, созданную приложением с Windows Mixed Reality платформой. После этого платформа может оптимизировать стабильность, специально предназначенную для сцены, для каждого кадра, отображаемого приложением.

Включение этой функции в проекте Unity

1) Откройте **Player XR Settings** (Параметры XR проигрывателя), выбрав элементы **Edit** > **Project Settings** > **Player** > **XR Settings** (Редактирование > Параметры проекта > Проигрыватель > Параметры XR)
2) установите флажок **включить совместное использование буфера глубины** в пакетах **sdk для Virtual reality**  >  **Windows Mixed Reality** расширение (флажок **поддерживается в virtual reality** должен быть установлен).

кроме того, рекомендуется выбрать **16-разрядную глубину** в параметре **формат глубины** на этой панели, особенно для HoloLensной разработки. Если выбрать 16-битное сравнение с 24-битным, это позволит значительно снизить требования к пропускной способности, так как меньше данных потребуется переместить или обработать.

чтобы платформа Windows Mixed Realityа оптимизировать стабильность, она полагается на буфер глубины, чтобы обеспечить точность и соответствие всем визуализированным голограммам на экране. Таким же, при совместном использовании буфера глубины важно, что при отрисовке цвета для отображения глубины. В Unity большинство непрозрачных или Транспаренткутаутных материалов будут отображать глубину по умолчанию, но прозрачные и текстовые объекты не будут отображать глубину, хотя это зависит от шейдера и т. д.

если используется [стандартный шейдер "смешанная реальность" набор средств](/windows/mixed-reality/mrtk-unity/features/rendering/mrtk-standard-shader), для визуализации глубины прозрачных объектов:

1) Выберите прозрачный материал, использующий стандартный шейдер МРТК, и откройте окно редактора инспектора.
2) Нажмите кнопку **исправить сейчас** в предупреждении об общем доступе к буферу глубины. Это также можно выполнить вручную, задав для **режима рендеринга** значение **Custom**; затем задайте для **режима** значение **прозрачный** и установите для параметра **глубина записи глубины** значение **вкл** .

> [!IMPORTANT]
> При изменении этих значений вместе с настройками вблизи и дальней работы камеры разработчикам следует осторожно отвестись от Z-борьбы. Отборьба от Z происходит, когда два объекты gameobject пытаются выполнить визуализацию на одном и том же пикселе и из-за ограничений в точности буфера глубины (т. е. z Depth), Unity не может различить, какой объект находится впереди другого. Разработчики зазаметим мерцание между двумя игровыми объектами, так как они будут *бороться* с одним и тем же значением глубины z. Это можно решить, переключившись на 24-разрядный формат глубины, так как для каждого объекта будет вычисляться больший диапазон значений по z-глубине от камеры.
>
> однако рекомендуется, особенно для HoloLensной разработки, изменить вблизи и большие плоскости камеры на меньший диапазон и хранить 16-разрядный формат глубины. Z-глубина нелинейно сопоставлена с диапазоном значений вдоль ближайших и дальней плоскости камеры. Это можно изменить, выбрав *основную камеру* в сцене и **инспекторе**, изменить значения **вблизи & дальней плоскости** , чтобы уменьшить их диапазон (т. е. из 1000m в 100 млн или другое значение x и т. д.)

>[!IMPORTANT]
> [Unity не создает буфер шаблона](https://docs.unity3d.com/ScriptReference/RenderTexture-depth.html) при использовании 16-разрядного формата глубины. Таким словами, некоторые эффекты пользовательского интерфейса Unity и другие эффекты, требуемые для набора элементов, не будут работать, если не выбран 24-разрядный формат глубины, который создаст [8-разрядный буфер элементов](https://docs.unity3d.com/Manual/SL-Stencil.html).

### <a name="building-for-il2cpp"></a>Сборка для IL2CPP

Unity имеет устаревшую поддержку серверной части сценариев .NET и, таким же, рекомендует разработчикам использовать **IL2CPP** для сборок UWP Visual Studio. Хотя это дает различные преимущества, создание решения Visual Studio из Unity для **IL2CPP** может выполняться медленнее, чем старый метод .NET. Поэтому настоятельно рекомендуется следовать рекомендациям по созданию **IL2CPP** , чтобы сэкономить время итерации разработки.

1) Используйте добавочное построение, создав проект в один каталог каждый раз, повторно используя предварительно созданные файлы
2) Отключить сканирование антивредоносного по для проекта & папок сборки
   - откройте **антивирусную & защиту от угроз** в приложении "параметры Windows 10".
   - выберите **управление Параметры** в разделе **параметры защиты от угроз & вирусов**
   - Выберите **Добавить или удалить исключения** в разделе **исключения** .
   - Выберите **Добавить исключение** и выберите папку, содержащую код проекта Unity и выходные данные сборки.
3) Использование SSD для создания

Дополнительные сведения см. в статье [Оптимизация времени сборки для IL2CPP](https://docs.unity3d.com/Manual/IL2CPP-OptimizingBuildTimes.html) .

> [!NOTE]
> Кроме того, может быть полезно настроить [сервер кэширования](https://docs.unity3d.com/Manual/CacheServer.html), особенно для проектов Unity с большим объемом ресурсов (за исключением файлов сценариев) либо постоянно меняющимися сценами или ресурсами. Когда открывается проект, Unity сохраняет соответствующие ресурсы в формате для внутреннего кэша на компьютере разработчика. Измененные элементы нужно повторно импортировать и еще раз обработать. Этот процесс можно выполнить один раз и сохранить на сервере кэширования, а значит, и совместно использовать с другими разработчиками для экономии времени. При этом каждому разработчику не придется обрабатывать повторно импортированные измененные элементы локально.

## <a name="publishing-properties"></a>Свойства публикации

### <a name="holographic-splash-screen"></a>Поставка holographic

HoloLens имеет цп и GPU мобильного класса, что означает, что загрузка приложений может занять немного больше времени. Во время загрузки приложения пользователи будут видеть только черный, и поэтому они могут спросить, что происходит. Чтобы убедиться в их загрузке, можно добавить экран-заставку Holographic.

Чтобы переключить экран-заставку holographic, сделайте следующее:

1) переход к странице " **изменение**  >  **Project Параметры**  >  **проигрывателя** "
2) перейдите на вкладку " **хранилище Windows** " и откройте раздел " **изображение-заставка** ".
3) примените образ к свойству **изображения Windows holographic > holographic** .
    - При включении параметра " **Показывать заставку Unity** " включится или отключается экран-заставка Unity. если у вас нет лицензии unity Pro, всегда будет отображаться экран-заставка unity.
    - Если применяется **изображение с голограммой holographic** , оно всегда будет отображаться, если флажок Показать экран-заставку Unity включен или отключен. указание настраиваемого образа holographic может быть доступно только разработчикам с лицензией Pro Unity.

|  Отображение экрана-заставки Unity  |  Изображение с голограммой holographic  |  Поведение |
|----------|----------|----------|
|  Включено  |  Нет  |  Показывать экран-заставку Unity по умолчанию в течение 5 секунд или до загрузки приложения, в зависимости от того, какое из этих значений больше. |
|  Включено  |  Особые настройки  |  Отображение пользовательского экрана-заставки в течение 5 секунд или до загрузки приложения, в зависимости от того, что больше. |
|  Выключено  |  Нет  |  Показывать прозрачный черный (Nothing) до загрузки приложения. |
|  Выключено  |  Особые настройки  |  Отображение пользовательского экрана-заставки в течение 5 секунд или до загрузки приложения, в зависимости от того, что больше. |

Дополнительные сведения см. в [документации по экрану-заставке Unity](https://docs.unity3d.com/Manual/class-PlayerSettingsSplashScreen.html) .

### <a name="tracking-loss"></a>потеря слежения;

Гарнитура смешанной реальности зависит от того, насколько окружена она для создания [систем координат, заблокированных в мире](coordinate-systems-in-unity.md), что позволяет оставить голограммы на месте. Если гарнитура не может располагаться в мире, то говорят, что у головного телефона *потеряно отслеживание*. В таких случаях функциональные возможности, зависящие от системы координат, заблокированной в мире, такие как пространственные этапы, пространственные привязки и пространственное сопоставление, не работают.

В случае потери отслеживания поведение Unity по умолчанию заключается в остановке отображения голограмм, приостановке [игрового цикла](https://docs.unity3d.com/Manual/ExecutionOrder.html)и отображении уведомления о потере отслеживания, которое следует за пользователями. Настраиваемые уведомления также могут быть предоставлены в виде образа потери отслеживания. Для приложений, зависящих от отслеживания для всей работы, достаточно позволить Unity полностью обменять его до тех пор, пока отслеживание не будет восстановлено. Разработчики могут предоставить пользовательский образ, который будет отображаться во время отслеживания потерь.

Чтобы настроить отслеживание потерянных изображений, выполните следующие действия.

1) переход к странице " **изменение**  >  **Project Параметры**  >  **проигрывателя** "
2) выберите на вкладке " **хранилище Windows** " и откройте раздел " **изображение-заставка** ".
3) примените образ к свойству **изображения Windows holographic > отслеживания потери** .

#### <a name="opt-out-of-automatic-pause"></a>Отказ от автоматической паузы

Для некоторых приложений может не требоваться отслеживание (например, такие [приложения](coordinate-systems-in-unity.md) , как, например, с видеороликами 360), или же может потребоваться продолжить обработку без прерывания, пока отслеживание теряется. Можно отказаться от потери поведения по умолчанию, но вы несете ответственность за скрытие и отключение любых объектов, которые не будут правильно отображаться в сценарии с отслеживанием потерь. В большинстве случаев единственным содержимым, которое рекомендуется визуализировать в этом случае, является содержимое с блокировкой текста, Центрированное вокруг основной камеры.

Чтобы отказаться от автоматического поведения приостановки:

1) переход на страницу " **изменение**  >  **Project Параметры**  >  **проигрывателя** "
2) перейдите на вкладку " **хранилище Windows** " и откройте раздел " **изображение-заставка** ".
3) измените флажок **Windows holographic > On track потерь Pause и показывать изображение** .

#### <a name="tracking-loss-events"></a>Отслеживание событий потери

Чтобы определить пользовательское поведение при потере отслеживания, обработайте [события глобального отслеживания потерь](tracking-loss-in-unity.md).

### <a name="capabilities"></a>Возможности

Чтобы приложение было использовать преимущества определенных функций, оно должно объявлять соответствующие возможности в своем манифесте. Объявления манифеста можно вносить в Unity, чтобы они включались во все будущие экспорты проекта.

Возможности для приложения смешанной реальности можно включить следующим образом.

1) переход к странице " **изменение**  >  **Project Параметры**  >  **проигрывателя** "
2) перейдите на вкладку **хранилище Windows** , откройте раздел **публикация Параметры** и найдите список **возможностей** .

Ниже перечислены применимые возможности для включения часто используемых API-интерфейсов для holographic приложений.
<br>

|  Функция  |  API, которым требуются возможности |
|----------|----------|
|  SpatialPerception;  |  сурфацеобсервер |
|  Бесед  |  Фотозапись и Видеокаптуре |
|  Пиктуреслибрари/Видеослибрари  |  Фотозахват или Видеокаптуре, соответственно (при сохранении захваченного содержимого); |
|  Микрофон  |  Видеокаптуре (при записи звука), Диктатионрекогнизер, Граммаррекогнизер и Кэйвордрекогнизер |
|  InternetClient  |  Диктатионрекогнизер (и использование профилировщика Unity) |

## <a name="see-also"></a>См. также раздел

* [Обзор разработки в Unity](unity-development-overview.md)
* [Understanding performance for Mixed Reality](../advanced-concepts/understanding-performance-for-mixed-reality.md) (Основные сведения о производительности для Смешанной реальности)
* [Рекомендации по производительности для Unity](performance-recommendations-for-unity.md)